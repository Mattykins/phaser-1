(function(global,factory){if(typeof define==="function"&&define.amd){define(["exports","@swc/helpers"],factory);}else if(typeof exports!=="undefined"){factory(exports,require("@swc/helpers"));}else{var mod={exports:{}};factory(mod.exports,global.helpers);global.phaser=mod.exports;}})(this,function(_exports,swcHelpers){"use strict";Object.defineProperty(_exports,"__esModule",{value:true});_exports.WebGL1=_exports.Geom3D=_exports.Display3D=_exports.Geom=_exports.Events=_exports.Time=_exports.Input=_exports.Game=_exports.Color=_exports.Config=_exports.Display=_exports.Camera=_exports.Camera3D=_exports.GameObjects3D=_exports.Materials3D=_exports.Scene=_exports.Loader=_exports.GameObjects=_exports.Device=_exports.Textures=_exports.Math=_exports.DOM=_exports.World3D=_exports.World=void 0;var __defProp=Object.defineProperty;var __export=function(target,all){for(var name in all)__defProp(target,name,{get:all[name],enumerable:true});};var camera_exports={};__export(camera_exports,{Camera:function(){return Camera;},StaticCamera:function(){return StaticCamera;}});var instance;var frame=0;var elapsed=0;var GameInstance={get:function(){return instance;},set:function(game){instance=game;},getFrame:function(){return frame;},setFrame:function(current){frame=current;},getElapsed:function(){return elapsed;},setElapsed:function(current){elapsed=current;}};var mat4_exports={};__export(mat4_exports,{GetMat4Determinant:function(){return GetMat4Determinant;},GetMat4Frobenius:function(){return GetMat4Frobenius;},Mat4Add:function(){return Mat4Add;},Mat4AddTranslationFromFloats:function(){return Mat4AddTranslationFromFloats;},Mat4Adjoint:function(){return Mat4Adjoint;},Mat4Clone:function(){return Mat4Clone;},Mat4CopyFrom:function(){return Mat4CopyFrom;},Mat4CopyPosition:function(){return Mat4CopyPosition;},Mat4Equals:function(){return Mat4Equals;},Mat4FromQuat:function(){return Mat4FromQuat;},Mat4FromRotation:function(){return Mat4FromRotation;},Mat4FromRotationTranslation:function(){return Mat4FromRotationTranslation;},Mat4FromRotationTranslationScale:function(){return Mat4FromRotationTranslationScale;},Mat4FromRotationTranslationScaleOrigin:function(){return Mat4FromRotationTranslationScaleOrigin;},Mat4FromRotationXYTranslation:function(){return Mat4FromRotationXYTranslation;},Mat4FromScaling:function(){return Mat4FromScaling;},Mat4FromTranslation:function(){return Mat4FromTranslation;},Mat4FromXRotation:function(){return Mat4FromXRotation;},Mat4FromYRotation:function(){return Mat4FromYRotation;},Mat4FromZRotation:function(){return Mat4FromZRotation;},Mat4Frustum:function(){return Mat4Frustum;},Mat4GetRotation:function(){return Mat4GetRotation;},Mat4GetScaling:function(){return Mat4GetScaling;},Mat4GetTranslation:function(){return Mat4GetTranslation;},Mat4Identity:function(){return Mat4Identity;},Mat4Invert:function(){return Mat4Invert;},Mat4LookAt:function(){return Mat4LookAt;},Mat4Multiply:function(){return Mat4Multiply;},Mat4MultiplyScalar:function(){return Mat4MultiplyScalar;},Mat4MultiplyScalarAndAdd:function(){return Mat4MultiplyScalarAndAdd;},Mat4Ortho:function(){return Mat4Ortho;},Mat4Perspective:function(){return Mat4Perspective;},Mat4PerspectiveFromFieldOfView:function(){return Mat4PerspectiveFromFieldOfView;},Mat4Rotate:function(){return Mat4Rotate;},Mat4RotateX:function(){return Mat4RotateX;},Mat4RotateY:function(){return Mat4RotateY;},Mat4RotateZ:function(){return Mat4RotateZ;},Mat4Scale:function(){return Mat4Scale;},Mat4SetTranslation:function(){return Mat4SetTranslation;},Mat4SetTranslationFromFloats:function(){return Mat4SetTranslationFromFloats;},Mat4Subtract:function(){return Mat4Subtract;},Mat4TargetTo:function(){return Mat4TargetTo;},Mat4Translate:function(){return Mat4Translate;},Mat4TranslateFromFloats:function(){return Mat4TranslateFromFloats;},Mat4Transpose:function(){return Mat4Transpose;},Mat4Zero:function(){return Mat4Zero;},Matrix4:function(){return Matrix4;}});function GetMat4Determinant(matrix2){var _data=matrix2.data,m00=_data[0],m01=_data[1],m02=_data[2],m03=_data[3],m10=_data[4],m11=_data[5],m12=_data[6],m13=_data[7],m20=_data[8],m21=_data[9],m22=_data[10],m23=_data[11],m30=_data[12],m31=_data[13],m32=_data[14],m33=_data[15];var det22x33=m22*m33-m32*m23;var det21x33=m21*m33-m31*m23;var det21x32=m21*m32-m31*m22;var det20x33=m20*m33-m30*m23;var det20x32=m20*m32-m22*m30;var det20x31=m20*m31-m30*m21;var cofact00=+(m11*det22x33-m12*det21x33+m13*det21x32);var cofact01=-(m10*det22x33-m12*det20x33+m13*det20x32);var cofact02=+(m10*det21x33-m11*det20x33+m13*det20x31);var cofact03=-(m10*det21x32-m11*det20x32+m12*det20x31);return m00*cofact00+m01*cofact01+m02*cofact02+m03*cofact03;}function GetMat4Frobenius(matrix2){var _data=matrix2.data,m00=_data[0],m01=_data[1],m02=_data[2],m03=_data[3],m10=_data[4],m11=_data[5],m12=_data[6],m13=_data[7],m20=_data[8],m21=_data[9],m22=_data[10],m23=_data[11],m30=_data[12],m31=_data[13],m32=_data[14],m33=_data[15];return Math.hypot(m00,m01,m02,m03,m10,m11,m12,m13,m20,m21,m22,m23,m30,m31,m32,m33);}function RoundAwayFromZero(value){return value>0?Math.ceil(value):Math.floor(value);}var chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var lookup=new Uint8Array(256);for(var i=0;i<chars.length;i++){lookup[chars.charCodeAt(i)]=i;}function NOOP(){}var Matrix4=function(){"use strict";function _class(src){swcHelpers.classCallCheck(this,_class);var data=new Float32Array(16);this.data=data;this.onChange=NOOP;if(src){if(Array.isArray(src)){this.fromArray(src);}else{this.fromArray(src.data);}}else{data[0]=1;data[5]=1;data[10]=1;data[15]=1;}}swcHelpers.createClass(_class,[{key:"set",value:function set(m00,m01,m02,m03,m10,m11,m12,m13,m20,m21,m22,m23,m30,m31,m32,m33){var data=this.data;data[0]=m00;data[1]=m01;data[2]=m02;data[3]=m03;data[4]=m10;data[5]=m11;data[6]=m12;data[7]=m13;data[8]=m20;data[9]=m21;data[10]=m22;data[11]=m23;data[12]=m30;data[13]=m31;data[14]=m32;data[15]=m33;this.onChange(this);return this;}},{key:"toArray",value:function toArray(param,param1){var dst=param=== void 0?[]:param,index=param1=== void 0?0:param1;var data=this.data;for(var i1=0;i1<16;i1++){dst[index+i1]=data[i1];}return dst;}},{key:"fromArray",value:function fromArray(src,param){var index=param=== void 0?0:param;var data=this.data;for(var i1=0;i1<16;i1++){data[i1]=src[index+i1];}this.onChange(this);return this;}},{key:"toString",value:function toString(){return "[ mat4="+this.data.join(", ")+" ]";}},{key:"destroy",value:function destroy(){this.onChange=NOOP;this.data=null;}}]);return _class;}();function Mat4Add(a,b,param){var out=param=== void 0?new Matrix4():param;var _data=a.data,a00=_data[0],a01=_data[1],a02=_data[2],a03=_data[3],a10=_data[4],a11=_data[5],a12=_data[6],a13=_data[7],a20=_data[8],a21=_data[9],a22=_data[10],a23=_data[11],a30=_data[12],a31=_data[13],a32=_data[14],a33=_data[15];var _data1=b.data,b00=_data1[0],b01=_data1[1],b02=_data1[2],b03=_data1[3],b10=_data1[4],b11=_data1[5],b12=_data1[6],b13=_data1[7],b20=_data1[8],b21=_data1[9],b22=_data1[10],b23=_data1[11],b30=_data1[12],b31=_data1[13],b32=_data1[14],b33=_data1[15];return out.set(a00+b00,a01+b01,a02+b02,a03+b03,a10+b10,a11+b11,a12+b12,a13+b13,a20+b20,a21+b21,a22+b22,a23+b23,a30+b30,a31+b31,a32+b32,a33+b33);}function Mat4AddTranslationFromFloats(matrix2,x,y,z){var data=matrix2.data;data[12]+=x;data[13]+=y;data[14]+=z;matrix2.onChange(matrix2);return matrix2;}function Mat4Adjoint(matrix2,param){var out=param=== void 0?new Matrix4():param;var _data=matrix2.data,a00=_data[0],a01=_data[1],a02=_data[2],a03=_data[3],a10=_data[4],a11=_data[5],a12=_data[6],a13=_data[7],a20=_data[8],a21=_data[9],a22=_data[10],a23=_data[11],a30=_data[12],a31=_data[13],a32=_data[14],a33=_data[15];var b00=a00*a11-a01*a10;var b01=a00*a12-a02*a10;var b02=a00*a13-a03*a10;var b03=a01*a12-a02*a11;var b04=a01*a13-a03*a11;var b05=a02*a13-a03*a12;var b06=a20*a31-a21*a30;var b07=a20*a32-a22*a30;var b08=a20*a33-a23*a30;var b09=a21*a32-a22*a31;var b10=a21*a33-a23*a31;var b11=a22*a33-a23*a32;return out.set(a11*b11-a12*b10+a13*b09,a02*b10-a01*b11-a03*b09,a31*b05-a32*b04+a33*b03,a22*b04-a21*b05-a23*b03,a12*b08-a10*b11-a13*b07,a00*b11-a02*b08+a03*b07,a32*b02-a30*b05-a33*b01,a20*b05-a22*b02+a23*b01,a10*b10-a11*b08+a13*b06,a01*b08-a00*b10-a03*b06,a30*b04-a31*b02+a33*b00,a21*b02-a20*b04-a23*b00,a11*b07-a10*b09-a12*b06,a00*b09-a01*b07+a02*b06,a31*b01-a30*b03-a32*b00,a20*b03-a21*b01+a22*b00);}function Mat4Clone(src){return new Matrix4(src);}function Mat4CopyFrom(src,dest){return dest.fromArray(src.data);}function Mat4CopyPosition(src,dest){var srcData=src.data;var destData=dest.data;destData[12]=srcData[12];destData[13]=srcData[13];destData[14]=srcData[14];dest.onChange(dest);return dest;}function Mat4Equals(a,b){var _data=a.data,a00=_data[0],a01=_data[1],a02=_data[2],a03=_data[3],a10=_data[4],a11=_data[5],a12=_data[6],a13=_data[7],a20=_data[8],a21=_data[9],a22=_data[10],a23=_data[11],a30=_data[12],a31=_data[13],a32=_data[14],a33=_data[15];var _data1=b.data,b00=_data1[0],b01=_data1[1],b02=_data1[2],b03=_data1[3],b10=_data1[4],b11=_data1[5],b12=_data1[6],b13=_data1[7],b20=_data1[8],b21=_data1[9],b22=_data1[10],b23=_data1[11],b30=_data1[12],b31=_data1[13],b32=_data1[14],b33=_data1[15];return a00===b00&&a01===b01&&a02===b02&&a03===b03&&a10===b10&&a11===b11&&a12===b12&&a13===b13&&a20===b20&&a21===b21&&a22===b22&&a23===b23&&a30===b30&&a31===b31&&a32===b32&&a33===b33;}function Mat4FromQuat(q,param){var out=param=== void 0?new Matrix4():param;var x=q.x,y=q.y,z=q.z,w=q.w;var x2=x+x;var y2=y+y;var z2=z+z;var xx=x*x2;var yx=y*x2;var yy=y*y2;var zx=z*x2;var zy=z*y2;var zz=z*z2;var wx=w*x2;var wy=w*y2;var wz=w*z2;return out.set(1-yy-zz,yx+wz,zx-wy,0,yx-wz,1-xx-zz,zy+wx,0,zx+wy,zy-wx,1-xx-yy,0,0,0,0,1);}function Mat4FromRotation(angle,axis,param){var out=param=== void 0?new Matrix4():param;var x=axis.x,y=axis.y,z=axis.z;var len=Math.hypot(x,y,z);if(len<0.00001){return null;}len=1/len;x*=len;y*=len;z*=len;var s=Math.sin(angle);var c=Math.cos(angle);var t=1-c;return out.set(x*x*t+c,y*x*t+z*s,z*x*t-y*s,0,x*y*t-z*s,y*y*t+c,z*y*t+x*s,0,x*z*t+y*s,y*z*t-x*s,z*z*t+c,0,0,0,0,1);}function Mat4FromRotationTranslation(q,v,param){var out=param=== void 0?new Matrix4():param;var x=q.x,y=q.y,z=q.z,w=q.w;var x2=x+x;var y2=y+y;var z2=z+z;var xx=x*x2;var xy=x*y2;var xz=x*z2;var yy=y*y2;var yz=y*z2;var zz=z*z2;var wx=w*x2;var wy=w*y2;var wz=w*z2;var vx=v.x,vy=v.y,vz=v.z;return out.set(1-(yy+zz),xy+wz,xz-wy,0,xy-wz,1-(xx+zz),yz+wx,0,xz+wy,yz-wx,1-(xx+yy),0,vx,vy,vz,1);}function Mat4FromRotationTranslationScale(q,v,s,param){var out=param=== void 0?new Matrix4():param;var x=q.x,y=q.y,z=q.z,w=q.w;var x2=x+x;var y2=y+y;var z2=z+z;var xx=x*x2;var xy=x*y2;var xz=x*z2;var yy=y*y2;var yz=y*z2;var zz=z*z2;var wx=w*x2;var wy=w*y2;var wz=w*z2;var sx=s.x,sy=s.y,sz=s.z;var vx=v.x,vy=v.y,vz=v.z;return out.set((1-(yy+zz))*sx,(xy+wz)*sx,(xz-wy)*sx,0,(xy-wz)*sy,(1-(xx+zz))*sy,(yz+wx)*sy,0,(xz+wy)*sz,(yz-wx)*sz,(1-(xx+yy))*sz,0,vx,vy,vz,1);}function Mat4FromRotationTranslationScaleOrigin(q,v,s,o,param){var out=param=== void 0?new Matrix4():param;var x=q.x,y=q.y,z=q.z,w=q.w;var x2=x+x;var y2=y+y;var z2=z+z;var xx=x*x2;var xy=x*y2;var xz=x*z2;var yy=y*y2;var yz=y*z2;var zz=z*z2;var wx=w*x2;var wy=w*y2;var wz=w*z2;var sx=s.x,sy=s.y,sz=s.z;var ox=o.x,oy=o.y,oz=o.z;var vx=v.x,vy=v.y,vz=v.z;var out0=(1-(yy+zz))*sx;var out1=(xy+wz)*sx;var out2=(xz-wy)*sx;var out4=(xy-wz)*sy;var out5=(1-(xx+zz))*sy;var out6=(yz+wx)*sy;var out8=(xz+wy)*sz;var out9=(yz-wx)*sz;var out10=(1-(xx+yy))*sz;return out.set(out0,out1,out2,0,out4,out5,out6,0,out8,out9,out10,0,vx+ox-(out0*ox+out4*oy+out8*oz),vy+oy-(out1*ox+out5*oy+out9*oz),vz+oz-(out2*ox+out6*oy+out10*oz),1);}function Mat4FromRotationXYTranslation(rotation,position,param,param1){var translateFirst=param=== void 0?true:param,out=param1=== void 0?new Matrix4():param1;var x=position.x,y=position.y,z=position.z;var sx=Math.sin(rotation.x);var cx=Math.cos(rotation.x);var sy=Math.sin(rotation.y);var cy=Math.cos(rotation.y);var a30=x;var a31=y;var a32=z;var b21=-sx;var c01=0-b21*sy;var c02=0-cx*sy;var c21=b21*cy;var c22=cx*cy;if(!translateFirst){a30=cy*x+sy*z;a31=c01*x+cx*y+c21*z;a32=c02*x+sx*y+c22*z;}return out.set(cy,c01,c02,0,0,cx,sx,0,sy,c21,c22,0,a30,a31,a32,1);}function Mat4FromScaling(vec3,param){var out=param=== void 0?new Matrix4():param;var x=vec3.x,y=vec3.y,z=vec3.z;return out.set(x,0,0,0,0,y,0,0,0,0,z,0,0,0,0,1);}function Mat4FromTranslation(vec3,param){var out=param=== void 0?new Matrix4():param;var x=vec3.x,y=vec3.y,z=vec3.z;return out.set(1,0,0,0,0,1,0,0,0,0,1,0,x,y,z,1);}function Mat4FromXRotation(angle,param){var out=param=== void 0?new Matrix4():param;var c=Math.cos(angle);var s=Math.sin(angle);return out.set(1,0,0,0,0,c,s,0,0,-s,c,0,0,0,0,1);}function Mat4FromYRotation(angle,param){var out=param=== void 0?new Matrix4():param;var c=Math.cos(angle);var s=Math.sin(angle);return out.set(c,0,-s,0,0,1,0,0,s,0,c,0,0,0,0,1);}function Mat4FromZRotation(angle,param){var out=param=== void 0?new Matrix4():param;var c=Math.cos(angle);var s=Math.sin(angle);return out.set(c,s,0,0,-s,c,0,0,0,0,1,0,0,0,0,1);}function Mat4Frustum(left,right,bottom,top,near,far,param){var out=param=== void 0?new Matrix4():param;var rl=1/(right-left);var tb=1/(top-bottom);var nf=1/(near-far);return out.set(near*2*rl,0,0,0,0,near*2*tb,0,0,(right+left)*rl,(top+bottom)*tb,(far+near)*nf,-1,0,0,far*near*2*nf,0);}var Vec3=function(){"use strict";function _class(param,param1,param2){var x=param=== void 0?0:param,y=param1=== void 0?0:param1,z=param2=== void 0?0:param2;swcHelpers.classCallCheck(this,_class);this.set(x,y,z);}swcHelpers.createClass(_class,[{key:"set",value:function set(param,param1,param2){var x=param=== void 0?0:param,y=param1=== void 0?0:param1,z=param2=== void 0?0:param2;this.x=x;this.y=y;this.z=z;return this;}},{key:"toArray",value:function toArray(param,param1){var dst=param=== void 0?[]:param,index=param1=== void 0?0:param1;var ref=this,x=ref.x,y=ref.y,z=ref.z;dst[index]=x;dst[index+1]=y;dst[index+2]=z;return dst;}},{key:"fromArray",value:function fromArray(src,param){var index=param=== void 0?0:param;return this.set(src[index],src[index+1],src[index+2]);}},{key:"toString",value:function toString(){var ref=this,x=ref.x,y=ref.y,z=ref.z;return "{ x=".concat(x,", y=").concat(y,", z=").concat(z," }");}}]);return _class;}();function Mat4GetScaling(matrix2,param){var out=param=== void 0?new Vec3():param;var _data=matrix2.data,m00=_data[0],m01=_data[1],m02=_data[2],m03=_data[3],m10=_data[4],m11=_data[5],m12=_data[6],m13=_data[7],m20=_data[8],m21=_data[9],m22=_data[10];return out.set(Math.hypot(m00,m01,m02),Math.hypot(m10,m11,m12),Math.hypot(m20,m21,m22));}var Quaternion=function(){"use strict";function _class(param,param1,param2,param3){var x=param=== void 0?0:param,y=param1=== void 0?0:param1,z=param2=== void 0?0:param2,w=param3=== void 0?1:param3;swcHelpers.classCallCheck(this,_class);this._x=x;this._y=y;this._z=z;this._w=w;this.onChange=NOOP;}swcHelpers.createClass(_class,[{key:"set",value:function set(param,param1,param2,param3){var x=param=== void 0?0:param,y=param1=== void 0?0:param1,z=param2=== void 0?0:param2,w=param3=== void 0?1:param3;this._x=x;this._y=y;this._z=z;this._w=w;this.onChange(this);return this;}},{key:"x",get:function get(){return this._x;},set:function set(value){var prev=this._x;this._x=value;if(value!==prev){this.onChange(this);}}},{key:"y",get:function get(){return this._y;},set:function set(value){var prev=this._y;this._y=value;if(value!==prev){this.onChange(this);}}},{key:"z",get:function get(){return this._z;},set:function set(value){var prev=this._z;this._z=value;if(value!==prev){this.onChange(this);}}},{key:"w",get:function get(){return this._w;},set:function set(value){var prev=this._w;this._w=value;if(value!==prev){this.onChange(this);}}},{key:"toArray",value:function toArray(param,param1){var dst=param=== void 0?[]:param,index=param1=== void 0?0:param1;var ref=this,x=ref.x,y=ref.y,z=ref.z,w=ref.w;dst[index]=x;dst[index+1]=y;dst[index+2]=z;dst[index+3]=w;return dst;}},{key:"fromArray",value:function fromArray(src,param){var index=param=== void 0?0:param;return this.set(src[index],src[index+1],src[index+2],src[index+3]);}},{key:"destroy",value:function destroy(){this.onChange=NOOP;}},{key:"toString",value:function toString(){var ref=this,x=ref.x,y=ref.y,z=ref.z,w=ref.w;return "{ x=".concat(x,", y=").concat(y,", z=").concat(z,", w=").concat(w," }");}}]);return _class;}();function Mat4GetRotation(matrix2,param){var out=param=== void 0?new Quaternion():param;var scaling=Mat4GetScaling(matrix2);var is1=1/scaling.x;var is2=1/scaling.y;var is3=1/scaling.z;var _data=matrix2.data,m00=_data[0],m01=_data[1],m02=_data[2],m03=_data[3],m10=_data[4],m11=_data[5],m12=_data[6],m13=_data[7],m20=_data[8],m21=_data[9],m22=_data[10];var sm11=m00*is1;var sm12=m01*is2;var sm13=m02*is3;var sm21=m10*is1;var sm22=m11*is2;var sm23=m12*is3;var sm31=m20*is1;var sm32=m21*is2;var sm33=m22*is3;var trace=sm11+sm22+sm33;var S=0;if(trace>0){S=Math.sqrt(trace+1)*2;return out.set((sm23-sm32)/S,(sm31-sm13)/S,(sm12-sm21)/S,0.25*S);}else if(sm11>sm22&&sm11>sm33){S=Math.sqrt(1+sm11-sm22-sm33)*2;return out.set(0.25*S,(sm12+sm21)/S,(sm31+sm13)/S,(sm23-sm32)/S);}else if(sm22>sm33){S=Math.sqrt(1+sm22-sm11-sm33)*2;return out.set((sm12+sm21)/S,0.25*S,(sm23+sm32)/S,(sm31-sm13)/S);}else{S=Math.sqrt(1+sm33-sm11-sm22)*2;return out.set((sm31+sm13)/S,(sm23+sm32)/S,0.25*S,(sm12-sm21)/S);}}function Mat4GetTranslation(matrix2,param){var out=param=== void 0?new Vec3():param;var data=matrix2.data;return out.set(data[12],data[13],data[14]);}function Mat4Identity(param){var matrix2=param=== void 0?new Matrix4():param;return matrix2.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);}function Mat4Invert(matrix2,param){var out=param=== void 0?new Matrix4():param;var _data=matrix2.data,m00=_data[0],m01=_data[1],m02=_data[2],m03=_data[3],m10=_data[4],m11=_data[5],m12=_data[6],m13=_data[7],m20=_data[8],m21=_data[9],m22=_data[10],m23=_data[11],m30=_data[12],m31=_data[13],m32=_data[14],m33=_data[15];var det22x33=m22*m33-m32*m23;var det21x33=m21*m33-m31*m23;var det21x32=m21*m32-m31*m22;var det20x33=m20*m33-m30*m23;var det20x32=m20*m32-m22*m30;var det20x31=m20*m31-m30*m21;var cofact00=+(m11*det22x33-m12*det21x33+m13*det21x32);var cofact01=-(m10*det22x33-m12*det20x33+m13*det20x32);var cofact02=+(m10*det21x33-m11*det20x33+m13*det20x31);var cofact03=-(m10*det21x32-m11*det20x32+m12*det20x31);var det=m00*cofact00+m01*cofact01+m02*cofact02+m03*cofact03;if(det===0){return out;}var detInv=1/det;var det12x33=m12*m33-m32*m13;var det11x33=m11*m33-m31*m13;var det11x32=m11*m32-m31*m12;var det10x33=m10*m33-m30*m13;var det10x32=m10*m32-m30*m12;var det10x31=m10*m31-m30*m11;var det12x23=m12*m23-m22*m13;var det11x23=m11*m23-m21*m13;var det11x22=m11*m22-m21*m12;var det10x23=m10*m23-m20*m13;var det10x22=m10*m22-m20*m12;var det10x21=m10*m21-m20*m11;var cofact10=-(m01*det22x33-m02*det21x33+m03*det21x32);var cofact11=+(m00*det22x33-m02*det20x33+m03*det20x32);var cofact12=-(m00*det21x33-m01*det20x33+m03*det20x31);var cofact13=+(m00*det21x32-m01*det20x32+m02*det20x31);var cofact20=+(m01*det12x33-m02*det11x33+m03*det11x32);var cofact21=-(m00*det12x33-m02*det10x33+m03*det10x32);var cofact22=+(m00*det11x33-m01*det10x33+m03*det10x31);var cofact23=-(m00*det11x32-m01*det10x32+m02*det10x31);var cofact30=-(m01*det12x23-m02*det11x23+m03*det11x22);var cofact31=+(m00*det12x23-m02*det10x23+m03*det10x22);var cofact32=-(m00*det11x23-m01*det10x23+m03*det10x21);var cofact33=+(m00*det11x22-m01*det10x22+m02*det10x21);return out.set(cofact00*detInv,cofact10*detInv,cofact20*detInv,cofact30*detInv,cofact01*detInv,cofact11*detInv,cofact21*detInv,cofact31*detInv,cofact02*detInv,cofact12*detInv,cofact22*detInv,cofact32*detInv,cofact03*detInv,cofact13*detInv,cofact23*detInv,cofact33*detInv);}function Mat4LookAt(eye,center,up,param){var out=param=== void 0?new Matrix4():param;var eyex=eye.x,eyey=eye.y,eyez=eye.z;var upx=up.x,upy=up.y,upz=up.z;var centerx=center.x,centery=center.y,centerz=center.z;if(Math.abs(eyex-centerx)<0.00001&&Math.abs(eyey-centery)<0.00001&&Math.abs(eyez-centerz)<0.00001){return Mat4Identity(out);}var z0=eyex-centerx;var z1=eyey-centery;var z2=eyez-centerz;var len=1/Math.hypot(z0,z1,z2);z0*=len;z1*=len;z2*=len;var x0=upy*z2-upz*z1;var x1=upz*z0-upx*z2;var x2=upx*z1-upy*z0;len=Math.hypot(x0,x1,x2);if(!len){x0=0;x1=0;x2=0;}else{len=1/len;x0*=len;x1*=len;x2*=len;}var y0=z1*x2-z2*x1;var y1=z2*x0-z0*x2;var y2=z0*x1-z1*x0;len=Math.hypot(y0,y1,y2);if(!len){y0=0;y1=0;y2=0;}else{len=1/len;y0*=len;y1*=len;y2*=len;}return out.set(x0,y0,z0,0,x1,y1,z1,0,x2,y2,z2,0,-(x0*eyex+x1*eyey+x2*eyez),-(y0*eyex+y1*eyey+y2*eyez),-(z0*eyex+z1*eyey+z2*eyez),1);}function Mat4Multiply(a,b,param){var out=param=== void 0?new Matrix4():param;var _data=a.data,a00=_data[0],a01=_data[1],a02=_data[2],a03=_data[3],a10=_data[4],a11=_data[5],a12=_data[6],a13=_data[7],a20=_data[8],a21=_data[9],a22=_data[10],a23=_data[11],a30=_data[12],a31=_data[13],a32=_data[14],a33=_data[15];var _data1=b.data,b00=_data1[0],b01=_data1[1],b02=_data1[2],b03=_data1[3],b10=_data1[4],b11=_data1[5],b12=_data1[6],b13=_data1[7],b20=_data1[8],b21=_data1[9],b22=_data1[10],b23=_data1[11],b30=_data1[12],b31=_data1[13],b32=_data1[14],b33=_data1[15];return out.set(b00*a00+b01*a10+b02*a20+b03*a30,b01*a01+b01*a11+b02*a21+b03*a31,b02*a02+b01*a12+b02*a22+b03*a32,b03*a03+b01*a13+b02*a23+b03*a33,b10*a00+b11*a10+b12*a20+b13*a30,b10*a01+b11*a11+b12*a21+b13*a31,b10*a02+b11*a12+b12*a22+b13*a32,b10*a03+b11*a13+b12*a23+b13*a33,b20*a00+b21*a10+b22*a20+b23*a30,b20*a01+b21*a11+b22*a21+b23*a31,b20*a02+b21*a12+b22*a22+b23*a32,b20*a03+b21*a13+b22*a23+b23*a33,b30*a00+b31*a10+b32*a20+b33*a30,b30*a01+b31*a11+b32*a21+b33*a31,b30*a02+b31*a12+b32*a22+b33*a32,b30*a03+b31*a13+b32*a23+b33*a33);}function Mat4MultiplyScalar(matrix2,scalar,param){var out=param=== void 0?new Matrix4():param;var _data=matrix2.data,a00=_data[0],a01=_data[1],a02=_data[2],a03=_data[3],a10=_data[4],a11=_data[5],a12=_data[6],a13=_data[7],a20=_data[8],a21=_data[9],a22=_data[10],a23=_data[11],a30=_data[12],a31=_data[13],a32=_data[14],a33=_data[15];return out.set(a00*scalar,a01*scalar,a02*scalar,a03*scalar,a10*scalar,a11*scalar,a12*scalar,a13*scalar,a20*scalar,a21*scalar,a22*scalar,a23*scalar,a30*scalar,a31*scalar,a32*scalar,a33*scalar);}function Mat4MultiplyScalarAndAdd(a,b,scalar,param){var out=param=== void 0?new Matrix4():param;var _data=a.data,a00=_data[0],a01=_data[1],a02=_data[2],a03=_data[3],a10=_data[4],a11=_data[5],a12=_data[6],a13=_data[7],a20=_data[8],a21=_data[9],a22=_data[10],a23=_data[11],a30=_data[12],a31=_data[13],a32=_data[14],a33=_data[15];var _data1=b.data,b00=_data1[0],b01=_data1[1],b02=_data1[2],b03=_data1[3],b10=_data1[4],b11=_data1[5],b12=_data1[6],b13=_data1[7],b20=_data1[8],b21=_data1[9],b22=_data1[10],b23=_data1[11],b30=_data1[12],b31=_data1[13],b32=_data1[14],b33=_data1[15];return out.set(a00+b00*scalar,a01+b01*scalar,a02+b02*scalar,a03+b03*scalar,a10+b10*scalar,a11+b11*scalar,a12+b12*scalar,a13+b13*scalar,a20+b20*scalar,a21+b21*scalar,a22+b22*scalar,a23+b23*scalar,a30+b30*scalar,a31+b31*scalar,a32+b32*scalar,a33+b33*scalar);}function Mat4Ortho(left,right,bottom,top,near,far,param){var out=param=== void 0?new Matrix4():param;var lr=1/(left-right);var bt=1/(bottom-top);var nf=1/(near-far);return out.set(-2*lr,0,0,0,0,-2*bt,0,0,0,0,2*nf,0,(left+right)*lr,(top+bottom)*bt,(far+near)*nf,1);}function Mat4Perspective(fovY,aspect,near,far,param){var out=param=== void 0?new Matrix4():param;var f=1/Math.tan(fovY/2);var m22=-1;var m32=-2*near;if(far!==null&&far!==Infinity){var nf=1/(near-far);m22=(far+near)*nf;m32=2*far*near*nf;}return out.set(f/aspect,0,0,0,0,f,0,0,0,0,m22,-1,0,0,m32,0);}function Mat4PerspectiveFromFieldOfView(fov,near,far,param){var out=param=== void 0?new Matrix4():param;var upTan=Math.tan(fov.upDegrees*Math.PI/180);var downTan=Math.tan(fov.downDegrees*Math.PI/180);var leftTan=Math.tan(fov.leftDegrees*Math.PI/180);var rightTan=Math.tan(fov.rightDegrees*Math.PI/180);var xScale=2/(leftTan+rightTan);var yScale=2/(upTan+downTan);return out.set(xScale,0,0,0,0,yScale,0,0,-((leftTan-rightTan)*xScale*0.5),(upTan-downTan)*yScale*0.5,far/(near-far),-1,0,0,far*near/(near-far),0);}function Mat4Rotate(matrix2,angle,axis,param){var out=param=== void 0?new Matrix4():param;var x=axis.x,y=axis.y,z=axis.z;var len=Math.hypot(x,y,z);if(len<0.00001){return null;}len=1/len;x*=len;y*=len;z*=len;var s=Math.sin(angle);var c=Math.cos(angle);var t=1-c;var _data=matrix2.data,a00=_data[0],a01=_data[1],a02=_data[2],a03=_data[3],a10=_data[4],a11=_data[5],a12=_data[6],a13=_data[7],a20=_data[8],a21=_data[9],a22=_data[10],a23=_data[11],a30=_data[12],a31=_data[13],a32=_data[14],a33=_data[15];var b00=x*x*t+c;var b01=y*x*t+z*s;var b02=z*x*t-y*s;var b10=x*y*t-z*s;var b11=y*y*t+c;var b12=z*y*t+x*s;var b20=x*z*t+y*s;var b21=y*z*t-x*s;var b22=z*z*t+c;return out.set(a00*b00+a10*b01+a20*b02,a01*b00+a11*b01+a21*b02,a02*b00+a12*b01+a22*b02,a03*b00+a13*b01+a23*b02,a00*b10+a10*b11+a20*b12,a01*b10+a11*b11+a21*b12,a02*b10+a12*b11+a22*b12,a03*b10+a13*b11+a23*b12,a00*b20+a10*b21+a20*b22,a01*b20+a11*b21+a21*b22,a02*b20+a12*b21+a22*b22,a03*b20+a13*b21+a23*b22,a30,a31,a32,a33);}function Mat4RotateX(matrix2,angle,param){var out=param=== void 0?new Matrix4():param;var s=Math.sin(angle);var c=Math.cos(angle);var _data=matrix2.data,a00=_data[0],a01=_data[1],a02=_data[2],a03=_data[3],a10=_data[4],a11=_data[5],a12=_data[6],a13=_data[7],a20=_data[8],a21=_data[9],a22=_data[10],a23=_data[11],a30=_data[12],a31=_data[13],a32=_data[14],a33=_data[15];return out.set(a00,a01,a02,a03,a10*c+a20*s,a11*c+a21*s,a12*c+a22*s,a13*c+a23*s,a20*c-a10*s,a21*c-a11*s,a22*c-a12*s,a23*c-a13*s,a30,a31,a32,a33);}function Mat4RotateY(matrix2,angle,param){var out=param=== void 0?new Matrix4():param;var s=Math.sin(angle);var c=Math.cos(angle);var _data=matrix2.data,a00=_data[0],a01=_data[1],a02=_data[2],a03=_data[3],a10=_data[4],a11=_data[5],a12=_data[6],a13=_data[7],a20=_data[8],a21=_data[9],a22=_data[10],a23=_data[11],a30=_data[12],a31=_data[13],a32=_data[14],a33=_data[15];return out.set(a00*c-a20*s,a01*c-a21*s,a02*c-a22*s,a03*c-a23*s,a10,a11,a12,a13,a00*s+a20*c,a01*s+a21*c,a02*s+a22*c,a03*s+a23*c,a30,a31,a32,a33);}function Mat4RotateZ(matrix2,angle,param){var out=param=== void 0?new Matrix4():param;var s=Math.sin(angle);var c=Math.cos(angle);var _data=matrix2.data,a00=_data[0],a01=_data[1],a02=_data[2],a03=_data[3],a10=_data[4],a11=_data[5],a12=_data[6],a13=_data[7],a20=_data[8],a21=_data[9],a22=_data[10],a23=_data[11],a30=_data[12],a31=_data[13],a32=_data[14],a33=_data[15];return out.set(a00*c+a10*s,a01*c+a11*s,a02*c+a12*s,a03*c+a13*s,a10*c-a00*s,a11*c-a01*s,a12*c-a02*s,a13*c-a03*s,a20,a21,a22,a23,a30,a31,a32,a33);}function Mat4Scale(matrix2,v,param){var out=param=== void 0?new Matrix4():param;var _data=matrix2.data,m00=_data[0],m01=_data[1],m02=_data[2],m03=_data[3],m10=_data[4],m11=_data[5],m12=_data[6],m13=_data[7],m20=_data[8],m21=_data[9],m22=_data[10],m23=_data[11],m30=_data[12],m31=_data[13],m32=_data[14],m33=_data[15];var x=v.x,y=v.y,z=v.z;return out.set(m00*x,m01*x,m02*x,m03*x,m10*y,m11*y,m12*y,m13*y,m20*z,m21*z,m22*z,m23*z,m30,m31,m32,m33);}function Mat4SetTranslation(matrix2,vec3){var data=matrix2.data;var x=vec3.x,y=vec3.y,z=vec3.z;data[12]=x;data[13]=y;data[14]=z;matrix2.onChange(matrix2);return matrix2;}function Mat4SetTranslationFromFloats(matrix2,x,y,z){var data=matrix2.data;data[12]=x;data[13]=y;data[14]=z;matrix2.onChange(matrix2);return matrix2;}function Mat4Subtract(a,b,param){var out=param=== void 0?new Matrix4():param;var _data=a.data,a00=_data[0],a01=_data[1],a02=_data[2],a03=_data[3],a10=_data[4],a11=_data[5],a12=_data[6],a13=_data[7],a20=_data[8],a21=_data[9],a22=_data[10],a23=_data[11],a30=_data[12],a31=_data[13],a32=_data[14],a33=_data[15];var _data1=b.data,b00=_data1[0],b01=_data1[1],b02=_data1[2],b03=_data1[3],b10=_data1[4],b11=_data1[5],b12=_data1[6],b13=_data1[7],b20=_data1[8],b21=_data1[9],b22=_data1[10],b23=_data1[11],b30=_data1[12],b31=_data1[13],b32=_data1[14],b33=_data1[15];return out.set(a00-b00,a01-b01,a02-b02,a03-b03,a10-b10,a11-b11,a12-b12,a13-b13,a20-b20,a21-b21,a22-b22,a23-b23,a30-b30,a31-b31,a32-b32,a33-b33);}function Mat4TargetTo(eye,target,up,param){var out=param=== void 0?new Matrix4():param;var eyex=eye.x,eyey=eye.y,eyez=eye.z;var upx=up.x,upy=up.y,upz=up.z;var targetx=target.x,targety=target.y,targetz=target.z;var z0=eyex-targetx;var z1=eyey-targety;var z2=eyez-targetz;var len=z0*z0+z1*z1+z2*z2;if(len>0){len=1/Math.sqrt(len);z0*=len;z1*=len;z2*=len;}var x0=upy*z2-upz*z1;var x1=upz*z0-upx*z2;var x2=upx*z1-upy*z0;len=x0*x0+x1*x1+x2*x2;if(len>0){len=1/Math.sqrt(len);x0*=len;x1*=len;x2*=len;}return out.set(x0,x1,x2,0,z1*x2-z2*x1,z2*x0-z0*x2,z0*x1-z1*x0,0,z0,z1,z2,0,eyex,eyey,eyez,1);}function Mat4Translate(matrix2,vec3,param){var out=param=== void 0?new Matrix4():param;var x=vec3.x,y=vec3.y,z=vec3.z;var data=matrix2.data;var a00=data[0],a01=data[1],a02=data[2],a03=data[3],a10=data[4],a11=data[5],a12=data[6],a13=data[7],a20=data[8],a21=data[9],a22=data[10],a23=data[11],a30=data[12],a31=data[13],a32=data[14],a33=data[15];if(matrix2===out){data[12]=a00*x+a10*y+a20*z+a30;data[13]=a01*x+a11*y+a21*z+a31;data[14]=a02*x+a12*y+a22*z+a32;data[15]=a03*x+a13*y+a23*z+a33;}else{out.set(a00,a01,a02,a03,a10,a11,a12,a13,a20,a21,a22,a23,a00*x+a10*y+a20*z+a30,a01*x+a11*y+a21*z+a31,a02*x+a12*y+a22*z+a32,a03*x+a13*y+a23*z+a33);}return out;}function Mat4TranslateFromFloats(matrix2,x,y,z,param){var out=param=== void 0?new Matrix4():param;var data=matrix2.data;var a00=data[0],a01=data[1],a02=data[2],a03=data[3],a10=data[4],a11=data[5],a12=data[6],a13=data[7],a20=data[8],a21=data[9],a22=data[10],a23=data[11],a30=data[12],a31=data[13],a32=data[14],a33=data[15];if(matrix2===out){data[12]=a00*x+a10*y+a20*z+a30;data[13]=a01*x+a11*y+a21*z+a31;data[14]=a02*x+a12*y+a22*z+a32;data[15]=a03*x+a13*y+a23*z+a33;}else{out.set(a00,a01,a02,a03,a10,a11,a12,a13,a20,a21,a22,a23,a00*x+a10*y+a20*z+a30,a01*x+a11*y+a21*z+a31,a02*x+a12*y+a22*z+a32,a03*x+a13*y+a23*z+a33);}return out;}function Mat4Transpose(matrix2,param){var out=param=== void 0?new Matrix4():param;var _data=matrix2.data,m00=_data[0],m01=_data[1],m02=_data[2],m03=_data[3],m10=_data[4],m11=_data[5],m12=_data[6],m13=_data[7],m20=_data[8],m21=_data[9],m22=_data[10],m23=_data[11],m30=_data[12],m31=_data[13],m32=_data[14],m33=_data[15];return out.set(m00,m10,m20,m30,m01,m11,m21,m31,m02,m12,m22,m32,m03,m13,m23,m33);}function Mat4Zero(matrix2){return matrix2.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);}var Matrix2D=function(){"use strict";function _class(param,param1,param2,param3,param4,param5){var a=param=== void 0?1:param,b=param1=== void 0?0:param1,c=param2=== void 0?0:param2,d=param3=== void 0?1:param3,tx=param4=== void 0?0:param4,ty=param5=== void 0?0:param5;swcHelpers.classCallCheck(this,_class);this.set(a,b,c,d,tx,ty);}swcHelpers.createClass(_class,[{key:"set",value:function set(param,param1,param2,param3,param4,param5){var a=param=== void 0?1:param,b=param1=== void 0?0:param1,c=param2=== void 0?0:param2,d=param3=== void 0?1:param3,tx=param4=== void 0?0:param4,ty=param5=== void 0?0:param5;this.a=a;this.b=b;this.c=c;this.d=d;this.tx=tx;this.ty=ty;return this;}},{key:"identity",value:function identity(){return this.set();}},{key:"toArray",value:function toArray(){var ref=this,a=ref.a,b=ref.b,c=ref.c,d=ref.d,tx=ref.tx,ty=ref.ty;return [a,b,c,d,tx,ty];}},{key:"fromArray",value:function fromArray(src){return this.set(src[0],src[1],src[2],src[3],src[4],src[5]);}}]);return _class;}();function RectangleContains(rect,x,y){if(rect.width<=0||rect.height<=0){return false;}return rect.x<=x&&rect.x+rect.width>=x&&rect.y<=y&&rect.y+rect.height>=y;}var Rectangle=function(){"use strict";function _class(param,param1,param2,param3){var x=param=== void 0?0:param,y=param1=== void 0?0:param1,width=param2=== void 0?0:param2,height=param3=== void 0?0:param3;swcHelpers.classCallCheck(this,_class);this.set(x,y,width,height);}swcHelpers.createClass(_class,[{key:"set",value:function set(param,param1,param2,param3){var x=param=== void 0?0:param,y=param1=== void 0?0:param1,width=param2=== void 0?0:param2,height=param3=== void 0?0:param3;this.x=x;this.y=y;this.width=width;this.height=height;return this;}},{key:"contains",value:function contains(x,y){return RectangleContains(this,x,y);}},{key:"right",get:function get(){return this.x+this.width;},set:function set(value){if(value<=this.x){this.width=0;}else{this.width=value-this.x;}}},{key:"bottom",get:function get(){return this.y+this.height;},set:function set(value){if(value<=this.y){this.height=0;}else{this.height=value-this.y;}}}]);return _class;}();var Vec2Callback=function(){"use strict";function _class(onChange,param,param1){var x=param=== void 0?0:param,y=param1=== void 0?0:param1;swcHelpers.classCallCheck(this,_class);this._x=x;this._y=y;this.onChange=onChange;}swcHelpers.createClass(_class,[{key:"destroy",value:function destroy(){this.onChange=NOOP;}},{key:"set",value:function set(param,param1){var x=param=== void 0?0:param,y=param1=== void 0?0:param1;this._x=x;this._y=y;if(this.onChange){this.onChange(this);}return this;}},{key:"x",get:function get(){return this._x;},set:function set(value){var prev=this._x;this._x=value;if(prev!==value){this.onChange(this);}}},{key:"y",get:function get(){return this._y;},set:function set(value){var prev=this._y;this._y=value;if(prev!==value){this.onChange(this);}}},{key:"toArray",value:function toArray(param,param1){var dst=param=== void 0?[]:param,index=param1=== void 0?0:param1;var ref=this,x=ref.x,y=ref.y;dst[index]=x;dst[index+1]=y;return dst;}},{key:"fromArray",value:function fromArray(src,param){var index=param=== void 0?0:param;return this.set(src[index],src[index+1]);}},{key:"toString",value:function toString(){var ref=this,x=ref.x,y=ref.y;return "{ x=".concat(x,", y=").concat(y," }");}}]);return _class;}();var angle_exports={};__export(angle_exports,{AngleBetween:function(){return AngleBetween;},AngleBetweenY:function(){return AngleBetweenY;},CounterClockwise:function(){return CounterClockwise;},NormalizeAngle:function(){return NormalizeAngle;},ReverseAngle:function(){return ReverseAngle;},RotateAngleTo:function(){return RotateAngleTo;},ShortestAngleBetween:function(){return ShortestAngleBetween;},WrapAngle:function(){return WrapAngle;},WrapAngleDegrees:function(){return WrapAngleDegrees;}});function AngleBetween(x1,y1,x2,y2){return Math.atan2(y2-y1,x2-x1);}function AngleBetweenY(x1,y1,x2,y2){return Math.atan2(x2-x1,y2-y1);}var MATH_CONST={PI2:Math.PI*2,HALF_PI:Math.PI*0.5,EPSILON:0.000001,DEG_TO_RAD:Math.PI/180,RAD_TO_DEG:180/Math.PI,MIN_SAFE_INTEGER:Number.MIN_SAFE_INTEGER|| -9007199254740991,MAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER||9007199254740991};function CounterClockwise(angle){if(angle>Math.PI){angle-=MATH_CONST.PI2;}return Math.abs(((angle+MATH_CONST.HALF_PI)%MATH_CONST.PI2-MATH_CONST.PI2)%MATH_CONST.PI2);}function NormalizeAngle(angle){angle=angle%MATH_CONST.PI2;if(angle>=0){return angle;}else{return angle+MATH_CONST.PI2;}}function ReverseAngle(angle){return NormalizeAngle(angle+Math.PI);}function RotateAngleTo(currentAngle,targetAngle,param){var lerp=param=== void 0?0.05:param;if(currentAngle===targetAngle){return currentAngle;}if(Math.abs(targetAngle-currentAngle)<=lerp||Math.abs(targetAngle-currentAngle)>=MATH_CONST.PI2-lerp){currentAngle=targetAngle;}else{if(Math.abs(targetAngle-currentAngle)>Math.PI){if(targetAngle<currentAngle){targetAngle+=MATH_CONST.PI2;}else{targetAngle-=MATH_CONST.PI2;}}if(targetAngle>currentAngle){currentAngle+=lerp;}else if(targetAngle<currentAngle){currentAngle-=lerp;}}return currentAngle;}function ShortestAngleBetween(angle1,angle2){var difference=angle2-angle1;if(difference===0){return 0;}var times=Math.floor((difference- -180)/360);return difference-times*360;}function Wrap(value,min,max){var range=max-min;return min+((value-min)%range+range)%range;}function WrapAngle(angle){return Wrap(angle,-Math.PI,Math.PI);}function WrapAngleDegrees(angle){return Wrap(angle,-180,180);}var Camera=function(){"use strict";function _class(){swcHelpers.classCallCheck(this,_class);this._rotation=0;this.type="Camera";this.dirtyRender=true;var game=GameInstance.get();this.renderer=game.renderer;this.matrix=Mat4Identity();this.bounds=new Rectangle();this.worldTransform=new Matrix2D();this.position=new Vec2Callback((function(){return this.updateTransform();}).bind(this),0,0);this.scale=new Vec2Callback((function(){return this.updateTransform();}).bind(this),1,1);this.origin=new Vec2Callback((function(){return this.updateTransform();}).bind(this),0.5,0.5);this.reset();}swcHelpers.createClass(_class,[{key:"updateTransform",value:function updateTransform(){var matrix2=this.matrix.data;var px=this.position.x;var py=this.position.y;var sx=this.scale.x;var sy=this.scale.y;var ox=-px+this.width*this.origin.x;var oy=-py+this.height*this.origin.y;var z=Math.sin(this.rotation);var w=Math.cos(this.rotation);var z2=z+z;var zz=z*z2;var wz=w*z2;var out0=(1-zz)*sx;var out1=wz*sx;var out4=-wz*sy;var out5=(1-zz)*sy;matrix2[0]=out0;matrix2[1]=out1;matrix2[4]=out4;matrix2[5]=out5;matrix2[12]=px+ox-(out0*ox+out4*oy);matrix2[13]=py+oy-(out1*ox+out5*oy);this.worldTransform.set(w*sx,z*sx,-z*sy,w*sy,-px,-py);var bw=this.width*(1/sx);var bh=this.height*(1/sy);this.bounds.set(ox-bw/2,oy-bh/2,bw,bh);this.dirtyRender=true;}},{key:"reset",value:function reset(){var width=this.renderer.width;var height=this.renderer.height;this.width=width;this.height=height;this.bounds.set(0,0,width,height);}},{key:"rotation",get:function get(){return this._rotation;},set:function set(value){if(value!==this._rotation){this._rotation=WrapAngle(value);this.updateTransform();}}},{key:"destroy",value:function destroy(){this.position.destroy();this.scale.destroy();this.origin.destroy();this.world=null;this.worldTransform=null;this.renderer=null;this.matrix=null;this.bounds=null;}}]);return _class;}();var StaticCamera=function(){"use strict";function _class(){swcHelpers.classCallCheck(this,_class);this.type="StaticCamera";this.dirtyRender=true;var game=GameInstance.get();this.renderer=game.renderer;this.matrix=Mat4Identity();this.bounds=new Rectangle();this.worldTransform=new Matrix2D();this.reset();}swcHelpers.createClass(_class,[{key:"reset",value:function reset(){var renderer=this.renderer;if(renderer){var width=renderer.width;var height=renderer.height;this.width=width;this.height=height;}this.bounds.set(0,0,this.width,this.height);}},{key:"destroy",value:function destroy(){this.world=null;this.worldTransform=null;this.renderer=null;this.matrix=null;this.bounds=null;}}]);return _class;}();var camera3d_exports={};__export(camera3d_exports,{Camera3D:function(){return Camera3D;}});var quaternion_exports={};__export(quaternion_exports,{GetQuatAngle:function(){return GetQuatAngle;},GetQuatAngleTo:function(){return GetQuatAngleTo;},GetQuatAreClose:function(){return GetQuatAreClose;},GetQuatAxisAngle:function(){return GetQuatAxisAngle;},GetQuatLength:function(){return GetQuatLength;},GetQuatLengthSquared:function(){return GetQuatLengthSquared;},QuatAdd:function(){return QuatAdd;},QuatAddScalar:function(){return QuatAddScalar;},QuatClone:function(){return QuatClone;},QuatConjugate:function(){return QuatConjugate;},QuatCopyFrom:function(){return QuatCopyFrom;},QuatDot:function(){return QuatDot;},QuatEquals:function(){return QuatEquals;},QuatFromEulerAngles:function(){return QuatFromEulerAngles;},QuatFromEulerVector:function(){return QuatFromEulerVector;},QuatFromRotationAxis:function(){return QuatFromRotationAxis;},QuatFromRotationMatrix:function(){return QuatFromRotationMatrix;},QuatFuzzyEquals:function(){return QuatFuzzyEquals;},QuatHermite:function(){return QuatHermite;},QuatInvert:function(){return QuatInvert;},QuatMultiply:function(){return QuatMultiply;},QuatMultiplyByFloats:function(){return QuatMultiplyByFloats;},QuatNormalize:function(){return QuatNormalize;},QuatRotateTowards:function(){return QuatRotateTowards;},QuatRotateX:function(){return QuatRotateX;},QuatRotateY:function(){return QuatRotateY;},QuatRotateZ:function(){return QuatRotateZ;},QuatRotationAlphaBetaGamma:function(){return QuatRotationAlphaBetaGamma;},QuatRotationYawPitchRoll:function(){return QuatRotationYawPitchRoll;},QuatScale:function(){return QuatScale;},QuatScaleAndAdd:function(){return QuatScaleAndAdd;},QuatSetAxisAngle:function(){return QuatSetAxisAngle;},QuatSetFromUnitVectors:function(){return QuatSetFromUnitVectors;},QuatSlerp:function(){return QuatSlerp;},QuatSubtract:function(){return QuatSubtract;},QuatSubtractScalar:function(){return QuatSubtractScalar;},QuatToEulerAngles:function(){return QuatToEulerAngles;},QuatZero:function(){return QuatZero;},Quaternion:function(){return Quaternion;}});function QuatDot(a,b){return a.x*b.x+a.y*b.y+a.z*b.z+a.w*b.w;}function GetQuatAngle(a,b){var dot=QuatDot(a,b);return Math.acos(2*dot*dot-1);}function Clamp(value,min,max){return Math.max(min,Math.min(max,value));}function GetQuatAngleTo(a,b){return 2*Math.acos(Math.abs(Clamp(QuatDot(a,b),-1,1)));}function GetQuatAreClose(a,b){return QuatDot(a,b)>=0;}function GetQuatAxisAngle(a,param){var out=param=== void 0?new Quaternion():param;var rad=Math.acos(a.w)*2;var s=Math.sin(rad/2);var epsilon=0.000001;if(s>epsilon){out.set(a.x/s,a.y/s,a.z/s);}else{out.set(1,0,0);}return rad;}function GetQuatLength(a){var x=a.x,y=a.y,z=a.z,w=a.w;return Math.sqrt(x*x+y*y+z*z+w*w);}function GetQuatLengthSquared(a){var x=a.x,y=a.y,z=a.z,w=a.w;return x*x+y*y+z*z+w*w;}function QuatAdd(a,b,param){var out=param=== void 0?new Quaternion():param;return out.set(a.x+b.x,a.y+b.y,a.z+b.z,a.w+b.w);}function QuatAddScalar(a,scalar,param){var out=param=== void 0?new Quaternion():param;return out.set(a.x+scalar,a.y+scalar,a.z+scalar,a.w+scalar);}function QuatClone(source){var x=source.x,y=source.y,z=source.z,w=source.w;return new Quaternion(x,y,z,w);}function QuatConjugate(a,param){var out=param=== void 0?new Quaternion():param;var x=a.x,y=a.y,z=a.z,w=a.w;return out.set(x* -1,y* -1,z* -1,w);}function QuatCopyFrom(source,dest){var x=source.x,y=source.y,z=source.z,w=source.w;return dest.set(x,y,z,w);}function QuatEquals(a,b){return a.x===b.x&&a.y===b.y&&a.z===b.z&&a.w===b.w;}function QuatRotationYawPitchRoll(yaw,pitch,roll,param){var out=param=== void 0?new Quaternion():param;var halfRoll=roll*0.5;var halfPitch=pitch*0.5;var halfYaw=yaw*0.5;var sinRoll=Math.sin(halfRoll);var cosRoll=Math.cos(halfRoll);var sinPitch=Math.sin(halfPitch);var cosPitch=Math.cos(halfPitch);var sinYaw=Math.sin(halfYaw);var cosYaw=Math.cos(halfYaw);return out.set(cosYaw*sinPitch*cosRoll+sinYaw*cosPitch*sinRoll,sinYaw*cosPitch*cosRoll-cosYaw*sinPitch*sinRoll,cosYaw*cosPitch*sinRoll-sinYaw*sinPitch*cosRoll,cosYaw*cosPitch*cosRoll+sinYaw*sinPitch*sinRoll);}function QuatFromEulerAngles(x,y,z,param){var out=param=== void 0?new Quaternion():param;return QuatRotationYawPitchRoll(y,x,z,out);}function QuatFromEulerVector(v,param){var out=param=== void 0?new Quaternion():param;return QuatRotationYawPitchRoll(v.y,v.x,v.z,out);}var vec3_exports={};__export(vec3_exports,{BACKWARD:function(){return BACKWARD;},DOWN:function(){return DOWN;},FORWARD:function(){return FORWARD;},GetVec3Angle:function(){return GetVec3Angle;},GetVec3Distance:function(){return GetVec3Distance;},GetVec3DistanceSquared:function(){return GetVec3DistanceSquared;},GetVec3Length:function(){return GetVec3Length;},GetVec3LengthSquared:function(){return GetVec3LengthSquared;},GetVec3ManhattanDistance:function(){return GetVec3ManhattanDistance;},GetVec3ManhattanLength:function(){return GetVec3ManhattanLength;},LEFT:function(){return LEFT;},RGBCallback:function(){return RGBCallback;},RIGHT:function(){return RIGHT;},UP:function(){return UP;},Vec3:function(){return Vec3;},Vec3Abs:function(){return Vec3Abs;},Vec3Add:function(){return Vec3Add;},Vec3AddScalar:function(){return Vec3AddScalar;},Vec3Backward:function(){return Vec3Backward;},Vec3Bezier:function(){return Vec3Bezier;},Vec3Callback:function(){return Vec3Callback;},Vec3CatmullRom:function(){return Vec3CatmullRom;},Vec3Ceil:function(){return Vec3Ceil;},Vec3Center:function(){return Vec3Center;},Vec3Clamp:function(){return Vec3Clamp;},Vec3ClampLength:function(){return Vec3ClampLength;},Vec3ClampScalar:function(){return Vec3ClampScalar;},Vec3Clone:function(){return Vec3Clone;},Vec3CopyFrom:function(){return Vec3CopyFrom;},Vec3Cross:function(){return Vec3Cross;},Vec3CrossNormalize:function(){return Vec3CrossNormalize;},Vec3Divide:function(){return Vec3Divide;},Vec3DivideScalar:function(){return Vec3DivideScalar;},Vec3Dot:function(){return Vec3Dot;},Vec3Down:function(){return Vec3Down;},Vec3Equals:function(){return Vec3Equals;},Vec3Floor:function(){return Vec3Floor;},Vec3Forward:function(){return Vec3Forward;},Vec3Fract:function(){return Vec3Fract;},Vec3FromCylindricalCoords:function(){return Vec3FromCylindricalCoords;},Vec3FromSphericalCoords:function(){return Vec3FromSphericalCoords;},Vec3FuzzyEquals:function(){return Vec3FuzzyEquals;},Vec3Hermite:function(){return Vec3Hermite;},Vec3Inverse:function(){return Vec3Inverse;},Vec3IsNonUniform:function(){return Vec3IsNonUniform;},Vec3Left:function(){return Vec3Left;},Vec3Lerp:function(){return Vec3Lerp;},Vec3Max:function(){return Vec3Max;},Vec3Min:function(){return Vec3Min;},Vec3Multiply:function(){return Vec3Multiply;},Vec3MultiplyByFloats:function(){return Vec3MultiplyByFloats;},Vec3Negate:function(){return Vec3Negate;},Vec3Normalize:function(){return Vec3Normalize;},Vec3One:function(){return Vec3One;},Vec3Project:function(){return Vec3Project;},Vec3Random:function(){return Vec3Random;},Vec3Reflect:function(){return Vec3Reflect;},Vec3Right:function(){return Vec3Right;},Vec3RotateX:function(){return Vec3RotateX;},Vec3RotateY:function(){return Vec3RotateY;},Vec3RotateZ:function(){return Vec3RotateZ;},Vec3Round:function(){return Vec3Round;},Vec3RoundToZero:function(){return Vec3RoundToZero;},Vec3Scale:function(){return Vec3Scale;},Vec3ScaleAndAdd:function(){return Vec3ScaleAndAdd;},Vec3SetLength:function(){return Vec3SetLength;},Vec3Subtract:function(){return Vec3Subtract;},Vec3SubtractScalar:function(){return Vec3SubtractScalar;},Vec3TransformMat4:function(){return Vec3TransformMat4;},Vec3TransformMat4Zero:function(){return Vec3TransformMat4Zero;},Vec3TransformQuat:function(){return Vec3TransformQuat;},Vec3Unproject:function(){return Vec3Unproject;},Vec3Up:function(){return Vec3Up;},Vec3Zero:function(){return Vec3Zero;},ZERO:function(){return ZERO;}});function Vec3Backward(){return new Vec3(0,0,-1);}function Vec3Down(){return new Vec3(0,-1,0);}function Vec3Forward(){return new Vec3(0,0,1);}function Vec3Left(){return new Vec3(-1,0,0);}function Vec3Right(){return new Vec3(1,0,0);}function Vec3Up(){return new Vec3(0,1,0);}function Vec3Zero(){return new Vec3(0,0,0);}var UP=Vec3Up();var DOWN=Vec3Down();var LEFT=Vec3Left();var RIGHT=Vec3Right();var FORWARD=Vec3Forward();var BACKWARD=Vec3Backward();var ZERO=Vec3Zero();function Vec3Dot(a,b){return a.x*b.x+a.y*b.y+a.z*b.z;}function GetVec3Angle(a,b){var ax=a.x,ay=a.y,az=a.z;var bx=b.x,by=b.y,bz=b.z;var mag1=Math.sqrt(ax*ax+ay*ay+az*az);var mag2=Math.sqrt(bx*bx+by*by+bz*bz);var mag=mag1*mag2;var c=mag&&Vec3Dot(a,b)/mag;return Math.acos(Math.min(Math.max(c,-1),1));}function GetVec3DistanceSquared(a,b){var x=a.x-b.x;var y=a.y-b.y;var z=a.z-b.z;return x*x+y*y+z*z;}function GetVec3Distance(a,b){return Math.sqrt(GetVec3DistanceSquared(a,b));}function GetVec3Length(a){var x=a.x,y=a.y,z=a.z;return Math.sqrt(x*x+y*y+z*z);}function GetVec3LengthSquared(a){var x=a.x,y=a.y,z=a.z;return x*x+y*y+z*z;}function GetVec3ManhattanDistance(a,b){return Math.abs(a.x-b.x)+Math.abs(a.y-b.y)+Math.abs(a.z-b.z);}function GetVec3ManhattanLength(a){return Math.abs(a.x)+Math.abs(a.y)+Math.abs(a.z);}var Vec3Callback=function(){"use strict";function _class(onChange,param,param1,param2){var x=param=== void 0?0:param,y=param1=== void 0?0:param1,z=param2=== void 0?0:param2;swcHelpers.classCallCheck(this,_class);this._x=x;this._y=y;this._z=z;this.onChange=onChange;}swcHelpers.createClass(_class,[{key:"destroy",value:function destroy(){this.onChange=NOOP;}},{key:"set",value:function set(param,param1,param2){var x=param=== void 0?0:param,y=param1=== void 0?0:param1,z=param2=== void 0?0:param2;this._x=x;this._y=y;this._z=z;if(this.onChange){this.onChange(this);}return this;}},{key:"x",get:function get(){return this._x;},set:function set(value){var prev=this._x;this._x=value;if(prev!==value){this.onChange(this);}}},{key:"y",get:function get(){return this._y;},set:function set(value){var prev=this._y;this._y=value;if(prev!==value){this.onChange(this);}}},{key:"z",get:function get(){return this._z;},set:function set(value){var prev=this._z;this._z=value;if(prev!==value){this.onChange(this);}}},{key:"toArray",value:function toArray(param,param1){var dst=param=== void 0?[]:param,index=param1=== void 0?0:param1;var ref=this,x=ref.x,y=ref.y,z=ref.z;dst[index]=x;dst[index+1]=y;dst[index+2]=z;return dst;}},{key:"fromArray",value:function fromArray(src,param){var index=param=== void 0?0:param;return this.set(src[index],src[index+1],src[index+2]);}},{key:"toString",value:function toString(){var ref=this,x=ref.x,y=ref.y,z=ref.z;return "{ x=".concat(x,", y=").concat(y,", z=").concat(z," }");}}]);return _class;}();var RGBCallback=function(Vec3Callback1){"use strict";swcHelpers.inherits(_class,Vec3Callback1);function _class(onChange,param,param1,param2){var r=param=== void 0?0:param,g=param1=== void 0?0:param1,b=param2=== void 0?0:param2;swcHelpers.classCallCheck(this,_class);return swcHelpers.possibleConstructorReturn(this,swcHelpers.getPrototypeOf(_class).call(this,onChange,r,g,b));}swcHelpers.createClass(_class,[{key:"r",get:function get(){return this.x;},set:function set(value){this.x=value;}},{key:"g",get:function get(){return this.y;},set:function set(value){this.y=value;}},{key:"b",get:function get(){return this.z;},set:function set(value){this.z=value;}},{key:"toString",value:function toString(){var ref=this,x=ref.x,y=ref.y,z=ref.z;return "[ r=".concat(x,", g=").concat(y,", b=").concat(z," ]");}}]);return _class;}(Vec3Callback);function Vec3Abs(a,param){var out=param=== void 0?new Vec3():param;return out.set(Math.abs(a.x),Math.abs(a.y),Math.abs(a.z));}function Vec3Add(a,b,param){var out=param=== void 0?new Vec3():param;return out.set(a.x+b.x,a.y+b.y,a.z+b.z);}function Vec3AddScalar(a,scalar,param){var out=param=== void 0?new Vec3():param;return out.set(a.x+scalar,a.y+scalar,a.z+scalar);}function Bezier(a,b,c,d,t){var inverseFactor=1-t;var inverseFactorTimesTwo=inverseFactor*inverseFactor;var factorTimes2=t*t;var factor1=inverseFactorTimesTwo*inverseFactor;var factor2=3*t*inverseFactorTimesTwo;var factor3=3*factorTimes2*inverseFactor;var factor4=factorTimes2*t;return a*factor1+b*factor2+c*factor3+d*factor4;}function Vec3Bezier(a,b,c,d,t,param){var out=param=== void 0?new Vec3():param;return out.set(Bezier(t,a.x,b.x,c.x,d.x),Bezier(t,a.y,b.y,c.y,d.y),Bezier(t,a.z,b.z,c.z,d.z));}function CatmullRom(t,p0,p1,p2,p3){var v0=(p2-p0)*0.5;var v1=(p3-p1)*0.5;var t2=t*t;var t3=t*t2;return (2*p1-2*p2+v0+v1)*t3+(-3*p1+3*p2-2*v0-v1)*t2+v0*t+p1;}function Vec3CatmullRom(p1,p2,p3,p4,t,param){var out=param=== void 0?new Vec3():param;return out.set(CatmullRom(t,p1.x,p2.x,p3.x,p4.x),CatmullRom(t,p1.y,p2.y,p3.y,p4.y),CatmullRom(t,p1.z,p2.z,p3.z,p4.z));}function Vec3Ceil(a,param){var out=param=== void 0?new Vec3():param;return out.set(Math.ceil(a.x),Math.ceil(a.y),Math.ceil(a.z));}function Vec3Scale(a,scalar,param){var out=param=== void 0?new Vec3():param;return out.set(a.x*scalar,a.y*scalar,a.z*scalar);}function Vec3Center(a,b,param){var out=param=== void 0?new Vec3():param;Vec3Add(a,b,out);return Vec3Scale(out,0.5,out);}function Vec3Clamp(a,min,max,param){var out=param=== void 0?new Vec3():param;return out.set(Clamp(a.x,min.x,max.x),Clamp(a.y,min.y,max.y),Clamp(a.z,min.z,max.z));}function Vec3DivideScalar(a,scalar,param){var out=param=== void 0?new Vec3():param;var x=a.x,y=a.y,z=a.z;return out.set(x/scalar,y/scalar,z/scalar);}function Vec3ClampLength(a,min,max,param){var out=param=== void 0?new Vec3():param;var length=GetVec3Length(a);Vec3DivideScalar(a,length||1,out);return Vec3Scale(out,Clamp(min,max,length),out);}function Vec3ClampScalar(a,min,max,param){var out=param=== void 0?new Vec3():param;return out.set(Clamp(a.x,min,max),Clamp(a.y,min,max),Clamp(a.z,min,max));}function Vec3Clone(source){var x=source.x,y=source.y,z=source.z;return new Vec3(x,y,z);}function Vec3CopyFrom(source,dest){var x=source.x,y=source.y,z=source.z;return dest.set(x,y,z);}function Vec3Cross(a,b,param){var out=param=== void 0?new Vec3():param;var ax=a.x,ay=a.y,az=a.z;var bx=b.x,by=b.y,bz=b.z;return out.set(ay*bz-az*by,az*bx-ax*bz,ax*by-ay*bx);}function Vec3CrossNormalize(a,b,param){var out=param=== void 0?new Vec3():param;var ax=a.x,ay=a.y,az=a.z;var bx=b.x,by=b.y,bz=b.z;var x=ay*bz-az*by;var y=az*bx-ax*bz;var z=ax*by-ay*bx;var len=x*x+y*y+z*z;if(len>0){len=1/Math.sqrt(len);}return out.set(x*len,y*len,z*len);}function Vec3Divide(a,b,param){var out=param=== void 0?new Vec3():param;return out.set(a.x/b.x,a.y/b.y,a.z/b.z);}function Vec3Equals(a,b){return a.x===b.x&&a.y===b.y&&a.z===b.z;}function Vec3Floor(a,param){var out=param=== void 0?new Vec3():param;return out.set(Math.floor(a.x),Math.floor(a.y),Math.floor(a.z));}function Vec3Fract(a,param){var out=param=== void 0?new Vec3():param;return out.set(a.x-Math.floor(a.x),a.y-Math.floor(a.y),a.z-Math.floor(a.z));}function Vec3FromCylindricalCoords(radius,theta,y,param){var out=param=== void 0?new Vec3():param;return out.set(radius*Math.sin(theta),y,radius*Math.cos(theta));}function Vec3FromSphericalCoords(radius,phi,theta,param){var out=param=== void 0?new Vec3():param;var sinPhiRadius=Math.sin(phi)*radius;return out.set(sinPhiRadius*Math.sin(theta),Math.cos(phi)*radius,sinPhiRadius*Math.cos(theta));}function FuzzyEqual(a,b,param){var epsilon=param=== void 0?0.0001:param;return Math.abs(a-b)<epsilon;}function Vec3FuzzyEquals(a,b,param){var epsilon=param=== void 0?0.0001:param;return FuzzyEqual(a.x,b.x,epsilon)&&FuzzyEqual(a.y,b.y,epsilon)&&FuzzyEqual(a.z,b.z,epsilon);}function Hermite(a,b,c,d,t){var squared=t*t;var factor1=squared*(2*t-3)+1;var factor2=squared*(t-2)+t;var factor3=squared*(t-1);var factor4=squared*(3-2*t);return a*factor1+b*factor2+c*factor3+d*factor4;}function Vec3Hermite(a,b,c,d,t,param){var out=param=== void 0?new Vec3():param;return out.set(Hermite(t,a.x,b.x,c.x,d.x),Hermite(t,a.y,b.y,c.y,d.y),Hermite(t,a.z,b.z,c.z,d.z));}function Vec3Inverse(a,param){var out=param=== void 0?new Vec3():param;return out.set(1/a.x,1/a.y,1/a.z);}function Vec3IsNonUniform(a){var absX=Math.abs(a.x);var absY=Math.abs(a.y);var absZ=Math.abs(a.z);return absX!==absY||absX!==absZ||absY!==absZ;}function Vec3Lerp(a,b,t,param){var out=param=== void 0?new Vec3():param;var x=a.x,y=a.y,z=a.z;return out.set(x+t*(b.x-x),y+t*(b.y-y),z+t*(b.z-z));}function Vec3Max(a,b,param){var out=param=== void 0?new Vec3():param;var ax=a.x,ay=a.y,az=a.z;var bx=b.x,by=b.y,bz=b.z;return out.set(Math.max(ax,bx),Math.max(ay,by),Math.max(az,bz));}function Vec3Min(a,b,param){var out=param=== void 0?new Vec3():param;var ax=a.x,ay=a.y,az=a.z;var bx=b.x,by=b.y,bz=b.z;return out.set(Math.min(ax,bx),Math.min(ay,by),Math.min(az,bz));}function Vec3Multiply(a,b,param){var out=param=== void 0?new Vec3():param;return out.set(a.x*b.x,a.y*b.y,a.z*b.z);}function Vec3MultiplyByFloats(a,x,y,z,param){var out=param=== void 0?new Vec3():param;return out.set(a.x*x,a.y*y,a.z*z);}function Vec3Negate(a,param){var out=param=== void 0?new Vec3():param;return out.set(-a.x,-a.y,-a.z);}function Vec3Normalize(a,param){var out=param=== void 0?new Vec3():param;var x=a.x,y=a.y,z=a.z;var len=x*x+y*y+z*z;if(len>0){len=1/Math.sqrt(len);}return out.set(x*len,y*len,z*len);}function Vec3One(){return new Vec3(1,1,1);}function Vec3TransformMat4(a,m,param){var out=param=== void 0?new Vec3():param;var _data=m.data,m00=_data[0],m01=_data[1],m02=_data[2],m03=_data[3],m10=_data[4],m11=_data[5],m12=_data[6],m13=_data[7],m20=_data[8],m21=_data[9],m22=_data[10],m23=_data[11],m30=_data[12],m31=_data[13],m32=_data[14],m33=_data[15];var x=a.x,y=a.y,z=a.z;var w=m03*x+m13*y+m23*z+m33;w=w||1;return out.set((m00*x+m10*y+m20*z+m30)/w,(m01*x+m11*y+m21*z+m31)/w,(m02*x+m12*y+m22*z+m32)/w);}var tempMatrix1=new Matrix4();var tempMatrix2=new Matrix4();function Vec3Project(v,world,transform,viewport,param){var out=param=== void 0?new Vec3():param;var x=viewport.x,y=viewport.y,width=viewport.width,height=viewport.height;tempMatrix1.set(width/2,0,0,0,0,-height/2,0,0,0,0,0.5,0,x+width/2,height/2+y,0.5,1);Mat4Multiply(world,transform,tempMatrix2);Mat4Multiply(tempMatrix2,tempMatrix1,tempMatrix2);return Vec3TransformMat4(v,tempMatrix2,out);}function Vec3Random(a,param,param1){var scale=param=== void 0?1:param,out=param1=== void 0?new Vec3():param1;var r=Math.random()*2*Math.PI;var z=Math.random()*2-1;var zScale=Math.sqrt(1-z*z)*scale;return out.set(Math.cos(r)*zScale,Math.sin(r)*zScale,z*scale);}function Vec3Subtract(a,b,param){var out=param=== void 0?new Vec3():param;return out.set(a.x-b.x,a.y-b.y,a.z-b.z);}function Vec3Reflect(a,normal,param){var out=param=== void 0?new Vec3():param;Vec3Scale(normal,2*Vec3Dot(a,normal),out);return Vec3Subtract(a,out,out);}function Vec3RotateX(a,origin,angle,param){var out=param=== void 0?new Vec3():param;var ax=a.x,ay=a.y,az=a.z;var bx=origin.x,by=origin.y,bz=origin.z;var px=ax-bx;var py=ay-by;var pz=az-bz;var rx=px;var ry=py*Math.cos(angle)-pz*Math.sin(angle);var rz=py*Math.sin(angle)+pz*Math.cos(angle);return out.set(rx+bx,ry+by,rz+bz);}function Vec3RotateY(a,origin,angle,param){var out=param=== void 0?new Vec3():param;var ax=a.x,ay=a.y,az=a.z;var bx=origin.x,by=origin.y,bz=origin.z;var px=ax-bx;var py=ay-by;var pz=az-bz;var rx=pz*Math.sin(angle)+px*Math.cos(angle);var ry=py;var rz=pz*Math.cos(angle)-px*Math.sin(angle);return out.set(rx+bx,ry+by,rz+bz);}function Vec3RotateZ(a,origin,angle,param){var out=param=== void 0?new Vec3():param;var ax=a.x,ay=a.y,az=a.z;var bx=origin.x,by=origin.y,bz=origin.z;var px=ax-bx;var py=ay-by;var pz=az-bz;var rx=px*Math.cos(angle)-py*Math.sin(angle);var ry=px*Math.sin(angle)+py*Math.cos(angle);var rz=pz;return out.set(rx+bx,ry+by,rz+bz);}function Vec3Round(a,param){var out=param=== void 0?new Vec3():param;return out.set(Math.round(a.x),Math.round(a.y),Math.round(a.z));}function Vec3RoundToZero(a,param){var out=param=== void 0?new Vec3():param;return out.set(a.x<0?Math.ceil(a.x):Math.floor(a.x),a.y<0?Math.ceil(a.y):Math.floor(a.y),a.z<0?Math.ceil(a.z):Math.floor(a.z));}function Vec3ScaleAndAdd(a,b,scalar,param){var out=param=== void 0?new Vec3():param;return out.set(a.x+b.x*scalar,a.y+b.y*scalar,a.z+b.z*scalar);}function Vec3SetLength(a,length,param){var out=param=== void 0?new Vec3():param;Vec3Normalize(a,out);return Vec3Scale(out,length,out);}function Vec3SubtractScalar(a,scalar,param){var out=param=== void 0?new Vec3():param;return out.set(a.x-scalar,a.y-scalar,a.z-scalar);}function Vec3TransformMat4Zero(a,m,param){var out=param=== void 0?new Vec3():param;var _data=m.data,m00=_data[0],m01=_data[1],m02=_data[2],m03=_data[3],m10=_data[4],m11=_data[5],m12=_data[6],m13=_data[7],m20=_data[8],m21=_data[9],m22=_data[10];var x=a.x,y=a.y,z=a.z;return out.set(m00*x+m10*y+m20*z,m01*x+m11*y+m21*z,m02*x+m12*y+m22*z);}function Vec3TransformQuat(a,q,param){var out=param=== void 0?new Vec3():param;var qx=q.x,qy=q.y,qz=q.z,qw=q.w;var x=a.x,y=a.y,z=a.z;var uvx=qy*z-qz*y;var uvy=qz*x-qx*z;var uvz=qx*y-qy*x;var uuvx=qy*uvz-qz*uvy;var uuvy=qz*uvx-qx*uvz;var uuvz=qx*uvy-qy*uvx;var w2=qw*2;uvx*=w2;uvy*=w2;uvz*=w2;uuvx*=2;uuvy*=2;uuvz*=2;return out.set(x+uvx+uuvx,y+uvy+uuvy,z+uvz+uuvz);}var matrix=new Matrix4();var screenSource=new Vec3();function Vec3Unproject(v,viewportWidth,viewportHeight,world,view,projection,param){var out=param=== void 0?new Vec3():param;Mat4Multiply(world,view,matrix);Mat4Multiply(matrix,projection,matrix);Mat4Invert(matrix,matrix);var x=v.x,y=v.y,z=v.z;screenSource.set(x/viewportWidth*2-1,-(y/viewportHeight*2-1),2*z-1);Vec3TransformMat4(screenSource,matrix,out);var data=matrix.data;var num=screenSource.x*data[3]+screenSource.y*data[7]+screenSource.z*data[11]+data[15];return Vec3Scale(out,1/num,out);}function QuatFromRotationAxis(axis,angle,param){var out=param=== void 0?new Quaternion():param;var sin=Math.sin(angle/2);Vec3Normalize(axis,axis);var x=axis.x,y=axis.y,z=axis.z;return out.set(x*sin,y*sin,z*sin,Math.cos(angle/2));}function QuatFromRotationMatrix(matrix2,param){var out=param=== void 0?new Quaternion():param;var _data=matrix2.data,m11=_data[0],m21=_data[1],m31=_data[2],m41=_data[3],m12=_data[4],m22=_data[5],m32=_data[6],m42=_data[7],m13=_data[8],m23=_data[9],m33=_data[10];var trace=m11+m22+m33;var s;if(trace>0){s=0.5/Math.sqrt(trace+1);return out.set((m32-m23)*s,(m13-m31)*s,(m21-m12)*s,0.25/s);}else if(m11>m22&&m11>m33){s=2*Math.sqrt(1+m11-m22-m33);return out.set(0.25*s,(m12+m21)/s,(m13+m31)/s,(m32-m23)/s);}else if(m22>m33){s=2*Math.sqrt(1+m22-m11-m33);return out.set((m12+m21)/s,0.25*s,(m23+m32)/s,(m13-m31)/s);}else{s=2*Math.sqrt(1+m33-m11-m22);return out.set((m13+m31)/s,(m23+m32)/s,0.25*s,(m21-m12)/s);}}function QuatFuzzyEquals(a,b,param){var epsilon=param=== void 0?0.0001:param;return FuzzyEqual(a.x,b.x,epsilon)&&FuzzyEqual(a.y,b.y,epsilon)&&FuzzyEqual(a.z,b.z,epsilon)&&FuzzyEqual(a.w,b.w,epsilon);}function QuatHermite(a,b,c,d,t,param){var out=param=== void 0?new Quaternion():param;return out.set(Hermite(t,a.x,b.x,c.x,d.x),Hermite(t,a.y,b.y,c.y,d.y),Hermite(t,a.z,b.z,c.z,d.z),Hermite(t,a.w,b.w,c.w,d.w));}function QuatInvert(a,param){var out=param=== void 0?new Quaternion():param;var x=a.x,y=a.y,z=a.z,w=a.w;var dot=x*x+y*y+z*z+w*w;var invDot=dot?1/dot:0;return out.set(-x*invDot,-y*invDot,-z*invDot,w*invDot);}function QuatMultiply(a,b,param){var out=param=== void 0?new Quaternion():param;var ax=a.x,ay=a.y,az=a.z,aw=a.w;var bx=b.x,by=b.y,bz=b.z,bw=b.w;return out.set(ax*bw+aw*bx+ay*bz-az*by,ay*bw+aw*by+az*bx-ax*bz,az*bw+aw*bz+ax*by-ay*bx,aw*bw-ax*bx-ay*by-az*bz);}function QuatMultiplyByFloats(a,x,y,z,w,param){var out=param=== void 0?new Quaternion():param;return out.set(a.x*x,a.y*y,a.z*z,a.w*w);}function QuatScale(a,scalar,param){var out=param=== void 0?new Quaternion():param;var x=a.x,y=a.y,z=a.z,w=a.w;return out.set(x*scalar,y*scalar,z*scalar,w*scalar);}function QuatNormalize(a,param){var out=param=== void 0?new Quaternion():param;var length=GetQuatLength(a);if(length===0){return out.set(0,0,0,1);}else{return QuatScale(a,length,out);}}function QuatSlerp(a,b,t,param){var out=param=== void 0?new Quaternion():param;if(t===0){return QuatCopyFrom(a,out);}else if(t===1){return QuatCopyFrom(b,out);}var x=a.x,y=a.y,z=a.z,w=a.w;var bx=b.x,by=b.y,bz=b.z,bw=b.w;var cosHalfTheta=w*bw+x*bx+y*by+z*bz;if(cosHalfTheta<0){out.set(-bx,-by,-bz,-bw);cosHalfTheta=-cosHalfTheta;}else{QuatCopyFrom(b,out);}if(cosHalfTheta>=1){return out.set(x,y,z,w);}var sqrSinHalfTheta=1-cosHalfTheta*cosHalfTheta;if(sqrSinHalfTheta<=Number.EPSILON){var s=1-t;out.set(s*x+t*out.x,s*y+t*out.y,s*z+t*out.z,s*w+t*out.w);return QuatNormalize(out,out);}var sinHalfTheta=Math.sqrt(sqrSinHalfTheta);var halfTheta=Math.atan2(sinHalfTheta,cosHalfTheta);var ratioA=Math.sin((1-t)*halfTheta)/sinHalfTheta;var ratioB=Math.sin(t*halfTheta)/sinHalfTheta;return out.set(x*ratioA+out.x*ratioB,y*ratioA+out.y*ratioB,z*ratioA+out.z*ratioB,w*ratioA+out.w*ratioB);}function QuatRotateTowards(a,b,step,param){var out=param=== void 0?new Quaternion():param;var angle=GetQuatAngle(a,b);if(angle===0){return QuatCopyFrom(a,out);}var t=Math.min(1,step/angle);return QuatSlerp(a,b,t,out);}function QuatRotateX(a,angle,param){var out=param=== void 0?new Quaternion():param;angle*=0.5;var x=a.x,y=a.y,z=a.z,w=a.w;var bx=Math.sin(angle);var bw=Math.cos(angle);return out.set(x*bw+w*bx,y*bw+z*bx,z*bw-y*bx,w*bw-x*bx);}function QuatRotateY(a,angle,param){var out=param=== void 0?new Quaternion():param;angle*=0.5;var x=a.x,y=a.y,z=a.z,w=a.w;var by=Math.sin(angle);var bw=Math.cos(angle);return out.set(x*bw-z*by,y*bw+w*by,z*bw+x*by,w*bw-y*by);}function QuatRotateZ(a,angle,param){var out=param=== void 0?new Quaternion():param;angle*=0.5;var x=a.x,y=a.y,z=a.z,w=a.w;var bz=Math.sin(angle);var bw=Math.cos(angle);return out.set(x*bw+y*bz,y*bw-x*bz,z*bw+w*bz,w*bw-z*bz);}function QuatRotationAlphaBetaGamma(alpha,beta,gamma,param){var out=param=== void 0?new Quaternion():param;var halfGammaPlusAlpha=(gamma+alpha)*0.5;var halfGammaMinusAlpha=(gamma-alpha)*0.5;var halfBeta=beta*0.5;return out.set(Math.cos(halfGammaMinusAlpha)*Math.sin(halfBeta),Math.sin(halfGammaMinusAlpha)*Math.sin(halfBeta),Math.sin(halfGammaPlusAlpha)*Math.cos(halfBeta),Math.cos(halfGammaPlusAlpha)*Math.cos(halfBeta));}function QuatScaleAndAdd(a,b,scalar,param){var out=param=== void 0?new Quaternion():param;return out.set(a.x+b.x*scalar,a.y+b.y*scalar,a.z+b.z*scalar,a.w+b.w*scalar);}function QuatSetAxisAngle(axis,angle,param){var out=param=== void 0?new Quaternion():param;var x=axis.x,y=axis.y,z=axis.z;angle*=0.5;var s=Math.sin(angle);return out.set(x*s,y*s,z*s,Math.cos(angle));}function QuatSetFromUnitVectors(a,from,to,param){var out=param=== void 0?new Quaternion():param;var fx=from.x,fy=from.y,fz=from.z;var tx=to.x,ty=to.y,tz=to.z;var epsilon=0.000001;var r=Vec3Dot(from,to)+1;if(r<epsilon){r=0;if(Math.abs(fx)>Math.abs(fz)){return out.set(-fy,fx,0,r);}else{return out.set(0,-fz,fy,r);}}else{return out.set(fy*tz-fz*ty,fz*tx-fx*tz,fx*ty-fy*tx,r);}}function QuatSubtract(a,b,param){var out=param=== void 0?new Quaternion():param;return out.set(a.x-b.x,a.y-b.y,a.z-b.z,a.w-b.w);}function QuatSubtractScalar(a,scalar,param){var out=param=== void 0?new Quaternion():param;var x=a.x,y=a.y,z=a.z,w=a.w;return out.set(x-scalar,y-scalar,z-scalar,w-scalar);}function QuatToEulerAngles(q,param){var out=param=== void 0?new Vec3():param;var x=q.x,y=q.y,z=q.z,w=q.w;var sqw=w*w;var sqz=z*z;var sqx=x*x;var sqy=y*y;var zAxisY=y*z-x*w;var limit=0.4999999;if(zAxisY< -limit){return out.set(Math.PI/2,2*Math.atan2(y,w),0);}else if(zAxisY>limit){return out.set(-Math.PI/2,2*Math.atan2(y,w),0);}else{return out.set(Math.asin(-2*(z*y-x*w)),Math.atan2(2*(z*x+y*w),sqz-sqx-sqy+sqw),Math.atan2(2*(x*y+z*w),-sqz-sqx+sqy+sqw));}}function QuatZero(){return new Quaternion(0,0,0,0);}var math_exports={};__export(math_exports,{Angle:function(){return angle_exports;},Average:function(){return Average;},Bernstein:function(){return Bernstein;},Between:function(){return Between;},Bezier:function(){return Bezier;},CatmullRom:function(){return CatmullRom;},CeilTo:function(){return CeilTo;},Clamp:function(){return Clamp;},DegToRad:function(){return DegToRad;},Difference:function(){return Difference;},Easing:function(){return easing_exports;},Factorial:function(){return Factorial;},FloatBetween:function(){return FloatBetween;},FloorTo:function(){return FloorTo;},FromPercent:function(){return FromPercent;},Fuzzy:function(){return fuzzy_exports;},GetSpeed:function(){return GetSpeed;},Hermite:function(){return Hermite;},Interpolation:function(){return interpolation_exports;},Linear:function(){return Linear2;},MATH_CONST:function(){return MATH_CONST;},Matrix2D:function(){return mat2d_exports;},Matrix4:function(){return mat4_exports;},MaxAdd:function(){return MaxAdd;},MinSub:function(){return MinSub;},Percent:function(){return Percent;},Pow2:function(){return pow2_exports;},Quaternion:function(){return quaternion_exports;},RadToDeg:function(){return RadToDeg;},RoundAwayFromZero:function(){return RoundAwayFromZero;},RoundTo:function(){return RoundTo;},SinCosTableGenerator:function(){return SinCosTableGenerator;},SmoothStep:function(){return SmoothStep;},SmootherStep:function(){return SmootherStep;},Snap:function(){return snap_exports;},Vec2:function(){return vec2_exports;},Vec3:function(){return vec3_exports;},Vec4:function(){return vec4_exports;},Within:function(){return Within;},Wrap:function(){return Wrap;}});var easing_exports={};__export(easing_exports,{Back:function(){return back_exports;},Bounce:function(){return bounce_exports;},Circular:function(){return circular_exports;},Cubic:function(){return cubic_exports;},Elastic:function(){return elastic_exports;},Expo:function(){return expo_exports;},GetEase:function(){return GetEase_exports;},Linear:function(){return Linear_exports;},Quadratic:function(){return quadratic_exports;},Quartic:function(){return quartic_exports;},Quintic:function(){return quintic_exports;},Sine:function(){return sine_exports;},Stepped:function(){return Stepped_exports;}});var back_exports={};__export(back_exports,{In:function(){return In;},InOut:function(){return InOut;},Out:function(){return Out;}});function In(v,param){var overshoot=param=== void 0?1.70158:param;return v*v*((overshoot+1)*v-overshoot);}function InOut(v,param){var overshoot=param=== void 0?1.70158:param;var s=overshoot*1.525;if((v*=2)<1){return 0.5*(v*v*((s+1)*v-s));}else{return 0.5*((v-=2)*v*((s+1)*v+s)+2);}}function Out(v,param){var overshoot=param=== void 0?1.70158:param;return (--v)*v*((overshoot+1)*v+overshoot)+1;}var bounce_exports={};__export(bounce_exports,{In:function(){return In2;},InOut:function(){return InOut2;},Out:function(){return Out2;}});function In2(v){v=1-v;if(v<1/2.75){return 1-7.5625*v*v;}else if(v<2/2.75){return 1-(7.5625*(v-=1.5/2.75)*v+0.75);}else if(v<2.5/2.75){return 1-(7.5625*(v-=2.25/2.75)*v+0.9375);}else{return 1-(7.5625*(v-=2.625/2.75)*v+0.984375);}}function InOut2(v){var reverse=false;if(v<0.5){v=1-v*2;reverse=true;}else{v=v*2-1;}if(v<1/2.75){v=7.5625*v*v;}else if(v<2/2.75){v=7.5625*(v-=1.5/2.75)*v+0.75;}else if(v<2.5/2.75){v=7.5625*(v-=2.25/2.75)*v+0.9375;}else{v=7.5625*(v-=2.625/2.75)*v+0.984375;}if(reverse){return (1-v)*0.5;}else{return v*0.5+0.5;}}function Out2(v){if(v<1/2.75){return 7.5625*v*v;}else if(v<2/2.75){return 7.5625*(v-=1.5/2.75)*v+0.75;}else if(v<2.5/2.75){return 7.5625*(v-=2.25/2.75)*v+0.9375;}else{return 7.5625*(v-=2.625/2.75)*v+0.984375;}}var circular_exports={};__export(circular_exports,{In:function(){return In3;},InOut:function(){return InOut3;},Out:function(){return Out3;}});function In3(v){return 1-Math.sqrt(1-v*v);}function InOut3(v){if((v*=2)<1){return -0.5*(Math.sqrt(1-v*v)-1);}else{return 0.5*(Math.sqrt(1-(v-=2)*v)+1);}}function Out3(v){return Math.sqrt(1-(--v)*v);}var cubic_exports={};__export(cubic_exports,{In:function(){return In4;},InOut:function(){return InOut4;},Out:function(){return Out4;}});function In4(v){return v*v*v;}function InOut4(v){if((v*=2)<1){return 0.5*v*v*v;}else{return 0.5*((v-=2)*v*v+2);}}function Out4(v){return (--v)*v*v+1;}var elastic_exports={};__export(elastic_exports,{In:function(){return In5;},InOut:function(){return InOut5;},Out:function(){return Out5;}});function In5(v,param,param1){var amplitude=param=== void 0?0.1:param,period=param1=== void 0?0.1:param1;if(v===0){return 0;}else if(v===1){return 1;}else{var s=period/4;if(amplitude<1){amplitude=1;}else{s=period*Math.asin(1/amplitude)/(2*Math.PI);}return -(amplitude*Math.pow(2,10*(v-=1))*Math.sin((v-s)*(2*Math.PI)/period));}}function InOut5(v,param,param1){var amplitude=param=== void 0?0.1:param,period=param1=== void 0?0.1:param1;if(v===0){return 0;}else if(v===1){return 1;}else{var s=period/4;if(amplitude<1){amplitude=1;}else{s=period*Math.asin(1/amplitude)/(2*Math.PI);}if((v*=2)<1){return -0.5*(amplitude*Math.pow(2,10*(v-=1))*Math.sin((v-s)*(2*Math.PI)/period));}else{return amplitude*Math.pow(2,-10*(v-=1))*Math.sin((v-s)*(2*Math.PI)/period)*0.5+1;}}}function Out5(v,param,param1){var amplitude=param=== void 0?0.1:param,period=param1=== void 0?0.1:param1;if(v===0){return 0;}else if(v===1){return 1;}else{var s=period/4;if(amplitude<1){amplitude=1;}else{s=period*Math.asin(1/amplitude)/(2*Math.PI);}return amplitude*Math.pow(2,-10*v)*Math.sin((v-s)*(2*Math.PI)/period)+1;}}var expo_exports={};__export(expo_exports,{In:function(){return In6;},InOut:function(){return InOut6;},Out:function(){return Out6;}});function In6(v){return Math.pow(2,10*(v-1))-0.001;}function InOut6(v){if(v==0){return 0;}if(v==1){return 1;}if((v*=2)<1){return 0.5*Math.pow(2,10*(v-1));}else{return 0.5*(2-Math.pow(2,-10*(v-1)));}}function Out6(v){return 1-Math.pow(2,-10*v);}var GetEase_exports={};__export(GetEase_exports,{GetEase:function(){return GetEase;}});var quadratic_exports={};__export(quadratic_exports,{In:function(){return In7;},InOut:function(){return InOut7;},Out:function(){return Out7;}});function In7(v){return v*v;}function InOut7(v){if((v*=2)<1){return 0.5*v*v;}else{return -0.5*((--v)*(v-2)-1);}}function Out7(v){return v*(2-v);}var quartic_exports={};__export(quartic_exports,{In:function(){return In8;},InOut:function(){return InOut8;},Out:function(){return Out8;}});function In8(v){return v*v*v*v;}function InOut8(v){if((v*=2)<1){return 0.5*v*v*v*v;}else{return -0.5*((v-=2)*v*v*v-2);}}function Out8(v){return -((--v)*v*v*v-1);}var quintic_exports={};__export(quintic_exports,{In:function(){return In9;},InOut:function(){return InOut9;},Out:function(){return Out9;}});function In9(v){return v*v*v*v*v;}function InOut9(v){if((v*=2)<1){return 0.5*v*v*v*v*v;}else{return 0.5*((v-=2)*v*v*v*v+2);}}function Out9(v){return (v=v-1)*v*v*v*v+1;}var sine_exports={};__export(sine_exports,{In:function(){return In10;},InOut:function(){return InOut10;},Out:function(){return Out10;}});function In10(v){if(v===0){return 0;}else if(v===1){return 1;}else{return 1-Math.cos(v*Math.PI/2);}}function InOut10(v){if(v===0){return 0;}else if(v===1){return 1;}else{return 0.5*(1-Math.cos(Math.PI*v));}}function Out10(v){if(v===0){return 0;}else if(v===1){return 1;}else{return Math.sin(v*Math.PI/2);}}var Linear_exports={};__export(Linear_exports,{Linear:function(){return Linear;}});function Linear(v){return v;}var Stepped_exports={};__export(Stepped_exports,{Stepped:function(){return Stepped;}});function Stepped(v,param){var steps=param=== void 0?1:param;if(v<=0){return 0;}else if(v>=1){return 1;}else{return ((steps*v|0)+1)*(1/steps);}}var EaseMap=new Map([["power0",Linear],["power1",Out7],["power2",Out4],["power3",Out8],["power4",Out9],["linear",Linear],["quad",Out7],["cubic",Out4],["quart",Out8],["quint",Out9],["sine",Out10],["expo",Out6],["circ",Out3],["elastic",Out5],["back",Out],["bounce",Out2],["stepped",Stepped],["quad.in",In7],["cubic.in",In4],["quart.in",In8],["quint.in",In9],["sine.in",In10],["expo.in",In6],["circ.in",In3],["elastic.in",In5],["back.in",In],["bounce.in",In2],["quad.out",Out7],["cubic.out",Out4],["quart.out",Out8],["quint.out",Out9],["sine.out",Out10],["expo.out",Out6],["circ.out",Out3],["elastic.out",Out5],["back.out",Out],["bounce.out",Out2],["quad.inout",InOut7],["cubic.inout",InOut4],["quart.inout",InOut8],["quint.inout",InOut9],["sine.inout",InOut10],["expo.inout",InOut6],["circ.inout",InOut3],["elastic.inout",InOut5],["back.inout",InOut],["bounce.inout",InOut2]]);function GetEase(name){name=name.toLowerCase();name=name.replace("ease","");if(EaseMap.has(name)){return EaseMap.get(name);}else{return Linear;}}var fuzzy_exports={};__export(fuzzy_exports,{FuzzyCeil:function(){return FuzzyCeil;},FuzzyEqual:function(){return FuzzyEqual;},FuzzyFloor:function(){return FuzzyFloor;},FuzzyGreaterThan:function(){return FuzzyGreaterThan;},FuzzyLessThan:function(){return FuzzyLessThan;}});function FuzzyCeil(value,param){var epsilon=param=== void 0?0.0001:param;return Math.ceil(value-epsilon);}function FuzzyFloor(value,param){var epsilon=param=== void 0?0.0001:param;return Math.floor(value+epsilon);}function FuzzyGreaterThan(a,b,param){var epsilon=param=== void 0?0.0001:param;return a>b-epsilon;}function FuzzyLessThan(a,b,param){var epsilon=param=== void 0?0.0001:param;return a<b+epsilon;}var interpolation_exports={};__export(interpolation_exports,{BezierInterpolation:function(){return BezierInterpolation;},CatmullRomInterpolation:function(){return CatmullRomInterpolation;},CubicBezierInterpolation:function(){return CubicBezierInterpolation;},LinearInterpolation:function(){return LinearInterpolation;},QuadraticBezierInterpolation:function(){return QuadraticBezierInterpolation;},SmoothStepInterpolation:function(){return SmoothStepInterpolation;},SmootherStepInterpolation:function(){return SmootherStepInterpolation;}});function Factorial(value){if(value===0){return 1;}var res=value;while(--value){res*=value;}return res;}function Bernstein(n,i1){return Factorial(n)/Factorial(i1)/Factorial(n-i1);}function BezierInterpolation(v,k){var b=0;var n=v.length-1;for(var i1=0;i1<=n;i1++){b+=Math.pow(1-k,n-i1)*Math.pow(k,i1)*v[i1]*Bernstein(n,i1);}return b;}function CatmullRomInterpolation(v,k){var m=v.length-1;var f=m*k;var i1=Math.floor(f);if(v[0]===v[m]){if(k<0){i1=Math.floor(f=m*(1+k));}return CatmullRom(f-i1,v[(i1-1+m)%m],v[i1],v[(i1+1)%m],v[(i1+2)%m]);}else{if(k<0){return v[0]-(CatmullRom(-f,v[0],v[0],v[1],v[1])-v[0]);}if(k>1){return v[m]-(CatmullRom(f-m,v[m],v[m],v[m-1],v[m-1])-v[m]);}return CatmullRom(f-i1,v[i1?i1-1:0],v[i1],v[m<i1+1?m:i1+1],v[m<i1+2?m:i1+2]);}}function P0(t,p){var k=1-t;return k*k*k*p;}function P1(t,p){var k=1-t;return 3*k*k*t*p;}function P2(t,p){return 3*(1-t)*t*t*p;}function P3(t,p){return t*t*t*p;}function CubicBezierInterpolation(t,p0,p1,p2,p3){return P0(t,p0)+P1(t,p1)+P2(t,p2)+P3(t,p3);}function Linear2(p0,p1,t){return (p1-p0)*t+p0;}function LinearInterpolation(v,k){var m=v.length-1;var f=m*k;var i1=Math.floor(f);if(k<0){return Linear2(v[0],v[1],f);}else if(k>1){return Linear2(v[m],v[m-1],m-f);}else{return Linear2(v[i1],v[i1+1>m?m:i1+1],f-i1);}}function P02(t,p){var k=1-t;return k*k*p;}function P12(t,p){return 2*(1-t)*t*p;}function P22(t,p){return t*t*p;}function QuadraticBezierInterpolation(t,p0,p1,p2){return P02(t,p0)+P12(t,p1)+P22(t,p2);}function SmoothStep(x,min,max){if(x<=min){return 0;}if(x>=max){return 1;}x=(x-min)/(max-min);return x*x*(3-2*x);}function SmoothStepInterpolation(t,min,max){return min+(max-min)*SmoothStep(t,0,1);}function SmootherStep(x,min,max){x=Math.max(0,Math.min(1,(x-min)/(max-min)));return x*x*x*(x*(x*6-15)+10);}function SmootherStepInterpolation(t,min,max){return min+(max-min)*SmootherStep(t,0,1);}var mat2d_exports={};__export(mat2d_exports,{GetMat2dDeterminant:function(){return GetMat2dDeterminant;},GetMat2dFrobenius:function(){return GetMat2dFrobenius;},Mat2dAdd:function(){return Mat2dAdd;},Mat2dAppend:function(){return Mat2dAppend;},Mat2dClone:function(){return Mat2dClone;},Mat2dCopyFrom:function(){return Mat2dCopyFrom;},Mat2dCopyToContext:function(){return Mat2dCopyToContext;},Mat2dEquals:function(){return Mat2dEquals;},Mat2dFromRotation:function(){return Mat2dFromRotation;},Mat2dFromScaling:function(){return Mat2dFromScaling;},Mat2dFromTranslation:function(){return Mat2dFromTranslation;},Mat2dFuzzyEquals:function(){return Mat2dFuzzyEquals;},Mat2dGlobalToLocal:function(){return Mat2dGlobalToLocal;},Mat2dITRS:function(){return Mat2dITRS;},Mat2dITRSS:function(){return Mat2dITRSS;},Mat2dIdentity:function(){return Mat2dIdentity;},Mat2dInvert:function(){return Mat2dInvert;},Mat2dLocalToGlobal:function(){return Mat2dLocalToGlobal;},Mat2dMultiply:function(){return Mat2dMultiply;},Mat2dMultiplyScalar:function(){return Mat2dMultiplyScalar;},Mat2dMultiplyScalarAndAdd:function(){return Mat2dMultiplyScalarAndAdd;},Mat2dRotate:function(){return Mat2dRotate;},Mat2dScale:function(){return Mat2dScale;},Mat2dSetToContext:function(){return Mat2dSetToContext;},Mat2dSkew:function(){return Mat2dSkew;},Mat2dSubtract:function(){return Mat2dSubtract;},Mat2dTranslate:function(){return Mat2dTranslate;},Mat2dZero:function(){return Mat2dZero;},Matrix2D:function(){return Matrix2D;}});function GetMat2dDeterminant(src){var a=src.a,b=src.b,c=src.c,d=src.d;return a*d-b*c;}function GetMat2dFrobenius(src){return Math.hypot(src.a,src.b,src.c,src.d,src.tx,src.ty,1);}function Mat2dAdd(a,b,param){var out=param=== void 0?new Matrix2D():param;return out.set(a.a+b.a,a.b+b.b,a.c+b.c,a.d+b.d,a.tx+b.tx,a.ty+b.ty);}function Mat2dAppend(mat1,mat2,param){var out=param=== void 0?new Matrix2D():param;var a1=mat1.a,b1=mat1.b,c1=mat1.c,d1=mat1.d,tx1=mat1.tx,ty1=mat1.ty;var a2=mat2.a,b2=mat2.b,c2=mat2.c,d2=mat2.d,tx2=mat2.tx,ty2=mat2.ty;return out.set(a2*a1+b2*c1,a2*b1+b2*d1,c2*a1+d2*c1,c2*b1+d2*d1,tx2*a1+ty2*c1+tx1,tx2*b1+ty2*d1+ty1);}function Mat2dClone(src){return new Matrix2D(src.a,src.b,src.c,src.d,src.tx,src.ty);}function Mat2dCopyFrom(src,target){var a=src.a,b=src.b,c=src.c,d=src.d,tx=src.tx,ty=src.ty;return target.set(a,b,c,d,tx,ty);}function Mat2dCopyToContext(src,context){var a=src.a,b=src.b,c=src.c,d=src.d,tx=src.tx,ty=src.ty;context.transform(a,b,c,d,tx,ty);return context;}function Mat2dEquals(a,b){return a.a===b.a&&a.b===b.b&&a.c===b.c&&a.d===b.d&&a.tx===b.tx&&a.ty===b.ty;}function Mat2dRotate(target,angle,param){var out=param=== void 0?new Matrix2D():param;var a=target.a,b=target.b,c=target.c,d=target.d,tx=target.tx,ty=target.ty;var sin=Math.sin(angle);var cos=Math.cos(angle);return out.set(a*cos+c*sin,b*cos+d*sin,a* -sin+c*cos,b* -sin+d*cos,tx,ty);}function Mat2dFromRotation(angle){var target=new Matrix2D();return Mat2dRotate(target,angle,target);}function Mat2dScale(target,scaleX,scaleY,param){var out=param=== void 0?new Matrix2D():param;var a=target.a,b=target.b,c=target.c,d=target.d,tx=target.tx,ty=target.ty;return out.set(a*scaleX,b*scaleX,c*scaleY,d*scaleY,tx,ty);}function Mat2dFromScaling(scaleX,param){var scaleY=param=== void 0?scaleX:param;var target=new Matrix2D();return Mat2dScale(target,scaleX,scaleY,target);}function Mat2dTranslate(target,x,y,param){var out=param=== void 0?new Matrix2D():param;var a=target.a,b=target.b,c=target.c,d=target.d,tx=target.tx,ty=target.ty;out.tx=a*x+c*y+tx;out.ty=b*x+d*y+ty;return out;}function Mat2dFromTranslation(x,y){var target=new Matrix2D();return Mat2dTranslate(target,x,y,target);}function Mat2dFuzzyEquals(a,b,param){var epsilon=param=== void 0?0.000001:param;var a0=a.a,b0=a.b,c0=a.c,d0=a.d,tx0=a.tx,ty0=a.ty;var a1=b.a,b1=b.b,c1=b.c,d1=b.d,tx1=b.tx,ty1=b.ty;return Math.abs(a0-a1)<=epsilon*Math.max(1,Math.abs(a0),Math.abs(a1))&&Math.abs(b0-b1)<=epsilon*Math.max(1,Math.abs(b0),Math.abs(b1))&&Math.abs(c0-c1)<=epsilon*Math.max(1,Math.abs(c0),Math.abs(c1))&&Math.abs(d0-d1)<=epsilon*Math.max(1,Math.abs(d0),Math.abs(d1))&&Math.abs(tx0-tx1)<=epsilon*Math.max(1,Math.abs(tx0),Math.abs(tx1))&&Math.abs(ty0-ty1)<=epsilon*Math.max(1,Math.abs(ty0),Math.abs(ty1));}var Vec2=function(){"use strict";function _class(param,param1){var x=param=== void 0?0:param,y=param1=== void 0?0:param1;swcHelpers.classCallCheck(this,_class);this.set(x,y);}swcHelpers.createClass(_class,[{key:"set",value:function set(param,param1){var x=param=== void 0?0:param,y=param1=== void 0?0:param1;this.x=x;this.y=y;return this;}},{key:"toArray",value:function toArray(param,param1){var dst=param=== void 0?[]:param,index=param1=== void 0?0:param1;var ref=this,x=ref.x,y=ref.y;dst[index]=x;dst[index+1]=y;return dst;}},{key:"fromArray",value:function fromArray(src,param){var index=param=== void 0?0:param;return this.set(src[index],src[index+1]);}},{key:"toString",value:function toString(){var ref=this,x=ref.x,y=ref.y;return "{ x=".concat(x,", y=").concat(y," }");}}]);return _class;}();function Mat2dGlobalToLocal(mat,x,y,param){var out=param=== void 0?new Vec2():param;var a=mat.a,b=mat.b,c=mat.c,d=mat.d,tx=mat.tx,ty=mat.ty;var id=1/(a*d+c* -b);return out.set(d*id*x+-c*id*y+(ty*c-tx*d)*id,a*id*y+-b*id*x+(-ty*a+tx*b)*id);}function Mat2dITRS(target,x,y,angle,scaleX,scaleY){if(angle===0){return target.set(1,0,0,1,x,y);}else{var sin=Math.sin(angle);var cos=Math.cos(angle);return target.set(cos*scaleX,sin*scaleX,-sin*scaleY,cos*scaleY,x,y);}}function Mat2dITRSS(target,x,y,param,param1,param2,param3,param4){var angle=param=== void 0?0:param,scaleX=param1=== void 0?1:param1,scaleY=param2=== void 0?1:param2,skewX=param3=== void 0?0:param3,skewY=param4=== void 0?0:param4;if(angle===0){return target.set(1,0,0,1,x,y);}else{return target.set(Math.cos(angle+skewY)*scaleX,Math.sin(angle+skewY)*scaleX,-Math.sin(angle-skewX)*scaleY,Math.cos(angle-skewX)*scaleY,x,y);}}function Mat2dIdentity(){return new Matrix2D();}function Mat2dInvert(target,param){var out=param=== void 0?new Matrix2D():param;var a=target.a,b=target.b,c=target.c,d=target.d,tx=target.tx,ty=target.ty;var determinant=a*d-b*c;if(determinant){determinant=1/determinant;out.set(d*determinant,-b*determinant,-c*determinant,a*determinant,(c*ty-d*tx)*determinant,(b*tx-a*ty)*determinant);}return out;}function Mat2dLocalToGlobal(mat,x,y,param){var out=param=== void 0?new Vec2():param;var a=mat.a,b=mat.b,c=mat.c,d=mat.d,tx=mat.tx,ty=mat.ty;return out.set(a*x+c*y+tx,b*x+d*y+ty);}function Mat2dMultiply(target,src,param){var out=param=== void 0?new Matrix2D():param;var a0=target.a,b0=target.b,c0=target.c,d0=target.d,tx0=target.tx,ty0=target.ty;var a1=src.a,b1=src.b,c1=src.c,d1=src.d,tx1=src.tx,ty1=src.ty;return out.set(a0*a1+c0*b1,b0*a1+d0*b1,a0*c1+c0*d1,b0*c1+d0*d1,a0*tx1+c0*ty1+tx0,b0*tx1+d0*ty1+ty0);}function Mat2dMultiplyScalar(target,scalar,param){var out=param=== void 0?new Matrix2D():param;var a=target.a,b=target.b,c=target.c,d=target.d,tx=target.tx,ty=target.ty;return out.set(a*scalar,b*scalar,c*scalar,d*scalar,tx*scalar,ty*scalar);}function Mat2dMultiplyScalarAndAdd(target,src,scalar,param){var out=param=== void 0?new Matrix2D():param;var a=src.a,b=src.b,c=src.c,d=src.d,tx=src.tx,ty=src.ty;var ta=target.a,tb=target.b,tc=target.c,td=target.d,ttx=target.tx,tty=target.ty;return out.set(ta+a*scalar,tb+b*scalar,tc+c*scalar,td+d*scalar,ttx+tx*scalar,tty+ty*scalar);}function Mat2dSetToContext(src,context){var a=src.a,b=src.b,c=src.c,d=src.d,tx=src.tx,ty=src.ty;context.setTransform(a,b,c,d,tx,ty);return context;}function Mat2dSkew(target,angleX,angleY,param){var out=param=== void 0?new Matrix2D():param;var a=target.a,b=target.b,c=target.c,d=target.d,tx=target.tx,ty=target.ty;return out.set(a,b+Math.tan(angleX),c+Math.tan(angleY),d,tx,ty);}function Mat2dSubtract(a,b,param){var out=param=== void 0?new Matrix2D():param;return out.set(a.a-b.a,a.b-b.b,a.c-b.c,a.d-b.d,a.tx-b.tx,a.ty-b.ty);}function Mat2dZero(target){return target.set(0,0,0,0,0,0);}var pow2_exports={};__export(pow2_exports,{GetPowerOfTwo:function(){return GetPowerOfTwo;},IsSizePowerOfTwo:function(){return IsSizePowerOfTwo;},IsValuePowerOfTwo:function(){return IsValuePowerOfTwo;}});function GetPowerOfTwo(value){var index=Math.log(value)/0.6931471805599453;return 1<<Math.ceil(index);}function IsSizePowerOfTwo(width,height){if(width<1||height<1){return false;}return (width&width-1)===0&&(height&height-1)===0;}function IsValuePowerOfTwo(value){return value>0&&(value&value-1)===0;}var snap_exports={};__export(snap_exports,{SnapCeil:function(){return SnapCeil;},SnapFloor:function(){return SnapFloor;},SnapTo:function(){return SnapTo;}});function SnapCeil(value,gap,param,param1){var start=param=== void 0?0:param,divide=param1=== void 0?false:param1;if(gap===0){return value;}value-=start;value=gap*Math.ceil(value/gap);return divide?(start+value)/gap:start+value;}function SnapFloor(value,gap,param,param1){var start=param=== void 0?0:param,divide=param1=== void 0?false:param1;if(gap===0){return value;}value-=start;value=gap*Math.floor(value/gap);return divide?(start+value)/gap:start+value;}function SnapTo(value,gap,param,param1){var start=param=== void 0?0:param,divide=param1=== void 0?false:param1;if(gap===0){return value;}value-=start;value=gap*Math.round(value/gap);return divide?(start+value)/gap:start+value;}var vec2_exports={};__export(vec2_exports,{GetChebyshevDistance:function(){return GetChebyshevDistance;},GetDistanceFromSegment:function(){return GetDistanceFromSegment;},GetVec2Angle:function(){return GetVec2Angle;},GetVec2AngleY:function(){return GetVec2AngleY;},GetVec2Distance:function(){return GetVec2Distance;},GetVec2DistancePower:function(){return GetVec2DistancePower;},GetVec2DistanceSquared:function(){return GetVec2DistanceSquared;},GetVec2Length:function(){return GetVec2Length;},GetVec2LengthSquared:function(){return GetVec2LengthSquared;},GetVec2ManhattanDistance:function(){return GetVec2ManhattanDistance;},GetVec2ManhattanLength:function(){return GetVec2ManhattanLength;},Vec2:function(){return Vec2;},Vec2Abs:function(){return Vec2Abs;},Vec2Add:function(){return Vec2Add;},Vec2AddScalar:function(){return Vec2AddScalar;},Vec2Bezier:function(){return Vec2Bezier;},Vec2Callback:function(){return Vec2Callback;},Vec2CatmullRom:function(){return Vec2CatmullRom;},Vec2Ceil:function(){return Vec2Ceil;},Vec2Center:function(){return Vec2Center;},Vec2Clamp:function(){return Vec2Clamp;},Vec2ClampScalar:function(){return Vec2ClampScalar;},Vec2Clone:function(){return Vec2Clone;},Vec2CopyFrom:function(){return Vec2CopyFrom;},Vec2Cross:function(){return Vec2Cross;},Vec2Divide:function(){return Vec2Divide;},Vec2DivideScalar:function(){return Vec2DivideScalar;},Vec2Dot:function(){return Vec2Dot;},Vec2Equals:function(){return Vec2Equals;},Vec2Floor:function(){return Vec2Floor;},Vec2Fract:function(){return Vec2Fract;},Vec2FromGridIndex:function(){return Vec2FromGridIndex;},Vec2FromTransform:function(){return Vec2FromTransform;},Vec2FuzzyEquals:function(){return Vec2FuzzyEquals;},Vec2Hermite:function(){return Vec2Hermite;},Vec2Inverse:function(){return Vec2Inverse;},Vec2Lerp:function(){return Vec2Lerp;},Vec2Max:function(){return Vec2Max;},Vec2Min:function(){return Vec2Min;},Vec2Multiply:function(){return Vec2Multiply;},Vec2MultiplyByFloats:function(){return Vec2MultiplyByFloats;},Vec2Negate:function(){return Vec2Negate;},Vec2Normalize:function(){return Vec2Normalize;},Vec2One:function(){return Vec2One;},Vec2PerpDot:function(){return Vec2PerpDot;},Vec2Random:function(){return Vec2Random;},Vec2Rotate:function(){return Vec2Rotate;},Vec2Round:function(){return Vec2Round;},Vec2RoundToZero:function(){return Vec2RoundToZero;},Vec2Scale:function(){return Vec2Scale;},Vec2ScaleAndAdd:function(){return Vec2ScaleAndAdd;},Vec2SetLength:function(){return Vec2SetLength;},Vec2Subtract:function(){return Vec2Subtract;},Vec2SubtractScalar:function(){return Vec2SubtractScalar;},Vec2Transform:function(){return Vec2Transform;},Vec2TransformMat2d:function(){return Vec2TransformMat2d;},Vec2TransformMat4:function(){return Vec2TransformMat4;},Vec2Zero:function(){return Vec2Zero;}});function GetChebyshevDistance(a,b){return Math.max(Math.abs(a.x-b.x),Math.abs(a.y-b.y));}function GetVec2DistanceSquared(a,b){var x=a.x-b.x;var y=a.y-b.y;return x*x+y*y;}function GetVec2Distance(a,b){return Math.sqrt(GetVec2DistanceSquared(a,b));}function Vec2Add(a,b,param){var out=param=== void 0?new Vec2():param;return out.set(a.x+b.x,a.y+b.y);}function Vec2Dot(a,b){return a.x*b.x+a.y*b.y;}function Vec2MultiplyByFloats(a,x,y,param){var out=param=== void 0?new Vec2():param;return out.set(a.x*x,a.y*y);}function Vec2Subtract(a,b,param){var out=param=== void 0?new Vec2():param;return out.set(a.x-b.x,a.y-b.y);}function GetDistanceFromSegment(p,a,b){var d=GetVec2DistanceSquared(a,b);if(d===0){return GetVec2Distance(p,a);}var v=Vec2Subtract(b,a);Vec2Subtract(p,a,p);var t=Math.max(0,Math.min(1,Vec2Dot(p,v)/12));var proj=Vec2Add(a,Vec2MultiplyByFloats(v,t,t,v));return GetVec2Distance(p,proj);}function GetVec2Angle(a,b){return Math.atan2(b.y-a.y,b.x-a.x);}function GetVec2AngleY(a,b){return Math.atan2(b.x-a.x,b.y-a.y);}function GetVec2DistancePower(a,b,param){var pow=param=== void 0?2:param;return Math.sqrt(Math.pow(b.x-a.x,pow)+Math.pow(b.y-a.y,pow));}function GetVec2Length(a){return Math.sqrt(a.x*a.x+a.y*a.y);}function GetVec2LengthSquared(a){return a.x*a.x+a.y*a.y;}function GetVec2ManhattanDistance(a,b){return Math.abs(a.x-b.x)+Math.abs(a.y-b.y);}function GetVec2ManhattanLength(a){return Math.abs(a.x)+Math.abs(a.y);}function Vec2Abs(a,param){var out=param=== void 0?new Vec2():param;return out.set(Math.abs(a.x),Math.abs(a.y));}function Vec2AddScalar(a,scalar,param){var out=param=== void 0?new Vec2():param;return out.set(a.x+scalar,a.y+scalar);}function Vec2Bezier(a,b,c,d,t,param){var out=param=== void 0?new Vec2():param;return out.set(Bezier(t,a.x,b.x,c.x,d.x),Bezier(t,a.y,b.y,c.y,d.y));}function Vec2CatmullRom(p1,p2,p3,p4,t,param){var out=param=== void 0?new Vec2():param;return out.set(CatmullRom(t,p1.x,p2.x,p3.x,p4.x),CatmullRom(t,p1.y,p2.y,p3.y,p4.y));}function Vec2Ceil(a,param){var out=param=== void 0?new Vec2():param;return out.set(Math.ceil(a.x),Math.ceil(a.y));}function Vec2Scale(a,scalar,param){var out=param=== void 0?new Vec2():param;return out.set(a.x*scalar,a.y*scalar);}function Vec2Center(a,b,param){var out=param=== void 0?new Vec2():param;Vec2Add(a,b,out);return Vec2Scale(out,0.5,out);}function Vec2Clamp(a,min,max,param){var out=param=== void 0?new Vec2():param;return out.set(Clamp(a.x,min.x,max.x),Clamp(a.y,min.y,max.y));}function Vec2ClampScalar(a,min,max,param){var out=param=== void 0?new Vec2():param;return out.set(Clamp(a.x,min,max),Clamp(a.y,min,max));}function Vec2Clone(source){return new Vec2(source.x,source.y);}function Vec2CopyFrom(source,dest){return dest.set(source.x,source.y);}function Vec2Cross(a,b){return a.x*b.y-a.y*b.x;}function Vec2Divide(a,b,param){var out=param=== void 0?new Vec2():param;return out.set(a.x/b.x,a.y/b.y);}function Vec2DivideScalar(a,scalar,param){var out=param=== void 0?new Vec2():param;return out.set(a.x/scalar,a.y/scalar);}function Vec2Equals(a,b){return a.x===b.x&&a.y===b.y;}function Vec2Floor(a,param){var out=param=== void 0?new Vec2():param;return out.set(Math.floor(a.x),Math.floor(a.y));}function Vec2Fract(a,param){var out=param=== void 0?new Vec2():param;return out.set(a.x-Math.floor(a.x),a.y-Math.floor(a.y));}function Vec2FromGridIndex(index,width,height,param){var out=param=== void 0?new Vec2():param;var x=0;var y=0;var total=width*height;if(index>0&&index<=total){if(index>width-1){y=Math.floor(index/width);x=index-y*width;}else{x=index;}out.set(x,y);}return out;}function Vec2FromTransform(x,y,positionX,positionY,rotation,scaleX,scaleY,param){var out=param=== void 0?new Vec2():param;var sin=Math.sin(rotation);var cos=Math.cos(rotation);var a=cos*scaleX;var b=sin*scaleX;var c=-sin*scaleY;var d=cos*scaleY;var id=1/(a*d+c* -b);return out.set(d*id*x+-c*id*y+(positionY*c-positionX*d)*id,a*id*y+-b*id*x+(-positionY*a+positionX*b)*id);}function Vec2FuzzyEquals(a,b,param){var epsilon=param=== void 0?0.0001:param;return FuzzyEqual(a.x,b.x,epsilon)&&FuzzyEqual(a.y,b.y,epsilon);}function Vec2Hermite(a,b,c,d,t,param){var out=param=== void 0?new Vec2():param;return out.set(Hermite(t,a.x,b.x,c.x,d.x),Hermite(t,a.y,b.y,c.y,d.y));}function Vec2Inverse(a,param){var out=param=== void 0?new Vec2():param;return out.set(1/a.x,1/a.y);}function Vec2Lerp(a,b,t,param){var out=param=== void 0?new Vec2():param;var x=a.x;var y=a.y;return out.set(x+t*(b.x-x),y+t*(b.y-y));}function Vec2Max(a,b,param){var out=param=== void 0?new Vec2():param;var ax=a.x,ay=a.y;var bx=b.x,by=b.y;return out.set(Math.max(ax,bx),Math.max(ay,by));}function Vec2Min(a,b,param){var out=param=== void 0?new Vec2():param;var ax=a.x,ay=a.y;var bx=b.x,by=b.y;return out.set(Math.min(ax,bx),Math.min(ay,by));}function Vec2Multiply(a,b,param){var out=param=== void 0?new Vec2():param;return out.set(a.x*b.x,a.y*b.y);}function Vec2Negate(a,param){var out=param=== void 0?new Vec2():param;return out.set(-a.x,-a.y);}function Vec2Normalize(a,param){var out=param=== void 0?new Vec2():param;return Vec2DivideScalar(a,GetVec2Length(a)||1,out);}function Vec2One(){return new Vec2(1,1);}function Vec2PerpDot(a,b){return a.x*b.y-a.y*b.x;}function Vec2Random(a,param,param1){var scale=param=== void 0?1:param,out=param1=== void 0?new Vec2():param1;var r=Math.random()*2*Math.PI;return out.set(Math.cos(r)*scale,Math.sin(r)*scale);}function Vec2Rotate(a,origin,angle,param){var out=param=== void 0?new Vec2():param;var s=Math.sin(angle);var c=Math.cos(angle);var x=a.x-origin.x;var y=a.y-origin.y;return out.set(x*c-y*s+origin.x,x*s+y*c+origin.y);}function Vec2Round(a,param){var out=param=== void 0?new Vec2():param;return out.set(Math.round(a.x),Math.round(a.y));}function Vec2RoundToZero(a,param){var out=param=== void 0?new Vec2():param;return out.set(a.x<0?Math.ceil(a.x):Math.floor(a.x),a.y<0?Math.ceil(a.y):Math.floor(a.y));}function Vec2ScaleAndAdd(a,b,scalar,param){var out=param=== void 0?new Vec2():param;return out.set(a.x+b.x*scalar,a.y+b.y*scalar);}function Vec2SetLength(a,length,param){var out=param=== void 0?new Vec2():param;Vec2Normalize(a,out);return Vec2Scale(out,length,out);}function Vec2SubtractScalar(a,scalar,param){var out=param=== void 0?new Vec2():param;return out.set(a.x-scalar,a.y-scalar);}function Vec2Transform(v,positionX,positionY,rotation,scaleX,scaleY,param){var out=param=== void 0?new Vec2():param;return Vec2FromTransform(v.x,v.y,positionX,positionY,rotation,scaleX,scaleY,out);}function Vec2TransformMat2d(v,m,param){var out=param=== void 0?new Vec2():param;var a=m.a,b=m.b,c=m.c,d=m.d,tx=m.tx,ty=m.ty;return out.set(a*v.x+c*v.y+tx,b*v.x+d*v.y+ty);}function Vec2TransformMat4(v,m,param){var out=param=== void 0?new Vec2():param;var data=m.data;return out.set(data[0]*v.x+data[4]*v.y+data[12],data[1]*v.x+data[5]*v.y+data[13]);}function Vec2Zero(){return new Vec2(0,0);}var vec4_exports={};__export(vec4_exports,{GetVec4Distance:function(){return GetVec4Distance;},GetVec4DistanceSquared:function(){return GetVec4DistanceSquared;},GetVec4Length:function(){return GetVec4Length;},GetVec4LengthSquared:function(){return GetVec4LengthSquared;},GetVec4ManhattanDistance:function(){return GetVec4ManhattanDistance;},GetVec4ManhattanLength:function(){return GetVec4ManhattanLength;},RGBACallback:function(){return RGBACallback;},Vec4:function(){return Vec4;},Vec4Abs:function(){return Vec4Abs;},Vec4Add:function(){return Vec4Add;},Vec4AddScalar:function(){return Vec4AddScalar;},Vec4Bezier:function(){return Vec4Bezier;},Vec4Callback:function(){return Vec4Callback;},Vec4CatmullRom:function(){return Vec4CatmullRom;},Vec4Ceil:function(){return Vec4Ceil;},Vec4Center:function(){return Vec4Center;},Vec4Clamp:function(){return Vec4Clamp;},Vec4ClampLength:function(){return Vec4ClampLength;},Vec4ClampScalar:function(){return Vec4ClampScalar;},Vec4Clone:function(){return Vec4Clone;},Vec4CopyFrom:function(){return Vec4CopyFrom;},Vec4Cross:function(){return Vec4Cross;},Vec4Divide:function(){return Vec4Divide;},Vec4DivideScalar:function(){return Vec4DivideScalar;},Vec4Dot:function(){return Vec4Dot;},Vec4Equals:function(){return Vec4Equals;},Vec4Floor:function(){return Vec4Floor;},Vec4Fract:function(){return Vec4Fract;},Vec4FuzzyEquals:function(){return Vec4FuzzyEquals;},Vec4Hermite:function(){return Vec4Hermite;},Vec4Lerp:function(){return Vec4Lerp;},Vec4Max:function(){return Vec4Max;},Vec4Min:function(){return Vec4Min;},Vec4Multiply:function(){return Vec4Multiply;},Vec4MultiplyByFloats:function(){return Vec4MultiplyByFloats;},Vec4Negate:function(){return Vec4Negate;},Vec4Normalize:function(){return Vec4Normalize;},Vec4One:function(){return Vec4One;},Vec4Random:function(){return Vec4Random;},Vec4Round:function(){return Vec4Round;},Vec4RoundToZero:function(){return Vec4RoundToZero;},Vec4Scale:function(){return Vec4Scale;},Vec4ScaleAndAdd:function(){return Vec4ScaleAndAdd;},Vec4SetLength:function(){return Vec4SetLength;},Vec4Subtract:function(){return Vec4Subtract;},Vec4SubtractScalar:function(){return Vec4SubtractScalar;},Vec4TransformMat4:function(){return Vec4TransformMat4;},Vec4Zero:function(){return Vec4Zero;}});function GetVec4DistanceSquared(a,b){var x=a.x-b.x;var y=a.y-b.y;var z=a.z-b.z;var w=a.w-b.w;return x*x+y*y+z*z+w*w;}function GetVec4Distance(a,b){return Math.sqrt(GetVec4DistanceSquared(a,b));}function GetVec4Length(a){var x=a.x,y=a.y,z=a.z,w=a.w;return Math.sqrt(x*x+y*y+z*z+w*w);}function GetVec4LengthSquared(a){var x=a.x,y=a.y,z=a.z,w=a.w;return x*x+y*y+z*z+w*w;}function GetVec4ManhattanDistance(a,b){return Math.abs(a.x-b.x)+Math.abs(a.y-b.y)+Math.abs(a.z-b.z)+Math.abs(a.w-b.w);}function GetVec4ManhattanLength(a){var x=a.x,y=a.y,z=a.z,w=a.w;return Math.abs(x)+Math.abs(y)+Math.abs(z)+Math.abs(w);}var Vec4Callback=function(){"use strict";function _class(onChange,param,param1,param2,param3){var x=param=== void 0?0:param,y=param1=== void 0?0:param1,z=param2=== void 0?0:param2,w=param3=== void 0?0:param3;swcHelpers.classCallCheck(this,_class);this._x=x;this._y=y;this._z=z;this._w=w;this.onChange=onChange;}swcHelpers.createClass(_class,[{key:"destroy",value:function destroy(){this.onChange=NOOP;}},{key:"set",value:function set(param,param1,param2,param3){var x=param=== void 0?0:param,y=param1=== void 0?0:param1,z=param2=== void 0?0:param2,w=param3=== void 0?0:param3;this._x=x;this._y=y;this._z=z;this._w=w;if(this.onChange){this.onChange(this);}return this;}},{key:"x",get:function get(){return this._x;},set:function set(value){var prev=this._x;this._x=value;if(prev!==value){this.onChange(this);}}},{key:"y",get:function get(){return this._y;},set:function set(value){var prev=this._y;this._y=value;if(prev!==value){this.onChange(this);}}},{key:"z",get:function get(){return this._z;},set:function set(value){var prev=this._z;this._z=value;if(prev!==value){this.onChange(this);}}},{key:"w",get:function get(){return this._w;},set:function set(value){var prev=this._w;this._w=value;if(prev!==value){this.onChange(this);}}},{key:"toArray",value:function toArray(param,param1){var dst=param=== void 0?[]:param,index=param1=== void 0?0:param1;var ref=this,x=ref.x,y=ref.y,z=ref.z,w=ref.w;dst[index]=x;dst[index+1]=y;dst[index+2]=z;dst[index+3]=w;return dst;}},{key:"fromArray",value:function fromArray(src,param){var index=param=== void 0?0:param;return this.set(src[index],src[index+1],src[index+2],src[index+3]);}},{key:"toString",value:function toString(){var ref=this,x=ref.x,y=ref.y,z=ref.z,w=ref.w;return "{ x=".concat(x,", y=").concat(y,", z=").concat(z,", w=").concat(w," }");}}]);return _class;}();var RGBACallback=function(Vec4Callback1){"use strict";swcHelpers.inherits(_class,Vec4Callback1);function _class(onChange,param,param1,param2,param3){var r=param=== void 0?0:param,g=param1=== void 0?0:param1,b=param2=== void 0?0:param2,a=param3=== void 0?1:param3;swcHelpers.classCallCheck(this,_class);return swcHelpers.possibleConstructorReturn(this,swcHelpers.getPrototypeOf(_class).call(this,onChange,r,g,b,a));}swcHelpers.createClass(_class,[{key:"r",get:function get(){return this.x;},set:function set(value){this.x=value;}},{key:"g",get:function get(){return this.y;},set:function set(value){this.y=value;}},{key:"b",get:function get(){return this.z;},set:function set(value){this.z=value;}},{key:"a",get:function get(){return this.w;},set:function set(value){this.w=value;}},{key:"toString",value:function toString(){var ref=this,x=ref.x,y=ref.y,z=ref.z,w=ref.w;return "[ r=".concat(x,", g=").concat(y,", b=").concat(z,", a=").concat(w," ]");}}]);return _class;}(Vec4Callback);var Vec4=function(){"use strict";function _class(param,param1,param2,param3){var x=param=== void 0?0:param,y=param1=== void 0?0:param1,z=param2=== void 0?0:param2,w=param3=== void 0?1:param3;swcHelpers.classCallCheck(this,_class);this.set(x,y,z,w);}swcHelpers.createClass(_class,[{key:"set",value:function set(param,param1,param2,param3){var x=param=== void 0?0:param,y=param1=== void 0?0:param1,z=param2=== void 0?0:param2,w=param3=== void 0?1:param3;this.x=x;this.y=y;this.z=z;this.w=w;return this;}},{key:"toArray",value:function toArray(param,param1){var dst=param=== void 0?[]:param,index=param1=== void 0?0:param1;var ref=this,x=ref.x,y=ref.y,z=ref.z,w=ref.w;dst[index]=x;dst[index+1]=y;dst[index+2]=z;dst[index+3]=w;return dst;}},{key:"fromArray",value:function fromArray(src,param){var index=param=== void 0?0:param;return this.set(src[index],src[index+1],src[index+2],src[index+3]);}},{key:"toString",value:function toString(){var ref=this,x=ref.x,y=ref.y,z=ref.z,w=ref.w;return "{ x=".concat(x,", y=").concat(y,", z=").concat(z,", w=").concat(w," }");}}]);return _class;}();function Vec4Abs(a,param){var out=param=== void 0?new Vec4():param;return out.set(Math.abs(a.x),Math.abs(a.y),Math.abs(a.z),Math.abs(a.w));}function Vec4Add(a,b,param){var out=param=== void 0?new Vec4():param;return out.set(a.x+b.x,a.y+b.y,a.z+b.z,a.w+b.w);}function Vec4AddScalar(a,scalar,param){var out=param=== void 0?new Vec4():param;return out.set(a.x+scalar,a.y+scalar,a.z+scalar,a.w+scalar);}function Vec4Bezier(a,b,c,d,t,param){var out=param=== void 0?new Vec4():param;return out.set(Bezier(t,a.x,b.x,c.x,d.x),Bezier(t,a.y,b.y,c.y,d.y),Bezier(t,a.z,b.z,c.z,d.z),Bezier(t,a.w,b.w,c.w,d.w));}function Vec4CatmullRom(p1,p2,p3,p4,t,param){var out=param=== void 0?new Vec4():param;return out.set(CatmullRom(t,p1.x,p2.x,p3.x,p4.x),CatmullRom(t,p1.y,p2.y,p3.y,p4.y),CatmullRom(t,p1.z,p2.z,p3.z,p4.z),CatmullRom(t,p1.w,p2.w,p3.w,p4.w));}function Vec4Ceil(a,param){var out=param=== void 0?new Vec4():param;var x=a.x,y=a.y,z=a.z,w=a.w;return out.set(Math.ceil(x),Math.ceil(y),Math.ceil(z),Math.ceil(w));}function Vec4Scale(a,scalar,param){var out=param=== void 0?new Vec4():param;var x=a.x,y=a.y,z=a.z,w=a.w;return out.set(x*scalar,y*scalar,z*scalar,w*scalar);}function Vec4Center(a,b,param){var out=param=== void 0?new Vec4():param;Vec4Add(a,b,out);return Vec4Scale(out,0.5,out);}function Vec4Clamp(a,min,max,param){var out=param=== void 0?new Vec4():param;return out.set(Clamp(a.x,min.x,max.x),Clamp(a.y,min.y,max.y),Clamp(a.z,min.z,max.z),Clamp(a.w,min.w,max.w));}function Vec4DivideScalar(a,scalar,param){var out=param=== void 0?new Vec4():param;var x=a.x,y=a.y,z=a.z,w=a.w;return out.set(x/scalar,y/scalar,z/scalar,w/scalar);}function Vec4ClampLength(a,min,max,param){var out=param=== void 0?new Vec4():param;var length=GetVec4Length(a);Vec4DivideScalar(a,length||1,out);return Vec4Scale(out,Clamp(min,max,length),out);}function Vec4ClampScalar(a,min,max,param){var out=param=== void 0?new Vec4():param;return out.set(Clamp(a.x,min,max),Clamp(a.y,min,max),Clamp(a.z,min,max),Clamp(a.w,min,max));}function Vec4Clone(source){var x=source.x,y=source.y,z=source.z,w=source.w;return new Vec4(x,y,z,w);}function Vec4CopyFrom(source,dest){var x=source.x,y=source.y,z=source.z,w=source.w;return dest.set(x,y,z,w);}function Vec4Cross(u,v,w,param){var out=param=== void 0?new Vec4():param;var ux=u.x,uy=u.y,uz=u.z,uw=u.w;var vx=v.x,vy=v.y,vz=v.z,vw=v.w;var wx=w.x,wy=w.y,wz=w.z,ww=w.w;var A=vx*wy-vy*wx;var B=vx*wz-vz*wx;var C=vx*ww-vw*wx;var D=vy*wz-vz*wy;var E=vy*ww-vw*wy;var F=vz*ww-vw*wz;var G=ux;var H=uy;var I=uz;var J=uw;return out.set(H*F-I*E+J*D,-(G*F)+I*C-J*B,G*E-H*C+J*A,-(G*D)+H*B-I*A);}function Vec4Divide(a,b,param){var out=param=== void 0?new Vec4():param;return out.set(a.x/b.x,a.y/b.y,a.z/b.z,a.w/b.w);}function Vec4Dot(a,b){return a.x*b.x+a.y*b.y+a.z*b.z+a.w*b.w;}function Vec4Equals(a,b){return a.x===b.x&&a.y===b.y&&a.z===b.z&&a.w===b.w;}function Vec4Floor(a,param){var out=param=== void 0?new Vec4():param;var x=a.x,y=a.y,z=a.z,w=a.w;return out.set(Math.floor(x),Math.floor(y),Math.floor(z),Math.floor(w));}function Vec4Fract(a,param){var out=param=== void 0?new Vec4():param;return out.set(a.x-Math.floor(a.x),a.y-Math.floor(a.y),a.z-Math.floor(a.z),a.w-Math.floor(a.w));}function Vec4FuzzyEquals(a,b,param){var epsilon=param=== void 0?0.0001:param;return FuzzyEqual(a.x,b.x,epsilon)&&FuzzyEqual(a.y,b.y,epsilon)&&FuzzyEqual(a.z,b.z,epsilon)&&FuzzyEqual(a.w,b.w,epsilon);}function Vec4Hermite(a,b,c,d,t,param){var out=param=== void 0?new Vec4():param;return out.set(Hermite(t,a.x,b.x,c.x,d.x),Hermite(t,a.y,b.y,c.y,d.y),Hermite(t,a.z,b.z,c.z,d.z),Hermite(t,a.w,b.w,c.w,d.w));}function Vec4Lerp(a,b,t,param){var out=param=== void 0?new Vec4():param;var x=a.x,y=a.y,z=a.z,w=a.w;return out.set(x+t*(b.x-x),y+t*(b.y-y),z+t*(b.z-z),w+t*(b.w-w));}function Vec4Max(a,b,param){var out=param=== void 0?new Vec4():param;var ax=a.x,ay=a.y,az=a.z,aw=a.w;var bx=b.x,by=b.y,bz=b.z,bw=b.w;return out.set(Math.max(ax,bx),Math.max(ay,by),Math.max(az,bz),Math.max(aw,bw));}function Vec4Min(a,b,param){var out=param=== void 0?new Vec4():param;var ax=a.x,ay=a.y,az=a.z,aw=a.w;var bx=b.x,by=b.y,bz=b.z,bw=b.w;return out.set(Math.min(ax,bx),Math.min(ay,by),Math.min(az,bz),Math.min(aw,bw));}function Vec4Multiply(a,b,param){var out=param=== void 0?new Vec4():param;return out.set(a.x*b.x,a.y*b.y,a.z*b.z,a.w*b.w);}function Vec4MultiplyByFloats(a,x,y,z,w,param){var out=param=== void 0?new Vec4():param;return out.set(a.x*x,a.y*y,a.z*z,a.w*w);}function Vec4Negate(a,param){var out=param=== void 0?new Vec4():param;return out.set(-a.x,-a.y,-a.z,-a.w);}function Vec4Normalize(a,param){var out=param=== void 0?new Vec4():param;return Vec4DivideScalar(a,GetVec4Length(a)||1,out);}function Vec4One(){return new Vec4(1,1,1,1);}function Vec4Random(a,param,param1){var scale=param=== void 0?1:param,out=param1=== void 0?new Vec4():param1;var v1;var v2;var v3;var v4;var s1;var s2;do{v1=Math.random()*2-1;v2=Math.random()*2-1;s1=v1*v1+v2*v2;}while(s1>=1)do{v3=Math.random()*2-1;v4=Math.random()*2-1;s2=v3*v3+v4*v4;}while(s2>=1)var d=Math.sqrt((1-s1)/s2);return out.set(scale*v1,scale*v2,scale*v3*d,scale*v4*d);}function Vec4Round(a,param){var out=param=== void 0?new Vec4():param;var x=a.x,y=a.y,z=a.z,w=a.w;return out.set(Math.round(x),Math.round(y),Math.round(z),Math.round(w));}function Vec4RoundToZero(a,param){var out=param=== void 0?new Vec4():param;var x=a.x,y=a.y,z=a.z,w=a.w;return out.set(x<0?Math.ceil(x):Math.floor(x),y<0?Math.ceil(y):Math.floor(y),z<0?Math.ceil(z):Math.floor(z),w<0?Math.ceil(w):Math.floor(w));}function Vec4ScaleAndAdd(a,b,scalar,param){var out=param=== void 0?new Vec4():param;return out.set(a.x+b.x*scalar,a.y+b.y*scalar,a.z+b.z*scalar,a.w+b.w*scalar);}function Vec4SetLength(a,length,param){var out=param=== void 0?new Vec4():param;Vec4Normalize(a,out);return Vec4Scale(out,length,out);}function Vec4Subtract(a,b,param){var out=param=== void 0?new Vec4():param;return out.set(a.x-b.x,a.y-b.y,a.z-b.z,a.w-b.w);}function Vec4SubtractScalar(a,scalar,param){var out=param=== void 0?new Vec4():param;var x=a.x,y=a.y,z=a.z,w=a.w;return out.set(x-scalar,y-scalar,z-scalar,w-scalar);}function Vec4TransformMat4(a,m,param){var out=param=== void 0?new Vec4():param;var _data=m.data,m00=_data[0],m01=_data[1],m02=_data[2],m03=_data[3],m10=_data[4],m11=_data[5],m12=_data[6],m13=_data[7],m20=_data[8],m21=_data[9],m22=_data[10],m23=_data[11],m30=_data[12],m31=_data[13],m32=_data[14],m33=_data[15];var x=a.x,y=a.y,z=a.z,w=a.w;return out.set(m00*x+m10*y+m20*z+m30*w,m01*x+m11*y+m21*z+m31*w,m02*x+m12*y+m22*z+m32*w,m03*x+m13*y+m23*z+m33*w);}function Vec4Zero(){return new Vec4(0,0,0,0);}function Average(values){var sum=0;for(var i1=0;i1<values.length;i1++){sum+=+values[i1];}return sum/values.length;}function Between(min,max){return Math.floor(Math.random()*(max-min+1)+min);}function CeilTo(value,param,param1){var place=param=== void 0?0:param,base=param1=== void 0?10:param1;var p=Math.pow(base,-place);return Math.ceil(value*p)/p;}function DegToRad(degrees){return degrees*MATH_CONST.DEG_TO_RAD;}function Difference(a,b){return Math.abs(a-b);}function FloatBetween(min,max){return Math.random()*(max-min)+min;}function FloorTo(value,param,param1){var place=param=== void 0?0:param,base=param1=== void 0?10:param1;var p=Math.pow(base,-place);return Math.floor(value*p)/p;}function FromPercent(percent,min,max){percent=Clamp(percent,0,1);return (max-min)*percent;}function GetSpeed(distance,time){return distance/time/1000;}function MaxAdd(value,amount,max){return Math.min(value+amount,max);}function MinSub(value,amount,min){return Math.max(value-amount,min);}function Percent(value,min,max,upperMax){if(max=== void 0){max=min+1;}var percentage=(value-min)/(max-min);if(percentage>1){if(upperMax!== void 0){percentage=(upperMax-value)/(upperMax-max);if(percentage<0){percentage=0;}}else{percentage=1;}}else if(percentage<0){percentage=0;}return percentage;}function RadToDeg(radians){return radians*MATH_CONST.RAD_TO_DEG;}function RoundTo(value,param,param1){var place=param=== void 0?0:param,base=param1=== void 0?10:param1;var p=Math.pow(base,-place);return Math.round(value*p)/p;}function SinCosTableGenerator(length,param,param1,param2){var sinAmp=param=== void 0?1:param,cosAmp=param1=== void 0?1:param1,frequency=param2=== void 0?1:param2;frequency*=Math.PI/length;var cos=[];var sin=[];for(var c=0;c<length;c++){cosAmp-=sinAmp*frequency;sinAmp+=cosAmp*frequency;cos[c]=cosAmp;sin[c]=sinAmp;}return {sin:sin,cos:cos,length:length};}function Within(a,b,tolerance){return Math.abs(a-b)<=tolerance;}var Camera3D=function(){"use strict";function _class(param,param1,param2,param3,param4,param5){var x=param=== void 0?0:param,y=param1=== void 0?0:param1,z=param2=== void 0?0:param2,fov=param3=== void 0?45:param3,near=param4=== void 0?0.1:param4,far=param5=== void 0?1000:param5;swcHelpers.classCallCheck(this,_class);this.dirtyRender=true;this.type="Camera3D";var game=GameInstance.get();this.renderer=game.renderer;this.position=new Vec3Callback((function(){return this.update();}).bind(this),x,y,z);this.direction=new Vec3Callback((function(){return this.update();}).bind(this),0,1,0);this._lookAtPosition=new Vec3();this._lookAtView=new Matrix4();this._axis=new Quaternion();this.up=Vec3Up();this.left=Vec3Left();this._fov=fov;this._near=near;this._far=far;this.aspectRatio=this.renderer.width/this.renderer.height;this.viewMatrix=new Matrix4();this.projectionMatrix=Mat4Perspective(DegToRad(fov),this.aspectRatio,near,far);this.lookAt(new Vec3());}swcHelpers.createClass(_class,[{key:"updateProjectionMatrix",value:function updateProjectionMatrix(){Mat4Perspective(DegToRad(this._fov),this.aspectRatio,this._near,this._far,this.projectionMatrix);return this;}},{key:"lookAt",value:function lookAt(point){var pos=this.position;var dir=this.direction;var left=this.left;Vec3Subtract(point,pos,dir);Vec3Normalize(dir,dir);Vec3CrossNormalize(UP,dir,left);Vec3CrossNormalize(dir,left,this.up);return this.update();}},{key:"rotateOnAxis",value:function rotateOnAxis(axisVec,angle){var dir=this.direction;var left=this.left;var up=this.up;var q=QuatSetAxisAngle(axisVec,angle,this._axis);Vec3TransformQuat(dir,q,dir);Vec3TransformQuat(left,q,left);Vec3TransformQuat(up,q,up);Vec3Normalize(up,up);Vec3Normalize(left,left);Vec3Normalize(dir,dir);return this.update();}},{key:"yaw",value:function yaw(angle){return this.rotateOnAxis(this.up,angle);}},{key:"pitch",value:function pitch(angle){return this.rotateOnAxis(this.left,angle);}},{key:"roll",value:function roll(angle){return this.rotateOnAxis(this.direction,angle);}},{key:"forward",value:function forward(s){var pos=this.position;var px=pos.x,py=pos.y,pz=pos.z;var _direction=this.direction,dx=_direction.x,dy=_direction.y,dz=_direction.z;pos.set(px-s*dx,py-s*dy,pz-s*dz);return this.update();}},{key:"update",value:function update(){var lookPosition=this._lookAtPosition;var lookView=this._lookAtView;var pos=this.position;Vec3Add(pos,this.direction,lookPosition);Mat4LookAt(pos,lookPosition,this.up,lookView);Mat4TranslateFromFloats(lookView,-pos.x,-pos.y,-pos.z,this.viewMatrix);return this;}},{key:"reset",value:function reset(){}},{key:"destroy",value:function destroy(){this.position.destroy();this.direction.destroy();this.up=null;this.left=null;this.viewMatrix=null;this.projectionMatrix=null;this._lookAtPosition=null;this._lookAtView=null;this._axis=null;}},{key:"fov",get:function get(){return this._fov;},set:function set(value){if(value>0&&value<180){this._fov=value;this.updateProjectionMatrix();}}},{key:"near",get:function get(){return this._near;},set:function set(value){if(value>0){this._near=value;this.updateProjectionMatrix();}}},{key:"far",get:function get(){return this._far;},set:function set(value){if(value>0){this._far=value;this.updateProjectionMatrix();}}}]);return _class;}();var color_exports={};__export(color_exports,{CloneColor:function(){return CloneColor;},Color:function(){return Color;},FromHSV:function(){return FromHSV;},GetColorFromRGB:function(){return GetColorFromRGB;},GetColorSpectrum:function(){return GetColorSpectrum;},RGBAToFloat:function(){return RGBAToFloat;},RGBToFloat:function(){return RGBToFloat;},SetGray:function(){return SetGray;},SetHSV:function(){return SetHSV;}});var Color=function(){"use strict";function _class(param,param1,param2,param3){var red=param=== void 0?0:param,green=param1=== void 0?0:param1,blue=param2=== void 0?0:param2,alpha=param3=== void 0?1:param3;swcHelpers.classCallCheck(this,_class);this.rgba=new Uint8ClampedArray([red,green,blue,alpha]);}swcHelpers.createClass(_class,[{key:"set",value:function set(red,green,blue,param){var alpha=param=== void 0?this.alpha:param;this.rgba.set([red,green,blue,alpha]);return this;}},{key:"setColor",value:function setColor(color){var rgba=this.rgba;var alpha=color>16777215?color>>>24:255;rgba.set([color>>16&255,color>>8&255,color&255,alpha]);return this;}},{key:"getColor",value:function getColor(param){var includeAlpha=param=== void 0?false:param;var _rgba=this.rgba,r=_rgba[0],g=_rgba[1],b=_rgba[2],a=_rgba[3];if(includeAlpha){return a<<24|r<<16|g<<8|b;}else{return r<<16|g<<8|b;}}},{key:"red",get:function get(){return this.rgba[0];},set:function set(value){this.rgba[0]=value;}},{key:"green",get:function get(){return this.rgba[1];},set:function set(value){this.rgba[1]=value;}},{key:"blue",get:function get(){return this.rgba[2];},set:function set(value){this.rgba[2]=value;}},{key:"alpha",get:function get(){return this.rgba[3];},set:function set(value){this.rgba[3]=value;}}]);return _class;}();function CloneColor(color){return new Color(color.red,color.green,color.blue,color.alpha);}function ConvertValue(n,h,s,v){var k=(n+h*6)%6;var min=Math.min(k,4-k,1);return Math.round(255*(v-v*s*Math.max(0,min)));}function SetHSV(color,h,param,param1){var s=param=== void 0?1:param,v=param1=== void 0?1:param1;var r=ConvertValue(5,h,s,v);var g=ConvertValue(3,h,s,v);var b=ConvertValue(1,h,s,v);return color.set(r,g,b);}function FromHSV(h,param,param1){var s=param=== void 0?1:param,v=param1=== void 0?1:param1;return SetHSV(new Color(),h,s,v);}function GetColorFromRGB(red,green,blue){return red<<16|green<<8|blue;}function GetColorSpectrum(param){var limit=param=== void 0?1024:param;var colors=[];var range=255;var i1;var r=255;var g=0;var b=0;for(i1=0;i1<=range;i1++){colors.push(GetColorFromRGB(r,i1,b));}g=255;for(i1=range;i1>=0;i1--){colors.push(GetColorFromRGB(i1,g,b));}r=0;for(i1=0;i1<=range;i1++,g--){colors.push(GetColorFromRGB(r,g,i1));}g=0;b=255;for(i1=0;i1<=range;i1++,b--,r++){colors.push(GetColorFromRGB(r,g,b));}if(limit===1024){return colors;}else{var out=[];var t=0;var inc=1024/limit;for(i1=0;i1<limit;i1++){out.push(colors[Math.floor(t)]);t+=inc;}return out;}}function RGBAToFloat(red,green,blue,alpha){return alpha<<24|red<<16|green<<8|blue;}function RGBToFloat(red,green,blue){return red<<16|green<<8|blue;}function SetGray(color,amount){return color.set(amount,amount,amount);}var config_exports={};__export(config_exports,{BackgroundColor:function(){return BackgroundColor;},Banner:function(){return Banner;},BatchSize:function(){return BatchSize;},Canvas:function(){return Canvas;},CanvasContext:function(){return CanvasContext;},DefaultOrigin:function(){return DefaultOrigin;},GlobalVar:function(){return GlobalVar;},MaxTextures:function(){return MaxTextures;},Parent:function(){return Parent;},Scenes:function(){return Scenes;},Size:function(){return Size;},WebGL:function(){return WebGL;},WebGLContext:function(){return WebGLContext;}});var CONFIG_DEFAULTS={AUTO:"Auto",BACKGROUND_COLOR:"BackgroundColor",BANNER:"Banner",BATCH_SIZE:"BatchSize",CANVAS_CONTEXT:"CanvasContext",CANVAS:"Canvas",DEFAULT_ORIGIN:"DefaultOrigin",GLOBAL_VAR:"GlobalVar",MAX_TEXTURES:"MaxTextures",PARENT:"Parent",RENDERER:"Renderer",SCENES:"Scenes",SIZE:"Size",WEBGL_CONTEXT:"WebGLContext",WEBGL:"WebGL"};var ConfigStore=new Map();function SetBackgroundColor(color){ConfigStore.set(CONFIG_DEFAULTS.BACKGROUND_COLOR,color);}function BackgroundColor(color){return function(){SetBackgroundColor(color);};}function SetBanner(param,param1,param2,param3,param4){var title=param=== void 0?"":param,version=param1=== void 0?"":param1,url=param2=== void 0?"":param2,color=param3=== void 0?"#fff":param3,background=param4=== void 0?"linear-gradient(#3e0081 40%, #00bcc3)":param4;ConfigStore.set(CONFIG_DEFAULTS.BANNER,{title:title,version:version,url:url,color:color,background:background});}function Banner(title,version,url,color,background){return function(){SetBanner(title,version,url,color,background);};}function SetBatchSize(size){ConfigStore.set(CONFIG_DEFAULTS.BATCH_SIZE,size);}function BatchSize(size){return function(){SetBatchSize(size);};}function GetHeight(){return ConfigStore.get(CONFIG_DEFAULTS.SIZE).height;}function GetResolution(){return ConfigStore.get(CONFIG_DEFAULTS.SIZE).resolution;}function GetWidth(){return ConfigStore.get(CONFIG_DEFAULTS.SIZE).width;}function SetSize(param,param1,param2){var width=param=== void 0?800:param,height=param1=== void 0?600:param1,resolution=param2=== void 0?1:param2;if(resolution===0){resolution=window.devicePixelRatio;}ConfigStore.set(CONFIG_DEFAULTS.SIZE,{width:width,height:height,resolution:resolution});}function Size(param,param1,param2){var width=param=== void 0?800:param,height=param1=== void 0?600:param1,resolution=param2=== void 0?1:param2;return function(){SetSize(width,height,resolution);};}var queue=[];var BindingQueue={add:function(texture,glConfig){queue.push({texture:texture,glConfig:glConfig});},get:function(){return queue;},clear:function(){queue.length=0;}};function GetBackgroundColor(){return ConfigStore.get(CONFIG_DEFAULTS.BACKGROUND_COLOR);}function GetCanvasContext(){return ConfigStore.get(CONFIG_DEFAULTS.CANVAS_CONTEXT);}var CanvasRenderer=function(){"use strict";function _class(){swcHelpers.classCallCheck(this,_class);this.clearBeforeRender=true;this.optimizeRedraw=true;this.autoResize=true;this.width=GetWidth();this.height=GetHeight();this.resolution=GetResolution();this.setBackgroundColor(GetBackgroundColor());var canvas=document.createElement("canvas");this.canvas=canvas;this.initContext();}swcHelpers.createClass(_class,[{key:"initContext",value:function initContext(){var ctx=this.canvas.getContext("2d",GetCanvasContext());this.ctx=ctx;this.resize(this.width,this.height,this.resolution);}},{key:"resize",value:function resize(width,height,param){var resolution=param=== void 0?1:param;this.width=width*resolution;this.height=height*resolution;this.resolution=resolution;var canvas=this.canvas;canvas.width=this.width;canvas.height=this.height;if(this.autoResize){canvas.style.width=(this.width/resolution).toString()+"px";canvas.style.height=(this.height/resolution).toString()+"px";}}},{key:"setBackgroundColor",value:function setBackgroundColor(color){var r=color>>16&255;var g=color>>8&255;var b=color&255;var a=color>16777215?color>>>24:255;this.clearColor="rgba(".concat(r,", ").concat(g,", ").concat(b,", ").concat(a,")");return this;}},{key:"reset",value:function reset(){var ctx=this.ctx;ctx.globalAlpha=1;ctx.globalCompositeOperation="source-over";ctx.setTransform(1,0,0,1,0,0);}},{key:"render",value:function render(renderData){BindingQueue.clear();var ctx=this.ctx;if(this.optimizeRedraw&&renderData.numDirtyFrames===0&&renderData.numDirtyCameras===0){return;}this.reset();if(this.clearBeforeRender){ctx.clearRect(0,0,this.width,this.height);ctx.fillStyle=this.clearColor;ctx.fillRect(0,0,this.width,this.height);}}},{key:"destroy",value:function destroy(){}}]);return _class;}();function SetRenderer(renderer){ConfigStore.set(CONFIG_DEFAULTS.RENDERER,renderer);}function Canvas(){return function(){SetRenderer(CanvasRenderer);};}function SetCanvasContext(contextAttributes){ConfigStore.set(CONFIG_DEFAULTS.CANVAS_CONTEXT,contextAttributes);}function CanvasContext(contextAttributes){return function(){SetCanvasContext(contextAttributes);};}function SetDefaultOrigin(param,param1){var x=param=== void 0?0.5:param,y=param1=== void 0?x:param1;ConfigStore.set(CONFIG_DEFAULTS.DEFAULT_ORIGIN,{x:x,y:y});}function DefaultOrigin(param,param1){var x=param=== void 0?0.5:param,y=param1=== void 0?x:param1;return function(){SetDefaultOrigin(x,y);};}function SetGlobalVar(name){ConfigStore.set(CONFIG_DEFAULTS.GLOBAL_VAR,name);}function GlobalVar(name){return function(){SetGlobalVar(name);};}function SetMaxTextures(max){ConfigStore.set(CONFIG_DEFAULTS.MAX_TEXTURES,max);}function MaxTextures(param){var max=param=== void 0?0:param;return function(){SetMaxTextures(max);};}function GetElement(target){var element;if(target){if(typeof target==="string"){element=document.getElementById(target);}else if(typeof target==="object"&&target.nodeType===1){element=target;}}if(!element){element=document.body;}return element;}function SetParent(parentElement){if(parentElement){ConfigStore.set(CONFIG_DEFAULTS.PARENT,GetElement(parentElement));}}function Parent(parentElement){return function(){SetParent(parentElement);};}function SetScenes(scenes){ConfigStore.set(CONFIG_DEFAULTS.SCENES,[].concat(scenes));}function Scenes(scenes){return function(){SetScenes(scenes);};}function AddViewport(renderPass,param,param1,param2,param3){var x=param=== void 0?0:param,y=param1=== void 0?0:param1,width=param2=== void 0?0:param2,height=param3=== void 0?0:param3;var viewport=new Rectangle(x,y,width,height);renderPass.viewportStack.push(viewport);return viewport;}var gl;var GL={get:function(){return gl;},set:function(context){gl=context;}};function BindViewport(renderPass,viewport){if(!viewport){viewport=renderPass.currentViewport;if(!viewport){return;}}var glv=gl.getParameter(gl.VIEWPORT);if(glv[0]!==viewport.x||glv[1]!==viewport.y||glv[2]!==viewport.width||glv[3]!==viewport.height){gl.viewport(viewport.x,viewport.y,viewport.width,viewport.height);}}function SetViewport(renderPass,param,param1,param2,param3){var x=param=== void 0?0:param,y=param1=== void 0?0:param1,width=param2=== void 0?0:param2,height=param3=== void 0?0:param3;var entry=AddViewport(renderPass,x,y,width,height);BindViewport(renderPass,entry);renderPass.currentViewport=entry;}function BindFramebuffer(renderPass,param,entry){var clear=param=== void 0?true:param;if(!entry){entry=renderPass.currentFramebuffer;}var framebuffer=entry.framebuffer,viewport=entry.viewport;gl.bindFramebuffer(gl.FRAMEBUFFER,framebuffer);if(clear){gl.clearColor(0,0,0,0);gl.clear(gl.COLOR_BUFFER_BIT|gl.DEPTH_BUFFER_BIT);}if(viewport){SetViewport(renderPass,viewport.x,viewport.y,viewport.width,viewport.height);}}function PopViewport(renderPass){var stack=renderPass.viewportStack;if(stack.length>1){stack.pop();}renderPass.currentViewport=stack[stack.length-1];BindViewport(renderPass);}function PopFramebuffer(renderPass){var stack=renderPass.framebufferStack;if(stack.length>1){if(renderPass.currentFramebuffer.viewport){PopViewport(renderPass);}stack.pop();}renderPass.currentFramebuffer=stack[stack.length-1];BindFramebuffer(renderPass,false);}function AddFramebuffer(renderPass,framebuffer,viewport){var entry={framebuffer:framebuffer,viewport:viewport};renderPass.framebufferStack.push(entry);return entry;}function SetFramebuffer(renderPass,framebuffer,param,viewport){var clear=param=== void 0?true:param;var entry=AddFramebuffer(renderPass,framebuffer,viewport);BindFramebuffer(renderPass,clear,entry);renderPass.currentFramebuffer=entry;}function Draw(renderPass){var count=renderPass.count;if(count===0){return;}var currentBuffer=renderPass.currentVertexBuffer;var currentShader=renderPass.currentShader;var renderToFramebuffer=currentShader.shader.renderToFramebuffer;if(renderToFramebuffer){SetFramebuffer(renderPass,currentShader.shader.framebuffer,true);}if(count===currentBuffer.batchSize){var type=currentBuffer.isDynamic?gl.DYNAMIC_DRAW:gl.STATIC_DRAW;gl.bufferData(gl.ARRAY_BUFFER,currentBuffer.data,type);}else{var subsize=currentBuffer.indexed?count*currentBuffer.entryElementSize:count*currentBuffer.vertexElementSize;var view=currentBuffer.vertexViewF32.subarray(0,subsize);gl.bufferSubData(gl.ARRAY_BUFFER,0,view);}if(currentBuffer.indexed){gl.drawElements(gl.TRIANGLES,count*currentBuffer.entryIndexSize,gl.UNSIGNED_SHORT,0);}else{gl.drawArrays(gl.TRIANGLES,0,count);}if(renderToFramebuffer){PopFramebuffer(renderPass);}}function Flush(renderPass,forceCount){if(forceCount){renderPass.count=forceCount;}var count=renderPass.count;if(count===0){return false;}Draw(renderPass);renderPass.prevCount=count;renderPass.count=0;renderPass.flushTotal++;return true;}function End(renderPass){Flush(renderPass);}function GetRGBArray(color,param){var output=param=== void 0?[]:param;var r=color>>16&255;var g=color>>8&255;var b=color&255;var a=color>16777215?color>>>24:255;output[0]=r/255;output[1]=g/255;output[2]=b/255;output[3]=a/255;return output;}function GetWebGLContext(){return ConfigStore.get(CONFIG_DEFAULTS.WEBGL_CONTEXT);}function CreateGLTexture(binding){var parent=binding.parent,flipY=binding.flipY,unpackPremultiplyAlpha=binding.unpackPremultiplyAlpha,minFilter=binding.minFilter,magFilter=binding.magFilter,wrapS=binding.wrapS,wrapT=binding.wrapT,generateMipmap=binding.generateMipmap,isPOT=binding.isPOT;var source=parent.image;var width=parent.width;var height=parent.height;var glTexture=gl.createTexture();gl.activeTexture(gl.TEXTURE0);gl.bindTexture(gl.TEXTURE_2D,glTexture);gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL,flipY);gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,unpackPremultiplyAlpha);if(source){gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,gl.RGBA,gl.UNSIGNED_BYTE,source);width=source.width;height=source.height;}else{gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,width,height,0,gl.RGBA,gl.UNSIGNED_BYTE,null);}gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,minFilter);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MAG_FILTER,magFilter);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_S,wrapS);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_T,wrapT);if(generateMipmap&&isPOT){gl.generateMipmap(gl.TEXTURE_2D);}binding.texture=glTexture;return glTexture;}function DeleteFramebuffer(framebuffer){if(gl&&gl.isFramebuffer(framebuffer)){gl.deleteFramebuffer(framebuffer);}}function DeleteGLTexture(texture){if(gl.isTexture(texture)){gl.deleteTexture(texture);}}function SetGLTextureFilterMode(texture,param){var linear=param=== void 0?true:param;gl.activeTexture(gl.TEXTURE0);gl.bindTexture(gl.TEXTURE_2D,texture);var mode=linear?gl.LINEAR:gl.NEAREST;gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,mode);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MAG_FILTER,mode);}function UpdateGLTexture(binding){var source=binding.parent.image;var width=source.width;var height=source.height;if(width>0&&height>0){gl.activeTexture(gl.TEXTURE0);gl.bindTexture(gl.TEXTURE_2D,binding.texture);gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL,binding.flipY);gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,gl.RGBA,gl.UNSIGNED_BYTE,source);}return binding.texture;}var GLTextureBinding=function(){"use strict";function _class(parent,param){var config=param=== void 0?{}:param;swcHelpers.classCallCheck(this,_class);this.index=0;this.indexCounter=-1;this.dirtyIndex=true;this.unpackPremultiplyAlpha=true;this.flipY=false;this.isPOT=false;this.generateMipmap=false;this.parent=parent;this.isPOT=IsSizePowerOfTwo(parent.width,parent.height);var _texture=config.texture,texture=_texture=== void 0?null:_texture,_framebuffer=config.framebuffer,framebuffer=_framebuffer=== void 0?null:_framebuffer,_depthbuffer=config.depthbuffer,depthbuffer=_depthbuffer=== void 0?null:_depthbuffer,_unpackPremultiplyAlpha=config.unpackPremultiplyAlpha,unpackPremultiplyAlpha=_unpackPremultiplyAlpha=== void 0?true:_unpackPremultiplyAlpha,_minFilter=config.minFilter,minFilter=_minFilter=== void 0?this.isPOT?gl.LINEAR_MIPMAP_LINEAR:gl.LINEAR:_minFilter,_magFilter=config.magFilter,magFilter=_magFilter=== void 0?gl.LINEAR:_magFilter,_wrapS=config.wrapS,wrapS=_wrapS=== void 0?gl.CLAMP_TO_EDGE:_wrapS,_wrapT=config.wrapT,wrapT=_wrapT=== void 0?gl.CLAMP_TO_EDGE:_wrapT,_generateMipmap=config.generateMipmap,generateMipmap=_generateMipmap=== void 0?this.isPOT:_generateMipmap,_flipY=config.flipY,flipY=_flipY=== void 0?false:_flipY;this.minFilter=minFilter;this.magFilter=magFilter;this.wrapS=wrapS;this.wrapT=wrapT;this.generateMipmap=generateMipmap;this.flipY=flipY;this.unpackPremultiplyAlpha=unpackPremultiplyAlpha;if(framebuffer){this.framebuffer=framebuffer;}if(depthbuffer){this.depthbuffer=depthbuffer;}if(texture){this.texture=texture;}else{CreateGLTexture(this);}}swcHelpers.createClass(_class,[{key:"setFilter",value:function setFilter(linear){if(this.texture){SetGLTextureFilterMode(this.texture,linear);}}},{key:"create",value:function create(){var texture=this.texture;if(texture){DeleteGLTexture(texture);}return CreateGLTexture(this);}},{key:"update",value:function update(){var texture=this.texture;if(!texture){return CreateGLTexture(this);}else{return UpdateGLTexture(this);}}},{key:"setIndex",value:function setIndex(index){this.dirtyIndex=index!==this.index;this.index=index;}},{key:"destroy",value:function destroy(){DeleteGLTexture(this.texture);DeleteFramebuffer(this.framebuffer);this.parent=null;this.texture=null;this.framebuffer=null;}}]);return _class;}();function ProcessBindingQueue(){var queue2=BindingQueue.get();queue2.forEach(function(entry){var texture=entry.texture,glConfig=entry.glConfig;if(!texture.binding){texture.binding=new GLTextureBinding(texture,glConfig);}});BindingQueue.clear();}function GetMaxTextures(){return ConfigStore.get(CONFIG_DEFAULTS.MAX_TEXTURES);}var fragTemplate=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join("\n");function GenerateSrc(maxIfs){var src="";for(var i1=0;i1<maxIfs;++i1){if(i1>0){src+="\nelse ";}if(i1<maxIfs-1){src+="if(test == ".concat(i1,".0){}");}}return src;}function CheckShaderMaxIfStatements(maxIfs){var shader=gl.createShader(gl.FRAGMENT_SHADER);while(true){var fragmentSrc=fragTemplate.replace(/%forloop%/gi,GenerateSrc(maxIfs));gl.shaderSource(shader,fragmentSrc);gl.compileShader(shader);if(!gl.getShaderParameter(shader,gl.COMPILE_STATUS)){maxIfs=maxIfs/2|0;}else{break;}}return maxIfs;}function CreateTempTextures(renderPass){var maxGPUTextures=CheckShaderMaxIfStatements(gl.getParameter(gl.MAX_TEXTURE_IMAGE_UNITS));var maxConfigTextures=GetMaxTextures();if(maxConfigTextures===0||maxConfigTextures>0&&maxConfigTextures>maxGPUTextures){SetMaxTextures(maxGPUTextures);}else if(maxConfigTextures>0&&maxConfigTextures<maxGPUTextures){maxGPUTextures=Math.max(8,maxConfigTextures);}var tempTextures=renderPass.tempTextures;if(tempTextures.length){tempTextures.forEach(function(texture){gl.deleteTexture(texture);});}var index=[];for(var texturesIndex=0;texturesIndex<maxGPUTextures;texturesIndex++){var tempTexture=gl.createTexture();gl.activeTexture(gl.TEXTURE0+texturesIndex);gl.bindTexture(gl.TEXTURE_2D,tempTexture);gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,1,1,0,gl.RGBA,gl.UNSIGNED_BYTE,new Uint8Array([0,0,255,255]));tempTextures[texturesIndex]=tempTexture;index.push(texturesIndex);}renderPass.maxTextures=maxGPUTextures;renderPass.textureIndex=index;renderPass.currentActiveTexture=1;}function GetBatchSize(){return ConfigStore.get(CONFIG_DEFAULTS.BATCH_SIZE);}function DeleteGLBuffer(buffer){if(gl.isBuffer(buffer)){gl.deleteBuffer(buffer);}}var VertexBuffer=function(){"use strict";function _class(param){var config=param=== void 0?{}:param;swcHelpers.classCallCheck(this,_class);this.indexed=false;this.isDynamic=false;this.count=0;this.offset=0;var _batchSize=config.batchSize,batchSize=_batchSize=== void 0?1:_batchSize,_dataSize=config.dataSize,dataSize=_dataSize=== void 0?4:_dataSize,_isDynamic=config.isDynamic,isDynamic=_isDynamic=== void 0?true:_isDynamic,_elementsPerEntry=config.elementsPerEntry,elementsPerEntry=_elementsPerEntry=== void 0?4:_elementsPerEntry,_vertexElementSize=config.vertexElementSize,vertexElementSize=_vertexElementSize=== void 0?6:_vertexElementSize;this.batchSize=batchSize;this.dataSize=dataSize;this.vertexElementSize=vertexElementSize;this.isDynamic=isDynamic;this.elementsPerEntry=elementsPerEntry;this.vertexByteSize=vertexElementSize*dataSize;this.entryByteSize=this.vertexByteSize*elementsPerEntry;this.bufferByteSize=batchSize*this.entryByteSize;this.create();}swcHelpers.createClass(_class,[{key:"resize",value:function resize(batchSize){this.batchSize=batchSize;this.bufferByteSize=batchSize*this.entryByteSize;if(this.vertexBuffer){DeleteGLBuffer(this.vertexBuffer);}this.create();}},{key:"create",value:function create(){var data=new ArrayBuffer(this.bufferByteSize);this.data=data;this.vertexViewF32=new Float32Array(data);this.vertexViewU32=new Uint32Array(data);this.vertexBuffer=gl.createBuffer();gl.bindBuffer(gl.ARRAY_BUFFER,this.vertexBuffer);var type=this.isDynamic?gl.DYNAMIC_DRAW:gl.STATIC_DRAW;gl.bufferData(gl.ARRAY_BUFFER,data,type);gl.bindBuffer(gl.ARRAY_BUFFER,null);}},{key:"add",value:function add(count){this.count+=count;this.offset+=this.vertexElementSize*count;}},{key:"reset",value:function reset(){this.count=0;this.offset=0;}},{key:"canContain",value:function canContain(count){return this.count+count<=this.batchSize;}},{key:"free",value:function free(){return Math.max(0,1-this.count/this.batchSize);}},{key:"bind",value:function bind(){gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,null);gl.bindBuffer(gl.ARRAY_BUFFER,this.vertexBuffer);}},{key:"destroy",value:function destroy(){DeleteGLBuffer(this.vertexBuffer);this.data=null;this.vertexViewF32=null;this.vertexViewU32=null;this.vertexBuffer=null;}}]);return _class;}();var IndexedVertexBuffer=function(VertexBuffer1){"use strict";swcHelpers.inherits(_class,VertexBuffer1);function _class(param){var config=param=== void 0?{}:param;swcHelpers.classCallCheck(this,_class);var _this;_this=swcHelpers.possibleConstructorReturn(this,swcHelpers.getPrototypeOf(_class).call(this,config));var _indexSize=config.indexSize,indexSize=_indexSize=== void 0?4:_indexSize,_entryIndexSize=config.entryIndexSize,entryIndexSize=_entryIndexSize=== void 0?6:_entryIndexSize,_indexLayout=config.indexLayout,indexLayout=_indexLayout=== void 0?null:_indexLayout;_this.indexed=true;_this.indexSize=indexSize;_this.entryIndexSize=entryIndexSize;_this.entryElementSize=_this.vertexElementSize*_this.elementsPerEntry;var seededIndexBuffer=[];if(indexLayout){_this.indexLayout=indexLayout;for(var i1=0;i1<_this.batchSize*indexSize;i1+=indexSize){for(var c=0;c<indexLayout.length;c++){seededIndexBuffer.push(i1+indexLayout[c]);}}}_this.create();_this.createIndexBuffer(seededIndexBuffer);return _this;}swcHelpers.createClass(_class,[{key:"createIndexBuffer",value:function createIndexBuffer(seededIndex){this.index=new Uint16Array(seededIndex);this.indexBuffer=gl.createBuffer();gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,this.indexBuffer);gl.bufferData(gl.ELEMENT_ARRAY_BUFFER,this.index,gl.STATIC_DRAW);gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,null);seededIndex=[];}},{key:"bind",value:function bind(){gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,this.indexBuffer);gl.bindBuffer(gl.ARRAY_BUFFER,this.vertexBuffer);}},{key:"destroy",value:function destroy(){swcHelpers.get(swcHelpers.getPrototypeOf(_class.prototype),"destroy",this).call(this);DeleteGLBuffer(this.indexBuffer);this.index=null;this.indexLayout=null;this.indexBuffer=null;}}]);return _class;}(VertexBuffer);function CreateAttributes(program,config){var attributes=new Map();var defaultSettings={size:1,type:gl.FLOAT,normalized:false,stride:0,offset:0};var total=gl.getProgramParameter(program,gl.ACTIVE_ATTRIBUTES);for(var i2=0;i2<total;i2++){var attrib=gl.getActiveAttrib(program,i2);if(!attrib){break;}var name=attrib.name;var index=gl.getAttribLocation(program,name);gl.enableVertexAttribArray(index);var setting=config.hasOwnProperty(name)?config[name]:{};var _size=setting.size,size=_size=== void 0?defaultSettings.size:_size,_type=setting.type,type=_type=== void 0?defaultSettings.type:_type,_normalized=setting.normalized,normalized=_normalized=== void 0?defaultSettings.normalized:_normalized,_stride=setting.stride,stride=_stride=== void 0?defaultSettings.stride:_stride,_offset=setting.offset,offset=_offset=== void 0?defaultSettings.offset:_offset;attributes.set(name,{index:index,size:size,type:type,normalized:normalized,stride:stride,offset:offset});}return attributes;}function DeleteShaders(){for(var _len=arguments.length,shaders=new Array(_len),_key=0;_key<_len;_key++){shaders[_key]=arguments[_key];}shaders.forEach(function(shader){gl.deleteShader(shader);});}function CreateProgram(){for(var _len=arguments.length,shaders=new Array(_len),_key=0;_key<_len;_key++){shaders[_key]=arguments[_key];}var program=gl.createProgram();shaders.forEach(function(shader){gl.attachShader(program,shader);});gl.linkProgram(program);var status=gl.getProgramParameter(program,gl.LINK_STATUS);if(!status){var info=gl.getProgramInfoLog(program);console.error("Error linking program: ".concat(info));gl.deleteProgram(program);DeleteShaders.apply(void 0,shaders);return null;}return program;}function CreateShader(source,type){var shader=gl.createShader(type);gl.shaderSource(shader,source);gl.compileShader(shader);var status=gl.getShaderParameter(shader,gl.COMPILE_STATUS);if(!status){var info=gl.getShaderInfoLog(shader);var sourceLines=source.split("\n").map(function(line,index){return "".concat(index,": ").concat(line);});console.error("Error compiling shader: ".concat(info),sourceLines.join("\n"));gl.deleteShader(shader);return null;}return shader;}function CreateUniformSetter(uniform,location,param){var isArray=param=== void 0?false:param;switch(uniform.type){case gl.INT:case gl.BOOL:{if(isArray){return function(v){gl.uniform1iv(location,v);};}else{return function(v){gl.uniform1i(location,v);};}}case gl.INT_VEC2:case gl.BOOL_VEC2:{return function(v){gl.uniform2iv(location,v);};}case gl.INT_VEC3:case gl.BOOL_VEC3:{return function(v){gl.uniform3iv(location,v);};}case gl.INT_VEC4:case gl.BOOL_VEC4:{return function(v){gl.uniform4iv(location,v);};}case gl.FLOAT:{if(isArray){return function(v){gl.uniform1fv(location,v);};}else{return function(v){gl.uniform1f(location,v);};}}case gl.FLOAT_VEC2:{return function(v){gl.uniform2fv(location,v);};}case gl.FLOAT_VEC3:{return function(v){gl.uniform3fv(location,v);};}case gl.FLOAT_VEC4:{return function(v){gl.uniform4fv(location,v);};}case gl.FLOAT_MAT2:{return function(v){gl.uniformMatrix2fv(location,false,v);};}case gl.FLOAT_MAT3:{return function(v){gl.uniformMatrix3fv(location,false,v);};}case gl.FLOAT_MAT4:{return function(v){gl.uniformMatrix4fv(location,false,v);};}case gl.SAMPLER_2D:case gl.SAMPLER_CUBE:{if(uniform.size>1){return function(v){gl.uniform1iv(location,v);};}else{return function(v){gl.uniform1i(location,v);};}}}}function CreateUniforms(program){var uniforms=new Map();var total=gl.getProgramParameter(program,gl.ACTIVE_UNIFORMS);for(var i2=0;i2<total;i2++){var uniform=gl.getActiveUniform(program,i2);var name=uniform.name;if(name.startsWith("gl_")||name.startsWith("webgl_")){continue;}var location=gl.getUniformLocation(program,uniform.name);if(location){var isArray=false;if(name.substr(-3)==="[0]"){name=name.substr(0,name.length-3);isArray=uniform.size>1;}uniforms.set(name,CreateUniformSetter(uniform,location,isArray));}}return uniforms;}var UNSIGNED_BYTE=5121;var FLOAT=5126;var DefaultQuadAttributes={aVertexPosition:{size:2,type:FLOAT,normalized:false,offset:0},aTextureCoord:{size:2,type:FLOAT,normalized:false,offset:8},aTextureId:{size:1,type:FLOAT,normalized:false,offset:16},aTintColor:{size:4,type:UNSIGNED_BYTE,normalized:true,offset:20}};var DefaultQuadUniforms={uProjectionMatrix:new Float32Array(),uCameraMatrix:new Float32Array(),uTexture:0};function CreateDepthBuffer(framebuffer,textureWidth,textureHeight){gl.bindFramebuffer(gl.FRAMEBUFFER,framebuffer);var depthBuffer=gl.createRenderbuffer();gl.bindRenderbuffer(gl.RENDERBUFFER,depthBuffer);gl.renderbufferStorage(gl.RENDERBUFFER,gl.DEPTH_COMPONENT16,textureWidth,textureHeight);gl.framebufferRenderbuffer(gl.FRAMEBUFFER,gl.DEPTH_ATTACHMENT,gl.RENDERBUFFER,depthBuffer);gl.bindFramebuffer(gl.FRAMEBUFFER,null);return depthBuffer;}function CreateFramebuffer(texture,attachment){if(!attachment){attachment=gl.COLOR_ATTACHMENT0;}var framebuffer=gl.createFramebuffer();gl.bindFramebuffer(gl.FRAMEBUFFER,framebuffer);gl.framebufferTexture2D(gl.FRAMEBUFFER,attachment,gl.TEXTURE_2D,texture,0);gl.bindFramebuffer(gl.FRAMEBUFFER,null);return framebuffer;}var SINGLE_QUAD_FRAG="#define SHADER_NAME SINGLE_QUAD_FRAG\n\nprecision highp float;\n\nvarying vec2 vTextureCoord;\nvarying float vTextureId;\nvarying vec4 vTintColor;\n\nuniform sampler2D uTexture;\n\nvoid main (void)\n{\n    vec4 color = texture2D(uTexture, vTextureCoord);\n\n    gl_FragColor = color * vec4(vTintColor.bgr * vTintColor.a, vTintColor.a);\n}";var SINGLE_QUAD_VERT="#define SHADER_NAME SINGLE_QUAD_VERT\n\nprecision highp float;\n\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute float aTextureId;\nattribute vec4 aTintColor;\n\nuniform mat4 uProjectionMatrix;\nuniform mat4 uCameraMatrix;\n\nvarying vec2 vTextureCoord;\nvarying float vTextureId;\nvarying vec4 vTintColor;\n\nvoid main (void)\n{\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vTintColor = aTintColor;\n\n    gl_Position = uProjectionMatrix * uCameraMatrix * vec4(aVertexPosition, 0.0, 1.0);\n}";var Frame=function(){"use strict";function _class(texture,key,x,y,width,height){swcHelpers.classCallCheck(this,_class);this.trimmed=false;this.texture=texture;this.key=key;this.x=x;this.y=y;this.width=width;this.height=height;this.sourceSizeWidth=width;this.sourceSizeHeight=height;this.updateUVs();}swcHelpers.createClass(_class,[{key:"setPivot",value:function setPivot(x,y){this.pivot={x:x,y:y};}},{key:"setSize",value:function setSize(width,height){this.width=width;this.height=height;this.sourceSizeWidth=width;this.sourceSizeHeight=height;this.updateUVs();}},{key:"setSourceSize",value:function setSourceSize(width,height){this.sourceSizeWidth=width;this.sourceSizeHeight=height;}},{key:"setTrim",value:function setTrim(width,height,x,y,w,h){this.trimmed=true;this.sourceSizeWidth=width;this.sourceSizeHeight=height;this.spriteSourceSizeX=x;this.spriteSourceSizeY=y;this.spriteSourceSizeWidth=w;this.spriteSourceSizeHeight=h;}},{key:"getExtent",value:function getExtent(originX,originY){var sourceSizeWidth=this.sourceSizeWidth;var sourceSizeHeight=this.sourceSizeHeight;var left;var right;var top;var bottom;if(this.trimmed){left=this.spriteSourceSizeX-originX*sourceSizeWidth;right=left+this.spriteSourceSizeWidth;top=this.spriteSourceSizeY-originY*sourceSizeHeight;bottom=top+this.spriteSourceSizeHeight;}else{left=-originX*sourceSizeWidth;right=left+sourceSizeWidth;top=-originY*sourceSizeHeight;bottom=top+sourceSizeHeight;}return {left:left,right:right,top:top,bottom:bottom};}},{key:"copyToExtent",value:function copyToExtent(child){var transform=child.transform;var originX=transform.origin.x;var originY=transform.origin.y;var sourceSizeWidth=this.sourceSizeWidth;var sourceSizeHeight=this.sourceSizeHeight;var x;var y;var width;var height;if(this.trimmed){x=this.spriteSourceSizeX-originX*sourceSizeWidth;y=this.spriteSourceSizeY-originY*sourceSizeHeight;width=this.spriteSourceSizeWidth;height=this.spriteSourceSizeHeight;}else{x=-originX*sourceSizeWidth;y=-originY*sourceSizeHeight;width=sourceSizeWidth;height=sourceSizeHeight;}transform.setExtent(x,y,width,height);return this;}},{key:"copyToVertices",value:function copyToVertices(vertices,param){var offset=param=== void 0?0:param;var ref=this,u0=ref.u0,u1=ref.u1,v0=ref.v0,v1=ref.v1;vertices[offset+0].setUV(u0,v0);vertices[offset+1].setUV(u0,v1);vertices[offset+2].setUV(u1,v1);vertices[offset+3].setUV(u1,v0);return this;}},{key:"updateUVs",value:function updateUVs(){var ref=this,x=ref.x,y=ref.y,width=ref.width,height=ref.height;var baseTextureWidth=this.texture.width;var baseTextureHeight=this.texture.height;this.u0=x/baseTextureWidth;this.v0=y/baseTextureHeight;this.u1=(x+width)/baseTextureWidth;this.v1=(y+height)/baseTextureHeight;}}]);return _class;}();var Texture=function(){"use strict";function _class(image,width,height,glConfig){swcHelpers.classCallCheck(this,_class);this.key="";if(image){width=image.width;height=image.height;}this.image=image;this.width=width;this.height=height;this.frames=new Map();this.data={};this.addFrame("__BASE",0,0,width,height);BindingQueue.add(this,glConfig);}swcHelpers.createClass(_class,[{key:"addFrame",value:function addFrame(key,x,y,width,height){if(this.frames.has(key)){return null;}var frame2=new Frame(this,key,x,y,width,height);this.frames.set(key,frame2);if(!this.firstFrame||this.firstFrame.key==="__BASE"){this.firstFrame=frame2;}return frame2;}},{key:"getFrame",value:function getFrame(key){if(!key){return this.firstFrame;}if(swcHelpers._instanceof(key,Frame)){key=key.key;}var frame2=this.frames.get(key);if(!frame2){console.warn("Frame missing: ".concat(key));frame2=this.firstFrame;}return frame2;}},{key:"setSize",value:function setSize(width,height){this.width=width;this.height=height;var frame2=this.frames.get("__BASE");frame2.setSize(width,height);}},{key:"destroy",value:function destroy(){if(this.binding){this.binding.destroy();}this.frames.clear();this.data=null;this.image=null;this.firstFrame=null;}}]);return _class;}();var Shader=function(){"use strict";function _class(config){swcHelpers.classCallCheck(this,_class);this.renderToFramebuffer=false;this.renderToDepthbuffer=false;if(config){this.fromConfig(config);}}swcHelpers.createClass(_class,[{key:"fromConfig",value:function fromConfig(config){var _attributes=config.attributes,attributes=_attributes=== void 0?DefaultQuadAttributes:_attributes,_fragmentShader=config.fragmentShader,fragmentShader=_fragmentShader=== void 0?SINGLE_QUAD_FRAG:_fragmentShader,_height=config.height,height=_height=== void 0?GetHeight():_height,_renderToFramebuffer=config.renderToFramebuffer,renderToFramebuffer=_renderToFramebuffer=== void 0?false:_renderToFramebuffer,_renderToDepthbuffer=config.renderToDepthbuffer,renderToDepthbuffer=_renderToDepthbuffer=== void 0?false:_renderToDepthbuffer,_resolution=config.resolution,resolution=_resolution=== void 0?GetResolution():_resolution,_vertexShader=config.vertexShader,vertexShader=_vertexShader=== void 0?SINGLE_QUAD_VERT:_vertexShader,_width=config.width,width=_width=== void 0?GetWidth():_width,_uniforms=config.uniforms,uniforms=_uniforms=== void 0?DefaultQuadUniforms:_uniforms;this.create(fragmentShader,vertexShader,uniforms,attributes);if(renderToFramebuffer){this.renderToFramebuffer=true;var texture=new Texture(null,width*resolution,height*resolution);var binding=new GLTextureBinding(texture);texture.binding=binding;binding.framebuffer=CreateFramebuffer(binding.texture);if(renderToDepthbuffer){this.renderToDepthbuffer=true;binding.depthbuffer=CreateDepthBuffer(binding.framebuffer,texture.width,texture.height);}this.texture=texture;this.framebuffer=binding.framebuffer;}}},{key:"create",value:function create(fragmentShaderSource,vertexShaderSource,uniforms,attribs){var fragmentShader=CreateShader(fragmentShaderSource,gl.FRAGMENT_SHADER);var vertexShader=CreateShader(vertexShaderSource,gl.VERTEX_SHADER);if(!fragmentShader|| !vertexShader){return;}var program=CreateProgram(fragmentShader,vertexShader);if(!program){return;}var currentProgram=gl.getParameter(gl.CURRENT_PROGRAM);gl.useProgram(program);this.program=program;this.uniformSetters=CreateUniforms(program);this.uniforms=new Map();for(var _i=0,_iter=Object.entries(uniforms);_i<_iter.length;_i++){var __i=_iter[_i],key=__i[0],value=__i[1];this.uniforms.set(key,value);}this.attributes=CreateAttributes(program,attribs);gl.useProgram(currentProgram);}},{key:"updateUniforms",value:function updateUniforms(renderPass){}},{key:"bind",value:function bind(renderPass){this.updateUniforms(renderPass);return this.setUniforms(renderPass);}},{key:"setUniform",value:function setUniform(key,value){var uniforms=this.uniforms;if(uniforms.has(key)){uniforms.set(key,value);var setter=this.uniformSetters.get(key);setter(value);}}},{key:"setUniforms",value:function setUniforms(renderPass){if(!this.program){return false;}gl.useProgram(this.program);var uniforms=this.uniforms;for(var _i=0,_iter=this.uniformSetters.entries();_i<_iter.length;_i++){var __i=_iter[_i],name=__i[0],setter=__i[1];setter(uniforms.get(name));}return true;}},{key:"setAttributes",value:function setAttributes(renderPass){if(this.program){var stride=renderPass.currentVertexBuffer.vertexByteSize;this.attributes.forEach(function(attrib){gl.vertexAttribPointer(attrib.index,attrib.size,attrib.type,attrib.normalized,stride,attrib.offset);});}}},{key:"destroy",value:function destroy(){DeleteShaders(this.program);DeleteGLTexture(this.texture);DeleteFramebuffer(this.framebuffer);this.uniforms.clear();this.uniformSetters.clear();this.attributes.clear();this.program=null;this.texture=null;this.framebuffer=null;}}]);return _class;}();var QuadShader=function(Shader1){"use strict";swcHelpers.inherits(_class,Shader1);function _class(param){var config=param=== void 0?{}:param;swcHelpers.classCallCheck(this,_class);var shaderConfig=config;shaderConfig.attributes=!shaderConfig.attributes?DefaultQuadAttributes:shaderConfig.attributes;return swcHelpers.possibleConstructorReturn(this,swcHelpers.getPrototypeOf(_class).call(this,shaderConfig));}swcHelpers.createClass(_class,[{key:"bind",value:function bind(renderPass){var uniforms=this.uniforms;uniforms.set("uProjectionMatrix",renderPass.projectionMatrix.data);uniforms.set("uCameraMatrix",renderPass.cameraMatrix.data);return swcHelpers.get(swcHelpers.getPrototypeOf(_class.prototype),"bind",this).call(this,renderPass);}}]);return _class;}(Shader);var MULTI_QUAD_FRAG="#define SHADER_NAME MULTI_QUAD_FRAG\n\nprecision highp float;\n\nvarying vec2 vTextureCoord;\nvarying float vTextureId;\nvarying vec4 vTintColor;\n\nuniform sampler2D uTexture[%count%];\n\nvoid main (void)\n{\n    vec4 color;\n\n    %forloop%\n\n    gl_FragColor = color * vec4(vTintColor.bgr * vTintColor.a, vTintColor.a);\n}";var MultiTextureQuadShader=function(QuadShader1){"use strict";swcHelpers.inherits(_class,QuadShader1);function _class(param){var config=param=== void 0?{}:param;swcHelpers.classCallCheck(this,_class);if(!config.fragmentShader){config.fragmentShader=MULTI_QUAD_FRAG;}return swcHelpers.possibleConstructorReturn(this,swcHelpers.getPrototypeOf(_class).call(this,config));}swcHelpers.createClass(_class,[{key:"create",value:function create(fragmentShaderSource,vertexShaderSource,uniforms,attribs){var maxTextures=GetMaxTextures();var src="";for(var i2=1;i2<maxTextures;i2++){if(i2>1){src+="\n\telse ";}if(i2<maxTextures-1){src+="if (vTextureId < ".concat(i2,".5)");}src+="\n\t{";src+="\n\t\tcolor = texture2D(uTexture[".concat(i2,"], vTextureCoord);");src+="\n\t}";}fragmentShaderSource=fragmentShaderSource.replace(/%count%/gi,"".concat(maxTextures));fragmentShaderSource=fragmentShaderSource.replace(/%forloop%/gi,src);swcHelpers.get(swcHelpers.getPrototypeOf(_class.prototype),"create",this).call(this,fragmentShaderSource,vertexShaderSource,uniforms,attribs);}},{key:"bind",value:function bind(renderPass){this.uniforms.set("uTexture",renderPass.textureIndex);return swcHelpers.get(swcHelpers.getPrototypeOf(_class.prototype),"bind",this).call(this,renderPass);}}]);return _class;}(QuadShader);function SetDefaultBlendMode(renderPass,enable,sfactor,dfactor){var entry={enable:enable,sfactor:sfactor,dfactor:dfactor};renderPass.blendModeStack[0]=entry;renderPass.currentBlendMode=entry;renderPass.defaultBlendMode=entry;}function SetDefaultFramebuffer(renderPass,param,viewport){var framebuffer=param=== void 0?null:param;var entry={framebuffer:framebuffer,viewport:viewport};renderPass.framebufferStack[0]=entry;renderPass.currentFramebuffer=entry;renderPass.defaultFramebuffer=entry;}function SetDefaultShader(renderPass,shader,textureID){var entry={shader:shader,textureID:textureID};renderPass.shaderStack[0]=entry;renderPass.currentShader=entry;renderPass.defaultShader=entry;}function SetDefaultVertexBuffer(renderPass,buffer){renderPass.vertexBufferStack[0]=buffer;renderPass.currentVertexBuffer=buffer;renderPass.defaultVertexBuffer=buffer;}function SetDefaultViewport(renderPass,param,param1,param2,param3){var x=param=== void 0?0:param,y=param1=== void 0?0:param1,width=param2=== void 0?0:param2,height=param3=== void 0?0:param3;var entry=new Rectangle(x,y,width,height);renderPass.viewportStack[0]=entry;renderPass.currentViewport=entry;renderPass.defaultViewport=entry;}var RenderPass=function(){"use strict";function _class(renderer){swcHelpers.classCallCheck(this,_class);this.count=0;this.prevCount=0;this.flushTotal=0;this.maxTextures=0;this.currentActiveTexture=0;this.startActiveTexture=0;this.tempTextures=[];this.textureIndex=[];this.framebufferStack=[];this.currentFramebuffer=null;this.defaultFramebuffer=null;this.vertexBufferStack=[];this.currentVertexBuffer=null;this.defaultVertexBuffer=null;this.shaderStack=[];this.currentShader=null;this.defaultShader=null;this.viewportStack=[];this.currentViewport=null;this.defaultViewport=null;this.blendModeStack=[];this.currentBlendMode=null;this.defaultBlendMode=null;this.renderer=renderer;this.projectionMatrix=new Matrix4();this.reset();}swcHelpers.createClass(_class,[{key:"reset",value:function reset(){var gl2=this.renderer.gl;var indexLayout=[0,1,2,2,3,0];this.quadShader=new QuadShader();this.quadBuffer=new IndexedVertexBuffer({isDynamic:false,indexLayout:indexLayout});this.quadCamera=new StaticCamera();CreateTempTextures(this);SetDefaultFramebuffer(this);SetDefaultBlendMode(this,true,gl2.ONE,gl2.ONE_MINUS_SRC_ALPHA);SetDefaultVertexBuffer(this,new IndexedVertexBuffer({batchSize:GetBatchSize(),indexLayout:indexLayout}));SetDefaultShader(this,new MultiTextureQuadShader());}},{key:"resize",value:function resize(width,height){Mat4Ortho(0,width,height,0,-1000,1000,this.projectionMatrix);this.quadCamera.reset();SetDefaultViewport(this,0,0,width,height);}}]);return _class;}();function AddShader(renderPass,shader,textureID){var stackEntry={shader:shader,textureID:textureID};renderPass.shaderStack.push(stackEntry);return stackEntry;}function AddVertexBuffer(renderPass,buffer){renderPass.vertexBufferStack.push(buffer);return buffer;}function BindShader(renderPass,entry){if(!entry){entry=renderPass.currentShader;}var success=entry.shader.bind(renderPass,entry.textureID);if(success){entry.shader.setAttributes(renderPass);}}function Begin(renderPass,camera2D){renderPass.current2DCamera=camera2D;renderPass.cameraMatrix=camera2D.matrix;BindShader(renderPass);}function BindBlendMode(renderPass,entry){if(!entry){entry=renderPass.currentBlendMode;}if(entry.enable){gl.enable(gl.BLEND);gl.blendFunc(entry.sfactor,entry.dfactor);}else{gl.disable(gl.BLEND);}}function BindTexture(texture,param){var index=param=== void 0?0:param;var binding=texture.binding;binding.setIndex(index);gl.activeTexture(gl.TEXTURE0+index);gl.bindTexture(gl.TEXTURE_2D,binding.texture);}function BindVertexBuffer(renderPass,buffer){if(!buffer){buffer=renderPass.currentVertexBuffer;}var indexBuffer=buffer.indexed?buffer.indexBuffer:null;gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,indexBuffer);gl.bindBuffer(gl.ARRAY_BUFFER,buffer.vertexBuffer);}function PopVertexBuffer(renderPass){var stack=renderPass.vertexBufferStack;if(stack.length>1){stack.pop();}renderPass.currentVertexBuffer=stack[stack.length-1];BindVertexBuffer(renderPass);}function SetVertexBuffer(renderPass,buffer){var entry=AddVertexBuffer(renderPass,buffer);BindVertexBuffer(renderPass,entry);renderPass.currentVertexBuffer=entry;}function FlushBuffer(renderPass,buffer){SetVertexBuffer(renderPass,buffer);renderPass.currentShader.shader.setAttributes(renderPass);var result=Flush(renderPass,buffer.count);PopVertexBuffer(renderPass);return result;}function GetVertexBufferEntry(renderPass,param){var addToCount=param=== void 0?0:param;var buffer=renderPass.currentVertexBuffer;if(renderPass.count+addToCount>=buffer.batchSize){Flush(renderPass);}var offset=buffer.indexed?renderPass.count*buffer.entryElementSize:renderPass.count*buffer.vertexElementSize;renderPass.count+=addToCount;return {buffer:buffer,F32:buffer.vertexViewF32,U32:buffer.vertexViewU32,offset:offset};}function PopShader(renderPass){var stack=renderPass.shaderStack;if(stack.length>1){stack.pop();}renderPass.currentShader=stack[stack.length-1];BindShader(renderPass);}function SetShader(renderPass,shader,textureID){var entry=AddShader(renderPass,shader,textureID);BindShader(renderPass,entry);renderPass.currentShader=entry;}function SetTexture(renderPass,texture){var binding=texture.binding;var currentActiveTexture=renderPass.currentActiveTexture;if(binding.indexCounter<renderPass.startActiveTexture){binding.indexCounter=renderPass.startActiveTexture;if(currentActiveTexture<renderPass.maxTextures){binding.setIndex(currentActiveTexture);gl.activeTexture(gl.TEXTURE0+currentActiveTexture);gl.bindTexture(gl.TEXTURE_2D,binding.texture);renderPass.currentActiveTexture++;}else{Flush(renderPass);renderPass.startActiveTexture++;binding.indexCounter=renderPass.startActiveTexture;binding.setIndex(1);gl.activeTexture(gl.TEXTURE1);gl.bindTexture(gl.TEXTURE_2D,binding.texture);renderPass.currentActiveTexture=2;}}return binding.index;}function Start(renderPass){renderPass.current2DCamera=renderPass.quadCamera;renderPass.cameraMatrix=renderPass.quadCamera.matrix;renderPass.count=0;renderPass.flushTotal=0;BindFramebuffer(renderPass,false,renderPass.defaultFramebuffer);BindBlendMode(renderPass,renderPass.defaultBlendMode);BindViewport(renderPass,renderPass.defaultViewport);BindVertexBuffer(renderPass,renderPass.defaultVertexBuffer);}function UnbindTexture(renderPass,param){var index=param=== void 0?0:param;gl.activeTexture(gl.TEXTURE0+index);gl.bindTexture(gl.TEXTURE_2D,renderPass.tempTextures[index]);if(index>0){renderPass.startActiveTexture++;}}var instance2;var WebGLRendererInstance={get:function(){return instance2;},set:function(renderer){instance2=renderer;}};var WebGLRenderer=function(){"use strict";function _class(){swcHelpers.classCallCheck(this,_class);this.clearColor=[0,0,0,1];this.clearBeforeRender=true;this.optimizeRedraw=false;this.autoResize=true;this.contextLost=false;this.width=GetWidth();this.height=GetHeight();this.resolution=GetResolution();this.setBackgroundColor(GetBackgroundColor());var canvas=document.createElement("canvas");canvas.addEventListener("webglcontextlost",(function(event){return this.onContextLost(event);}).bind(this),false);canvas.addEventListener("webglcontextrestored",(function(){return this.onContextRestored();}).bind(this),false);this.canvas=canvas;this.initContext();WebGLRendererInstance.set(this);this.renderPass=new RenderPass(this);this.resize(this.width,this.height,this.resolution);}swcHelpers.createClass(_class,[{key:"initContext",value:function initContext(){var gl2=this.canvas.getContext("webgl",GetWebGLContext());GL.set(gl2);this.gl=gl2;gl2.disable(gl2.DEPTH_TEST);gl2.disable(gl2.CULL_FACE);}},{key:"resize",value:function resize(width,height,param){var resolution=param=== void 0?1:param;var calcWidth=width*resolution;var calcHeight=height*resolution;this.width=calcWidth;this.height=calcHeight;this.resolution=resolution;var canvas=this.canvas;canvas.width=calcWidth;canvas.height=calcHeight;if(this.autoResize){canvas.style.width=width.toString()+"px";canvas.style.height=height.toString()+"px";}this.renderPass.resize(calcWidth,calcHeight);}},{key:"onContextLost",value:function onContextLost(event){event.preventDefault();this.contextLost=true;}},{key:"onContextRestored",value:function onContextRestored(){this.contextLost=false;this.initContext();}},{key:"setBackgroundColor",value:function setBackgroundColor(color){GetRGBArray(color,this.clearColor);return this;}},{key:"reset",value:function reset(){}},{key:"render",value:function render(renderData){if(this.contextLost){return;}var gl2=this.gl;var renderPass=this.renderPass;ProcessBindingQueue();if(this.optimizeRedraw&&renderData.numDirtyFrames===0&&renderData.numDirtyCameras===0){return;}if(this.clearBeforeRender){var cls=this.clearColor;gl2.clearColor(cls[0],cls[1],cls[2],cls[3]);gl2.clear(gl2.COLOR_BUFFER_BIT);}var worlds=renderData.worldData;Start(renderPass);for(var i2=0;i2<worlds.length;i2++){var _i=worlds[i2],world=_i.world;world.renderGL(renderPass);world.postRenderGL(renderPass);}End(renderPass);}},{key:"destroy",value:function destroy(){WebGLRendererInstance.set(void 0);}}]);return _class;}();function WebGL(){return function(){SetRenderer(WebGLRenderer);};}function SetWebGLContext(contextAttributes){ConfigStore.set(CONFIG_DEFAULTS.WEBGL_CONTEXT,contextAttributes);}function WebGLContext(contextAttributes){return function(){SetWebGLContext(contextAttributes);};}var dom_exports={};__export(dom_exports,{AddToDOM:function(){return AddToDOM;},DOMContentLoaded:function(){return DOMContentLoaded;},GetElement:function(){return GetElement;},ParseXML:function(){return ParseXML;},RemoveFromDOM:function(){return RemoveFromDOM;}});function AddToDOM(element,parent){var target=GetElement(parent);target.appendChild(element);return element;}function DOMContentLoaded(callback){var readyState=document.readyState;if(readyState==="complete"||readyState==="interactive"){callback();return;}var check=function(){document.removeEventListener("deviceready",check,true);document.removeEventListener("DOMContentLoaded",check,true);window.removeEventListener("load",check,true);callback();};if(!document.body){window.setTimeout(check,20);}else if(window.hasOwnProperty("cordova")){document.addEventListener("deviceready",check,true);}else{document.addEventListener("DOMContentLoaded",check,true);window.addEventListener("load",check,true);}}function ParseXML(data){var xml;try{var parser=new DOMParser();xml=parser.parseFromString(data,"text/xml");if(!xml|| !xml.documentElement||xml.getElementsByTagName("parsererror").length){return null;}else{return xml;}}catch(error) {return null;}}function RemoveFromDOM(element){if(element.parentNode){element.parentNode.removeChild(element);}}var device_exports={};__export(device_exports,{Audio:function(){return audio_exports;},Browser:function(){return browser_exports;},CanPlayAudioType:function(){return CanPlayAudioType;},CanPlayH264Video:function(){return CanPlayH264Video;},CanPlayHLSVideo:function(){return CanPlayHLSVideo;},CanPlayM4A:function(){return CanPlayM4A;},CanPlayMP3:function(){return CanPlayMP3;},CanPlayOGG:function(){return CanPlayOGG;},CanPlayOGGVideo:function(){return CanPlayOGGVideo;},CanPlayOpus:function(){return CanPlayOpus;},CanPlayVP9Video:function(){return CanPlayVP9Video;},CanPlayVideoType:function(){return CanPlayVideoType;},CanPlayWAV:function(){return CanPlayWAV;},CanPlayWebM:function(){return CanPlayWebM;},CanPlayWebMVideo:function(){return CanPlayWebMVideo;},GetAudio:function(){return GetAudio;},GetBrowser:function(){return GetBrowser;},GetOS:function(){return GetOS;},GetVideo:function(){return GetVideo;},HasAudio:function(){return HasAudio;},HasWebAudio:function(){return HasWebAudio;},IsAndroid:function(){return IsAndroid;},IsChrome:function(){return IsChrome;},IsChromeOS:function(){return IsChromeOS;},IsCordova:function(){return IsCordova;},IsCrosswalk:function(){return IsCrosswalk;},IsEdge:function(){return IsEdge;},IsEjecta:function(){return IsEjecta;},IsFirefox:function(){return IsFirefox;},IsKindle:function(){return IsKindle;},IsLinux:function(){return IsLinux;},IsMSIE:function(){return IsMSIE;},IsMacOS:function(){return IsMacOS;},IsMobileSafari:function(){return IsMobileSafari;},IsNode:function(){return IsNode;},IsNodeWebkit:function(){return IsNodeWebkit;},IsOpera:function(){return IsOpera;},IsSafari:function(){return IsSafari;},IsSilk:function(){return IsSilk;},IsTrident:function(){return IsTrident;},IsWebApp:function(){return IsWebApp;},IsWindows:function(){return IsWindows;},IsWindowsPhone:function(){return IsWindowsPhone;},IsiOS:function(){return IsiOS;},OS:function(){return os_exports;},Video:function(){return video_exports;}});var audio_exports={};__export(audio_exports,{CanPlayAudioType:function(){return CanPlayAudioType;},CanPlayM4A:function(){return CanPlayM4A;},CanPlayMP3:function(){return CanPlayMP3;},CanPlayOGG:function(){return CanPlayOGG;},CanPlayOpus:function(){return CanPlayOpus;},CanPlayWAV:function(){return CanPlayWAV;},CanPlayWebM:function(){return CanPlayWebM;},GetAudio:function(){return GetAudio;},HasAudio:function(){return HasAudio;},HasWebAudio:function(){return HasWebAudio;}});var _audioElement;function CanPlayAudioType(type,audioElement){if(!audioElement){if(!_audioElement){_audioElement=document.createElement("audio");}audioElement=_audioElement;}return audioElement&&audioElement.canPlayType(type)!=="";}function CanPlayM4A(audioElement){return CanPlayAudioType("audio/x-m4a",audioElement)||CanPlayAudioType("audio/aac",audioElement);}function CanPlayMP3(audioElement){return CanPlayAudioType('audio/mpeg; codecs="mp3"',audioElement);}function CanPlayOGG(audioElement){return CanPlayAudioType('audio/ogg; codecs="vorbis"',audioElement);}function CanPlayOpus(audioElement){return CanPlayAudioType('audio/ogg; codecs="opus"',audioElement)||CanPlayAudioType('audio/webm; codecs="opus"',audioElement);}function CanPlayWAV(audioElement){return CanPlayAudioType('audio/wav; codecs="1"',audioElement);}function CanPlayWebM(audioElement){return CanPlayAudioType('audio/webm; codecs="vorbis"',audioElement);}function HasAudio(){return window&&window.hasOwnProperty("Audio");}function HasWebAudio(){return window&&(window.hasOwnProperty("AudioContext")||window.hasOwnProperty("webkitAudioContext"));}function GetAudio(){var result={audioData:HasAudio(),m4a:false,mp3:false,ogg:false,opus:false,wav:false,webAudio:HasWebAudio(),webm:false};if(result.audioData){result.m4a=CanPlayM4A();result.mp3=CanPlayMP3();result.ogg=CanPlayOGG();result.opus=CanPlayOpus();result.wav=CanPlayWAV();result.webm=CanPlayWebM();}return result;}var browser_exports={};__export(browser_exports,{GetBrowser:function(){return GetBrowser;},IsChrome:function(){return IsChrome;},IsEdge:function(){return IsEdge;},IsFirefox:function(){return IsFirefox;},IsMSIE:function(){return IsMSIE;},IsMobileSafari:function(){return IsMobileSafari;},IsOpera:function(){return IsOpera;},IsSafari:function(){return IsSafari;},IsSilk:function(){return IsSilk;},IsTrident:function(){return IsTrident;}});function IsChrome(){var chrome=/Chrome\/(\d+)/.test(navigator.userAgent);var chromeVersion=chrome?parseInt(RegExp.$1,10):0;return {chrome:chrome,chromeVersion:chromeVersion};}function IsEdge(){var edge=/Edge\/\d+/.test(navigator.userAgent);return {edge:edge};}function IsFirefox(){var firefox=/Firefox\D+(\d+)/.test(navigator.userAgent);var firefoxVersion=firefox?parseInt(RegExp.$1,10):0;return {firefox:firefox,firefoxVersion:firefoxVersion};}function IsMSIE(){var ie=/MSIE (\d+\.\d+);/.test(navigator.userAgent);var ieVersion=ie?parseInt(RegExp.$1,10):0;return {ie:ie,ieVersion:ieVersion};}function IsiOS(){var ua=navigator.userAgent;var result={iOS:false,iOSVersion:0,iPhone:false,iPad:false};if(/iP[ao]d|iPhone/i.test(ua)){var match=/OS (\d+)/.exec(navigator.appVersion);result.iOS=true;result.iOSVersion=parseInt(match[0],10);result.iPhone=ua.toLowerCase().includes("iphone");result.iPad=ua.toLowerCase().includes("ipad");}return result;}function IsMobileSafari(){var ref=IsiOS(),iOS=ref.iOS;var mobileSafari=navigator.userAgent.includes("AppleWebKit")&&iOS;return {mobileSafari:mobileSafari};}function IsOpera(){var opera=navigator.userAgent.includes("Opera");return {opera:opera};}function IsWindowsPhone(){var ua=navigator.userAgent;return /Windows Phone/i.test(ua)||/IEMobile/i.test(ua);}function IsSafari(){var ua=navigator.userAgent;var safari=ua.includes("Safari")&& !IsWindowsPhone();var safariVersion=/Version\/(\d+)\./.test(ua)?parseInt(RegExp.$1,10):0;return {safari:safari,safariVersion:safariVersion};}function IsSilk(){var silk=navigator.userAgent.includes("Silk");return {silk:silk};}function IsTrident(){var trident=/Trident\/(\d+\.\d+)(.*)rv:(\d+\.\d+)/.test(navigator.userAgent);var tridentVersion=trident?parseInt(RegExp.$1,10):0;var tridentIEVersion=trident?parseInt(RegExp.$3,10):0;return {trident:trident,tridentVersion:tridentVersion,tridentIEVersion:tridentIEVersion};}function GetBrowser(){var ref=IsChrome(),chrome=ref.chrome,chromeVersion=ref.chromeVersion;var ref1=IsEdge(),edge=ref1.edge;var ref2=IsFirefox(),firefox=ref2.firefox,firefoxVersion=ref2.firefoxVersion;var ref3=IsMSIE(),ie=ref3.ie,ieVersion=ref3.ieVersion;var ref4=IsMobileSafari(),mobileSafari=ref4.mobileSafari;var ref5=IsOpera(),opera=ref5.opera;var ref6=IsSafari(),safari=ref6.safari,safariVersion=ref6.safariVersion;var ref7=IsSilk(),silk=ref7.silk;var ref8=IsTrident(),trident=ref8.trident,tridentVersion=ref8.tridentVersion,tridentIEVersion=ref8.tridentIEVersion;if(trident){ie=true;ieVersion=tridentIEVersion;}var result={chrome:chrome,chromeVersion:chromeVersion,edge:edge,firefox:firefox,firefoxVersion:firefoxVersion,ie:ie,ieVersion:ieVersion,mobileSafari:mobileSafari,opera:opera,safari:safari,safariVersion:safariVersion,silk:silk,trident:trident,tridentVersion:tridentVersion};return result;}var os_exports={};__export(os_exports,{GetOS:function(){return GetOS;},IsAndroid:function(){return IsAndroid;},IsChromeOS:function(){return IsChromeOS;},IsCordova:function(){return IsCordova;},IsCrosswalk:function(){return IsCrosswalk;},IsEjecta:function(){return IsEjecta;},IsKindle:function(){return IsKindle;},IsLinux:function(){return IsLinux;},IsMacOS:function(){return IsMacOS;},IsNode:function(){return IsNode;},IsNodeWebkit:function(){return IsNodeWebkit;},IsWebApp:function(){return IsWebApp;},IsWindows:function(){return IsWindows;},IsWindowsPhone:function(){return IsWindowsPhone;},IsiOS:function(){return IsiOS;}});function IsAndroid(){return navigator.userAgent.includes("Android");}function IsChromeOS(){return navigator.userAgent.includes("CrOS");}function IsCordova(){return window.hasOwnProperty("cordova");}function IsCrosswalk(){return navigator.userAgent.includes("Crosswalk");}function IsEjecta(){return window.hasOwnProperty("ejecta");}function IsKindle(){var ua=navigator.userAgent;return ua.includes("Kindle")||/\bKF[A-Z][A-Z]+/.test(ua)||/Silk.*Mobile Safari/.test(ua);}function IsLinux(){return navigator.userAgent.includes("Linux");}function IsMacOS(){var ua=navigator.userAgent;return ua.includes("Mac OS")&& !ua.includes("like Mac OS");}function IsNode(){return typeof process!=="undefined"&&typeof process.versions==="object"&&process.versions.hasOwnProperty("node");}function IsNodeWebkit(){return IsNode()&& !!process.versions.hasOwnProperty("node-webkit");}function IsWebApp(){return navigator.hasOwnProperty("standalone");}function IsWindows(){return navigator.userAgent.includes("Windows");}function GetOS(){var ua=navigator.userAgent;var ref=IsiOS(),iOS=ref.iOS,iOSVersion=ref.iOSVersion,iPad=ref.iPad,iPhone=ref.iPhone;var result={android:IsAndroid(),chromeOS:IsChromeOS(),cordova:IsCordova(),crosswalk:IsCrosswalk(),desktop:false,ejecta:IsEjecta(),iOS:iOS,iOSVersion:iOSVersion,iPad:iPad,iPhone:iPhone,kindle:IsKindle(),linux:IsLinux(),macOS:IsMacOS(),node:IsNode(),nodeWebkit:IsNodeWebkit(),pixelRatio:1,webApp:IsWebApp(),windows:IsWindows(),windowsPhone:IsWindowsPhone()};if(result.windowsPhone){result.android=false;result.iOS=false;result.macOS=false;result.windows=true;}var silk=ua.includes("Silk");if(result.windows||result.macOS||result.linux&& !silk||result.chromeOS){result.desktop=true;}if(result.windowsPhone||/Windows NT/i.test(ua)&&/Touch/i.test(ua)){result.desktop=false;}return result;}var video_exports={};__export(video_exports,{CanPlayH264Video:function(){return CanPlayH264Video;},CanPlayHLSVideo:function(){return CanPlayHLSVideo;},CanPlayOGGVideo:function(){return CanPlayOGGVideo;},CanPlayVP9Video:function(){return CanPlayVP9Video;},CanPlayVideoType:function(){return CanPlayVideoType;},CanPlayWebMVideo:function(){return CanPlayWebMVideo;},GetVideo:function(){return GetVideo;}});var _videoElement;function CanPlayVideoType(type,videoElement){if(!videoElement){if(!_videoElement){_videoElement=document.createElement("video");}videoElement=_videoElement;}return videoElement&&videoElement.canPlayType(type)!=="";}function CanPlayH264Video(videoElement){return CanPlayVideoType('video/mp4; codecs="avc1.42E01E"',videoElement);}function CanPlayHLSVideo(videoElement){return CanPlayVideoType('application/x-mpegURL; codecs="avc1.42E01E"',videoElement);}function CanPlayOGGVideo(videoElement){return CanPlayVideoType('video/ogg; codecs="theora"',videoElement);}function CanPlayVP9Video(videoElement){return CanPlayVideoType('video/webm; codecs="vp9"',videoElement);}function CanPlayWebMVideo(videoElement){return CanPlayVideoType('video/webm; codecs="vp8, vorbis"',videoElement);}function GetVideo(){return {h264Video:CanPlayH264Video(),hlsVideo:CanPlayHLSVideo(),oggVideo:CanPlayOGGVideo(),vp9Video:CanPlayVP9Video(),webmVideo:CanPlayWebMVideo()};}var display_exports={};__export(display_exports,{AddChild:function(){return AddChild;},AddChildAt:function(){return AddChildAt;},AddChildren:function(){return AddChildren;},AddChildrenAt:function(){return AddChildrenAt;},AddPosition:function(){return AddPosition;},AddRotation:function(){return AddRotation;},AddScale:function(){return AddScale;},AddSkew:function(){return AddSkew;},BringChildToTop:function(){return BringChildToTop;},ConsoleTreeChildren:function(){return ConsoleTreeChildren;},CountMatchingChildren:function(){return CountMatchingChildren;},DepthFirstSearch:function(){return DepthFirstSearch;},DepthFirstSearchRecursive:function(){return DepthFirstSearchRecursive;},DepthFirstSearchRecursiveNested:function(){return DepthFirstSearchRecursiveNested;},DestroyChildren:function(){return DestroyChildren;},FindChildByName:function(){return FindChildByName;},FindChildrenByName:function(){return FindChildrenByName;},GetAllChildren:function(){return GetAllChildren;},GetBounds:function(){return GetBounds;},GetChildAt:function(){return GetChildAt;},GetChildIndex:function(){return GetChildIndex;},GetChildren:function(){return GetChildren;},GetClosestChild:function(){return GetClosestChild;},GetFirstChild:function(){return GetFirstChild;},GetFurthestChild:function(){return GetFurthestChild;},GetLastChild:function(){return GetLastChild;},GetParents:function(){return GetParents;},GetRandomChild:function(){return GetRandomChild;},MoveChildDown:function(){return MoveChildDown;},MoveChildTo:function(){return MoveChildTo;},MoveChildUp:function(){return MoveChildUp;},OverlapBounds:function(){return OverlapBounds;},RemoveChild:function(){return RemoveChild;},RemoveChildAt:function(){return RemoveChildAt;},RemoveChildren:function(){return RemoveChildren;},RemoveChildrenAt:function(){return RemoveChildrenAt;},RemoveChildrenBetween:function(){return RemoveChildrenBetween;},ReparentChildren:function(){return ReparentChildren;},RotateChildrenLeft:function(){return RotateChildrenLeft;},RotateChildrenRight:function(){return RotateChildrenRight;},SendChildToBack:function(){return SendChildToBack;},SetBounds:function(){return SetBounds;},SetChildrenValue:function(){return SetChildrenValue;},SetName:function(){return SetName;},SetOrigin:function(){return SetOrigin;},SetParent:function(){return SetParent2;},SetPosition:function(){return SetPosition;},SetRotation:function(){return SetRotation;},SetScale:function(){return SetScale;},SetSize:function(){return SetSize2;},SetSkew:function(){return SetSkew;},SetType:function(){return SetType;},SetValue:function(){return SetValue;},SetVisible:function(){return SetVisible;},SetWorld:function(){return SetWorld;},ShuffleChildren:function(){return ShuffleChildren;},SwapChildren:function(){return SwapChildren;}});function DepthFirstSearch(parent){var stack=[parent];var output=[];while(stack.length>0){var node=stack.shift();output.push(node);var numChildren=node.numChildren;if(numChildren>0){for(var i2=numChildren-1;i2>=0;i2--){stack.unshift(node.children[i2]);}}}output.shift();return output;}function GetChildIndex(parent,child){return parent.children.indexOf(child);}function RemoveChildAt(parent,index){var children=parent.children;var child;if(index>=0&&index<children.length){var removed=children.splice(index,1);if(removed[0]){child=removed[0];child.parent=null;}}return child;}function RemoveChild(parent,child){var currentIndex=GetChildIndex(parent,child);if(currentIndex> -1){RemoveChildAt(parent,currentIndex);}return child;}var AddedToWorldEvent="addedtoworld";var DestroyEvent="destroy";var PostUpdateEvent="postupdate";var RemovedFromWorldEvent="removedfromworld";var UpdateEvent="update";function Emit(emitter,event){for(var _len=arguments.length,args=new Array(_len>2?_len-2:0),_key=2;_key<_len;_key++){args[_key-2]=arguments[_key];}if(emitter.events.size===0|| !emitter.events.has(event)){return false;}var listeners=emitter.events.get(event);for(var _i=0;_i<listeners.length;_i++){var ee=listeners[_i];ee.callback.apply(ee.context,args);if(ee.once){listeners.delete(ee);}}if(listeners.size===0){emitter.events.delete(event);}return true;}function SetWorld(world){for(var _len=arguments.length,children=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){children[_key-1]=arguments[_key];}children.forEach(function(child){if(child.world){Emit(child.world,RemovedFromWorldEvent,child,child.world);Emit(child,RemovedFromWorldEvent,child,child.world);}child.world=world;Emit(world,AddedToWorldEvent,child,world);Emit(child,AddedToWorldEvent,child,world);});return children;}function SetParent2(parent){for(var _len=arguments.length,children=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){children[_key-1]=arguments[_key];}children.forEach(function(child){if(child.parent){RemoveChild(child.parent,child);}child.parent=parent;});var parentWorld=parent.world;if(parentWorld){SetWorld.apply(void 0,[parentWorld].concat(swcHelpers.toConsumableArray(DepthFirstSearch(parent))));}return children;}function AddChild(parent,child){parent.children.push(child);SetParent2(parent,child);child.transform.updateWorld();return child;}function AddChildAt(parent,index,child){var children=parent.children;if(index>=0&&index<=children.length){SetParent2(parent,child);children.splice(index,0,child);child.transform.updateWorld();}return child;}function AddChildren(parent){for(var _len=arguments.length,children=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){children[_key-1]=arguments[_key];}children.forEach(function(child){AddChild(parent,child);});return children;}function AddChildrenAt(parent,index){for(var _len=arguments.length,children=new Array(_len>2?_len-2:0),_key=2;_key<_len;_key++){children[_key-2]=arguments[_key];}var parentChildren=parent.children;if(index>=0&&index<=parentChildren.length){children.reverse().forEach(function(child){children.splice(index,0,child);SetParent2(parent,child);child.transform.updateWorld();});}return children;}function AddPosition(x,y){for(var _len=arguments.length,children=new Array(_len>2?_len-2:0),_key=2;_key<_len;_key++){children[_key-2]=arguments[_key];}children.forEach(function(child){child.x+=x;child.y+=y;});return children;}function AddRotation(rotation){for(var _len=arguments.length,children=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){children[_key-1]=arguments[_key];}children.forEach(function(child){child.rotation+=rotation;});return children;}function AddScale(scaleX,scaleY){for(var _len=arguments.length,children=new Array(_len>2?_len-2:0),_key=2;_key<_len;_key++){children[_key-2]=arguments[_key];}children.forEach(function(child){child.scaleX+=scaleX;child.scaleY+=scaleY;});return children;}function AddSkew(skewX,skewY){for(var _len=arguments.length,children=new Array(_len>2?_len-2:0),_key=2;_key<_len;_key++){children[_key-2]=arguments[_key];}children.forEach(function(child){child.skewX+=skewX;child.skewY+=skewY;});return children;}var DIRTY_CONST={CLEAR:0,TRANSFORM:1,UPDATE:2,CHILD_CACHE:4,POST_RENDER:8,COLORS:16,BOUNDS:32,TEXTURE:64,FRAME:128,ALPHA:256,CHILD:512,DEFAULT:1+2+16+32,USER1:536870912,USER2:1073741824,USER3:2147483648,USER4:4294967296};function BringChildToTop(parent,child){var parentChildren=parent.children;var currentIndex=GetChildIndex(parent,child);if(currentIndex!== -1&&currentIndex<parentChildren.length){parentChildren.splice(currentIndex,1);parentChildren.push(child);child.setDirty(DIRTY_CONST.TRANSFORM);}return child;}function DepthFirstSearchRecursiveNested(parent,param){var output=param=== void 0?[]:param;for(var i3=0;i3<parent.numChildren;i3++){var node=parent.children[i3];var children=[];output.push({node:node,children:children});if(node.numChildren>0){DepthFirstSearchRecursiveNested(node,children);}}return output;}function GetInfo(entry){var legend=entry.numChildren>0?"Parent":"Child";return "".concat(legend," [ type=").concat(entry.type,", name=").concat(entry.name," ]");}function LogChildren(entry){console.group(GetInfo(entry.node));entry.children.forEach(function(child){if(child.children.length>0){LogChildren(child);}else{console.log(GetInfo(child.node));}});console.groupEnd();}function ConsoleTreeChildren(parent){var entries=DepthFirstSearchRecursiveNested(parent);if(parent.world===parent){console.group("World");}else{console.group(GetInfo(parent));}entries.forEach(function(entry){if(entry.children.length){LogChildren(entry);}else{console.log(GetInfo(entry.node));}});console.groupEnd();}function CountMatchingChildren(parent,property,value){var children=parent.children;var total=0;children.forEach(function(child){var descriptor=Object.getOwnPropertyDescriptor(child,property);if(descriptor&&(value=== void 0||value===descriptor.value)){total++;}});return total;}function DepthFirstSearchRecursive(parent,param){var output=param=== void 0?[]:param;for(var i3=0;i3<parent.numChildren;i3++){var child=parent.children[i3];output.push(child);if(child.numChildren>0){DepthFirstSearchRecursive(child,output);}}return output;}function RemoveChildrenBetween(parent,param,endIndex){var beginIndex=param=== void 0?0:param;var children=parent.children;if(endIndex=== void 0){endIndex=children.length;}var range=endIndex-beginIndex;if(range>0&&range<=endIndex){var removed=children.splice(beginIndex,range);removed.forEach(function(child){child.parent=null;});return removed;}else{return [];}}function DestroyChildren(parent,param,endIndex){var beginIndex=param=== void 0?0:param;var removed=RemoveChildrenBetween(parent,beginIndex,endIndex);removed.forEach(function(child){child.destroy();});}function FindChildByName(parent,searchString){var children=DepthFirstSearch(parent);var regex=RegExp(searchString);for(var i3=0;i3<children.length;i3++){var child=children[i3];if(regex.test(child.name)){return child;}}}function FindChildrenByName(parent,searchString){var children=DepthFirstSearch(parent);var regex=RegExp(searchString);var results=[];children.forEach(function(child){if(regex.test(child.name)){results.push(child);}});return results;}function GetAllChildren(parent,property,value){var children=DepthFirstSearch(parent);if(!property){return children;}var results=[];children.forEach(function(child){var descriptor=Object.getOwnPropertyDescriptor(child,property);if(descriptor&&(value=== void 0||value===descriptor.value)){results.push(child);}});return results;}function GetBounds(){for(var _len=arguments.length,children=new Array(_len),_key=0;_key<_len;_key++){children[_key]=arguments[_key];}var minX=Number.MAX_SAFE_INTEGER;var minY=Number.MAX_SAFE_INTEGER;var maxX=Number.MIN_SAFE_INTEGER;var maxY=Number.MIN_SAFE_INTEGER;children.forEach(function(child){var ref=child.bounds.get(),x=ref.x,y=ref.y,right=ref.right,bottom=ref.bottom;if(x<minX){minX=x;}if(y<minY){minY=y;}if(right>maxX){maxX=right;}if(bottom>maxY){maxY=bottom;}});return new Rectangle(minX,minY,maxX,maxY);}function GetChildAt(parent,index){var children=parent.children;if(index<0||index>children.length){throw new Error("Index out of bounds: ".concat(index));}return children[index];}function GetChildren(parent,property,value){var children=parent.children;if(!property){return [].concat(children);}var results=[];children.forEach(function(child){var descriptor=Object.getOwnPropertyDescriptor(child,property);if(descriptor&&(value=== void 0||value===descriptor.value)){results.push(child);}});return results;}function GetClosestChild(parent,point){var children=parent.children;var closest=null;var distance=0;children.forEach(function(child){var childDistance=GetVec2Distance(point,child.transform.position);if(!closest||childDistance<distance){closest=child;distance=childDistance;}});return closest;}function GetFirstChild(parent,property,value){var children=parent.children;for(var i3=0;i3<children.length;i3++){var child=children[i3];var descriptor=Object.getOwnPropertyDescriptor(child,property);if(descriptor&&(value=== void 0||value===descriptor.value)){return child;}}}function GetFurthestChild(parent,point){var children=parent.children;var furthest=null;var distance=0;children.forEach(function(child){var childDistance=GetVec2Distance(point,child.transform.position);if(!furthest||childDistance>distance){furthest=child;distance=childDistance;}});return furthest;}function GetLastChild(parent,property,value){var children=parent.children;for(var i3=children.length-1;i3>=0;i3--){var child=children[i3];var descriptor=Object.getOwnPropertyDescriptor(child,property);if(descriptor&&(value=== void 0||value===descriptor.value)){return child;}}}function GetParents(child){var parents=[];while(child.parent){parents.push(child.parent);child=child.parent;}return parents;}function GetRandomChild(parent,param,length){var startIndex=param=== void 0?0:param;var children=parent.children;if(!length){length=children.length;}var randomIndex=startIndex+Math.floor(Math.random()*length);return children[randomIndex];}function MoveChildDown(parent,child){var parentChildren=parent.children;var currentIndex=GetChildIndex(parent,child);if(currentIndex>0){var child2=parentChildren[currentIndex-1];var index2=parentChildren.indexOf(child2);parentChildren[currentIndex]=child2;parentChildren[index2]=child;child.setDirty(DIRTY_CONST.TRANSFORM);child2.setDirty(DIRTY_CONST.TRANSFORM);}return child;}function MoveChildTo(parent,child,index){var parentChildren=parent.children;var currentIndex=GetChildIndex(parent,child);if(currentIndex=== -1||index<0||index>=parentChildren.length){throw new Error("Index out of bounds");}if(currentIndex!==index){parentChildren.splice(currentIndex,1);parentChildren.splice(index,0,child);child.setDirty(DIRTY_CONST.TRANSFORM);}return child;}function MoveChildUp(parent,child){var parentChildren=parent.children;var currentIndex=GetChildIndex(parent,child);if(currentIndex!== -1&&currentIndex>0){var child2=parentChildren[currentIndex+1];var index2=parentChildren.indexOf(child2);parentChildren[currentIndex]=child2;parentChildren[index2]=child;child.setDirty(DIRTY_CONST.TRANSFORM);child2.setDirty(DIRTY_CONST.TRANSFORM);}return child;}function RectangleToRectangle(rectA,rectB){if(rectA.width<=0||rectA.height<=0||rectB.width<=0||rectB.height<=0){return false;}return !(rectA.right<rectB.x||rectA.bottom<rectB.y||rectA.x>rectB.right||rectA.y>rectB.bottom);}function OverlapBounds(source){for(var _len=arguments.length,targets=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){targets[_key-1]=arguments[_key];}var sourceBounds=source.getBounds();for(var i3=0;i3<targets.length;i3++){var target=targets[i3];if(target===source){continue;}if(RectangleToRectangle(sourceBounds,target.getBounds())){return true;}}return false;}function RemoveChildren(parent){for(var _len=arguments.length,children=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){children[_key-1]=arguments[_key];}children.forEach(function(child){RemoveChild(parent,child);});return children;}function RemoveChildrenAt(parent){for(var _len=arguments.length,index=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){index[_key-1]=arguments[_key];}var removed=[];index.sort(function(a,b){return a-b;});index.reverse().forEach(function(i3){var child=RemoveChildAt(parent,i3);if(child){removed.push(child);}});return removed;}function ReparentChildren(parent,newParent,param,endIndex){var beginIndex=param=== void 0?0:param;var moved=RemoveChildrenBetween(parent,beginIndex,endIndex);SetParent2.apply(void 0,[newParent].concat(swcHelpers.toConsumableArray(moved)));moved.forEach(function(child){child.transform.updateWorld();});return moved;}function RotateChildrenLeft(parent,param){var total=param=== void 0?1:param;var parentChildren=parent.children;var child=null;for(var i3=0;i3<total;i3++){child=parentChildren.shift();parentChildren.push(child);child.setDirty(DIRTY_CONST.TRANSFORM);}return child;}function RotateChildrenRight(parent,param){var total=param=== void 0?1:param;var parentChildren=parent.children;var child=null;for(var i3=0;i3<total;i3++){child=parentChildren.pop();parentChildren.unshift(child);child.setDirty(DIRTY_CONST.TRANSFORM);}return child;}function SendChildToBack(parent,child){var parentChildren=parent.children;var currentIndex=GetChildIndex(parent,child);if(currentIndex!== -1&&currentIndex>0){parentChildren.splice(currentIndex,1);parentChildren.unshift(child);child.setDirty(DIRTY_CONST.TRANSFORM);}return child;}function SetBounds(x,y,width,height){for(var _len=arguments.length,children=new Array(_len>4?_len-4:0),_key=4;_key<_len;_key++){children[_key-4]=arguments[_key];}children.forEach(function(child){child.bounds.set(x,y,width,height);});return children;}function SetChildrenValue(parent,property,value){var children=DepthFirstSearch(parent);children.forEach(function(child){var descriptor=Object.getOwnPropertyDescriptor(child,property);if(descriptor){descriptor.set(value);}});return children;}function SetName(name){for(var _len=arguments.length,children=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){children[_key-1]=arguments[_key];}children.forEach(function(child){child.name=name;});return children;}function SetOrigin(originX,originY){for(var _len=arguments.length,children=new Array(_len>2?_len-2:0),_key=2;_key<_len;_key++){children[_key-2]=arguments[_key];}children.forEach(function(child){child.setOrigin(originX,originY);});return children;}function SetPosition(x,y){for(var _len=arguments.length,children=new Array(_len>2?_len-2:0),_key=2;_key<_len;_key++){children[_key-2]=arguments[_key];}children.forEach(function(child){child.setPosition(x,y);});return children;}function SetRotation(rotation){for(var _len=arguments.length,children=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){children[_key-1]=arguments[_key];}children.forEach(function(child){child.rotation=rotation;});return children;}function SetScale(scaleX,scaleY){for(var _len=arguments.length,children=new Array(_len>2?_len-2:0),_key=2;_key<_len;_key++){children[_key-2]=arguments[_key];}children.forEach(function(child){child.setScale(scaleX,scaleY);});return children;}function SetSize2(width,height){for(var _len=arguments.length,children=new Array(_len>2?_len-2:0),_key=2;_key<_len;_key++){children[_key-2]=arguments[_key];}children.forEach(function(child){child.setSize(width,height);});return children;}function SetSkew(skewX,skewY){for(var _len=arguments.length,children=new Array(_len>2?_len-2:0),_key=2;_key<_len;_key++){children[_key-2]=arguments[_key];}children.forEach(function(child){child.setSkew(skewX,skewY);});return children;}function SetType(type){for(var _len=arguments.length,children=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){children[_key-1]=arguments[_key];}children.forEach(function(child){child.type=type;});return children;}function SetValue(property,value){for(var _len=arguments.length,children=new Array(_len>2?_len-2:0),_key=2;_key<_len;_key++){children[_key-2]=arguments[_key];}children.forEach(function(child){var descriptor=Object.getOwnPropertyDescriptor(child,property);if(descriptor){descriptor.set(value);}});return children;}function SetVisible(visible){for(var _len=arguments.length,children=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){children[_key-1]=arguments[_key];}children.forEach(function(child){child.visible=visible;});return children;}function ShuffleChildren(parent){var children=parent.children;for(var i3=children.length-1;i3>0;i3--){var j=Math.floor(Math.random()*(i3+1));var temp=children[i3];children[i3]=children[j];children[j]=temp;temp.setDirty(DIRTY_CONST.TRANSFORM);}return children;}function SwapChildren(child1,child2){if(child1.parent===child2.parent){var children=child1.parent.children;var index1=GetChildIndex(child1.parent,child1);var index2=GetChildIndex(child2.parent,child2);if(index1!==index2){children[index1]=child2;children[index2]=child1;}}}var display3d_exports={};__export(display3d_exports,{AddChild3D:function(){return AddChild3D;},AddChild3DAt:function(){return AddChild3DAt;},AddChildren3D:function(){return AddChildren3D;},AddChildren3DAt:function(){return AddChildren3DAt;},ConsoleTreeChildren3D:function(){return ConsoleTreeChildren3D;},CountMatchingChildren3D:function(){return CountMatchingChildren3D;},DepthFirstSearch3D:function(){return DepthFirstSearch3D;},DepthFirstSearchRecursive3D:function(){return DepthFirstSearchRecursive3D;},DepthFirstSearchRecursiveNested3D:function(){return DepthFirstSearchRecursiveNested3D;},DestroyChildren3D:function(){return DestroyChildren3D;},FindChild3DByName:function(){return FindChild3DByName;},FindChildren3DByName:function(){return FindChildren3DByName;},GetAllChildren3D:function(){return GetAllChildren3D;},GetChild3DAt:function(){return GetChild3DAt;},GetChild3DIndex:function(){return GetChild3DIndex;},GetChildren3D:function(){return GetChildren3D;},GetFirstChild3D:function(){return GetFirstChild3D;},GetLastChild3D:function(){return GetLastChild3D;},GetParents3D:function(){return GetParents3D;},GetRandomChild3D:function(){return GetRandomChild3D;},MoveChild3DTo:function(){return MoveChild3DTo;},RemoveChild3D:function(){return RemoveChild3D;},RemoveChild3DAt:function(){return RemoveChild3DAt;},RemoveChildren3D:function(){return RemoveChildren3D;},RemoveChildren3DAt:function(){return RemoveChildren3DAt;},RemoveChildren3DBetween:function(){return RemoveChildren3DBetween;},ReparentChildren3D:function(){return ReparentChildren3D;},ReplaceChild3D:function(){return ReplaceChild3D;},SetChildren3DValue:function(){return SetChildren3DValue;},SetParent3D:function(){return SetParent3D;},SetWorld3D:function(){return SetWorld3D;},SwapChildren3D:function(){return SwapChildren3D;}});function DepthFirstSearch3D(parent){var stack=[parent];var output=[];while(stack.length>0){var node=stack.shift();output.push(node);var numChildren=node.numChildren;if(numChildren>0){for(var i3=numChildren-1;i3>=0;i3--){stack.unshift(node.children[i3]);}}}output.shift();return output;}function GetChild3DIndex(parent,child){return parent.children.indexOf(child);}function RemoveChild3DAt(parent,index){var children=parent.children;var child;if(index>=0&&index<children.length){var removed=children.splice(index,1);if(removed[0]){child=removed[0];child.parent=null;}}return child;}function RemoveChild3D(parent,child){var currentIndex=GetChild3DIndex(parent,child);if(currentIndex> -1){RemoveChild3DAt(parent,currentIndex);}return child;}function SetWorld3D(world){for(var _len=arguments.length,children=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){children[_key-1]=arguments[_key];}children.forEach(function(child){if(child.world){Emit(child.world,RemovedFromWorldEvent,child,child.world);Emit(child,RemovedFromWorldEvent,child,child.world);}child.world=world;Emit(world,AddedToWorldEvent,child,world);Emit(child,AddedToWorldEvent,child,world);});return children;}function SetParent3D(parent){for(var _len=arguments.length,children=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){children[_key-1]=arguments[_key];}children.forEach(function(child){if(child.parent){RemoveChild3D(child.parent,child);}child.parent=parent;});var parentWorld=parent.world;if(parentWorld){SetWorld3D.apply(void 0,[parentWorld].concat(swcHelpers.toConsumableArray(DepthFirstSearch3D(parent))));}return children;}function AddChild3D(parent,child){parent.children.push(child);SetParent3D(parent,child);return child;}function AddChild3DAt(parent,index,child){var children=parent.children;if(index>=0&&index<=children.length){SetParent3D(parent,child);children.splice(index,0,child);}return child;}function AddChildren3D(parent){for(var _len=arguments.length,children=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){children[_key-1]=arguments[_key];}children.forEach(function(child){AddChild3D(parent,child);});return children;}function AddChildren3DAt(parent,index){for(var _len=arguments.length,children=new Array(_len>2?_len-2:0),_key=2;_key<_len;_key++){children[_key-2]=arguments[_key];}var parentChildren=parent.children;if(index>=0&&index<=parentChildren.length){children.reverse().forEach(function(child){children.splice(index,0,child);SetParent3D(parent,child);});}return children;}function DepthFirstSearchRecursiveNested3D(parent,param){var output=param=== void 0?[]:param;for(var i4=0;i4<parent.numChildren;i4++){var node=parent.children[i4];var children=[];output.push({node:node,children:children});if(node.numChildren>0){DepthFirstSearchRecursiveNested3D(node,children);}}return output;}function GetInfo2(entry){var legend=entry.numChildren>0?"Parent":"Child";return "".concat(legend," [ type=").concat(entry.type,", name=").concat(entry.name," ]");}function LogChildren2(entry){console.group(GetInfo2(entry.node));entry.children.forEach(function(child){if(child.children.length>0){LogChildren2(child);}else{console.log(GetInfo2(child.node));}});console.groupEnd();}function ConsoleTreeChildren3D(parent){var entries=DepthFirstSearchRecursiveNested3D(parent);if(parent.world===parent){console.group("World");}else{console.group(GetInfo2(parent));}entries.forEach(function(entry){if(entry.children.length){LogChildren2(entry);}else{console.log(GetInfo2(entry.node));}});console.groupEnd();}function CountMatchingChildren3D(parent,property,value){var children=parent.children;var total=0;children.forEach(function(child){var descriptor=Object.getOwnPropertyDescriptor(child,property);if(descriptor&&(value=== void 0||value===descriptor.value)){total++;}});return total;}function DepthFirstSearchRecursive3D(parent,param){var output=param=== void 0?[]:param;for(var i4=0;i4<parent.numChildren;i4++){var child=parent.children[i4];output.push(child);if(child.numChildren>0){DepthFirstSearchRecursive3D(child,output);}}return output;}function RemoveChildren3DBetween(parent,param,endIndex){var beginIndex=param=== void 0?0:param;var children=parent.children;if(endIndex=== void 0){endIndex=children.length;}var range=endIndex-beginIndex;if(range>0&&range<=endIndex){var removed=children.splice(beginIndex,range);removed.forEach(function(child){child.parent=null;});return removed;}else{return [];}}function DestroyChildren3D(parent,param,endIndex){var beginIndex=param=== void 0?0:param;var removed=RemoveChildren3DBetween(parent,beginIndex,endIndex);removed.forEach(function(child){child.destroy();});}function FindChild3DByName(parent,searchString){var children=DepthFirstSearch3D(parent);var regex=RegExp(searchString);for(var i4=0;i4<children.length;i4++){var child=children[i4];if(regex.test(child.name)){return child;}}}function FindChildren3DByName(parent,searchString){var children=DepthFirstSearch3D(parent);var regex=RegExp(searchString);var results=[];children.forEach(function(child){if(regex.test(child.name)){results.push(child);}});return results;}function GetAllChildren3D(parent,property,value){var children=DepthFirstSearch3D(parent);if(!property){return children;}var results=[];children.forEach(function(child){var descriptor=Object.getOwnPropertyDescriptor(child,property);if(descriptor&&(value=== void 0||value===descriptor.value)){results.push(child);}});return results;}function GetChild3DAt(parent,index){var children=parent.children;if(index<0||index>children.length){throw new Error("Index out of bounds: ".concat(index));}return children[index];}function GetChildren3D(parent,property,value){var children=parent.children;if(!property){return [].concat(children);}var results=[];children.forEach(function(child){var descriptor=Object.getOwnPropertyDescriptor(child,property);if(descriptor&&(value=== void 0||value===descriptor.value)){results.push(child);}});return results;}function GetFirstChild3D(parent,property,value){var children=parent.children;for(var i4=0;i4<children.length;i4++){var child=children[i4];var descriptor=Object.getOwnPropertyDescriptor(child,property);if(descriptor&&(value=== void 0||value===descriptor.value)){return child;}}}function GetLastChild3D(parent,property,value){var children=parent.children;for(var i4=children.length-1;i4>=0;i4--){var child=children[i4];var descriptor=Object.getOwnPropertyDescriptor(child,property);if(descriptor&&(value=== void 0||value===descriptor.value)){return child;}}}function GetParents3D(child){var parents=[];while(child.parent){parents.push(child.parent);child=child.parent;}return parents;}function GetRandomChild3D(parent,param,length){var startIndex=param=== void 0?0:param;var children=parent.children;if(!length){length=children.length;}var randomIndex=startIndex+Math.floor(Math.random()*length);return children[randomIndex];}function MoveChild3DTo(parent,child,index){var parentChildren=parent.children;var currentIndex=GetChild3DIndex(parent,child);if(currentIndex=== -1||index<0||index>=parentChildren.length){throw new Error("Index out of bounds");}if(currentIndex!==index){parentChildren.splice(currentIndex,1);parentChildren.splice(index,0,child);child.setDirty(DIRTY_CONST.TRANSFORM);}return child;}function RemoveChildren3D(parent){for(var _len=arguments.length,children=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){children[_key-1]=arguments[_key];}children.forEach(function(child){RemoveChild3D(parent,child);});return children;}function RemoveChildren3DAt(parent){for(var _len=arguments.length,index=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){index[_key-1]=arguments[_key];}var removed=[];index.sort(function(a,b){return a-b;});index.reverse().forEach(function(i4){var child=RemoveChild3DAt(parent,i4);if(child){removed.push(child);}});return removed;}function ReparentChildren3D(parent,newParent,param,endIndex){var beginIndex=param=== void 0?0:param;var moved=RemoveChildren3DBetween(parent,beginIndex,endIndex);SetParent3D.apply(void 0,[newParent].concat(swcHelpers.toConsumableArray(moved)));moved.forEach(function(child){});return moved;}function ReplaceChild3D(target,source){var targetParent=target.parent;var sourceParent=source.parent;var targetIndex=GetChild3DIndex(targetParent,target);if(targetParent===sourceParent){MoveChild3DTo(targetParent,source,targetIndex);RemoveChild3D(targetParent,target);}else{RemoveChild3D(targetParent,target);RemoveChild3D(sourceParent,source);AddChild3DAt(targetParent,targetIndex,source);}return target;}function SetChildren3DValue(parent,property,value){var children=DepthFirstSearch3D(parent);children.forEach(function(child){var descriptor=Object.getOwnPropertyDescriptor(child,property);if(descriptor){descriptor.set(value);}});return children;}function SwapChildren3D(child1,child2){if(child1.parent===child2.parent){var children=child1.parent.children;var index1=GetChild3DIndex(child1.parent,child1);var index2=GetChild3DIndex(child2.parent,child2);if(index1!==index2){children[index1]=child2;children[index2]=child1;}}}var events_exports={};__export(events_exports,{ClearEvent:function(){return ClearEvent;},Emit:function(){return Emit;},EventEmitter:function(){return EventEmitter;},EventInstance:function(){return EventInstance;},GetEventNames:function(){return GetEventNames;},GetListenerCount:function(){return GetListenerCount;},GetListeners:function(){return GetListeners;},Off:function(){return Off;},On:function(){return On;},Once:function(){return Once;},RemoveAllListeners:function(){return RemoveAllListeners;}});function ClearEvent(emitter,event){emitter.events.delete(event);return emitter;}var EventEmitter=function _class2(){"use strict";swcHelpers.classCallCheck(this,_class2);this.events=new Map();};var EventInstance=function _class1(callback,context,param){"use strict";var once=param=== void 0?false:param;swcHelpers.classCallCheck(this,_class1);this.callback=callback;this.context=context;this.once=once;};function GetEventNames(emitter){return [].concat(emitter.events.keys());}function GetListenerCount(emitter,event){var listeners=emitter.events.get(event);return listeners?listeners.size:0;}function GetListeners(emitter,event){var out=[];var listeners=emitter.events.get(event);listeners.forEach(function(listener){out.push(listener.callback);});return out;}function Off(emitter,event,callback,context,once){var events=emitter.events;var listeners=events.get(event);if(!callback){events.delete(event);}else if(swcHelpers._instanceof(callback,EventInstance)){listeners.delete(callback);}else{var hasContext=!context;var hasOnce=once!== void 0;for(var _i=0;_i<listeners.length;_i++){var listener=listeners[_i];if(listener.callback===callback&&hasContext&&listener.context===context&&hasOnce&&listener.once===once){listeners.delete(listener);}}}if(listeners.size===0){events.delete(event);}return emitter;}function On(emitter,event,callback,param,param1){var context=param=== void 0?emitter:param,once=param1=== void 0?false:param1;if(typeof callback!=="function"){throw new TypeError("Listener not a function");}var listener=new EventInstance(callback,context,once);var listeners=emitter.events.get(event);if(!listeners){emitter.events.set(event,new Set([listener]));}else{listeners.add(listener);}return listener;}function Once(emitter,event,callback,param){var context=param=== void 0?emitter:param;return On(emitter,event,callback,context,true);}function RemoveAllListeners(emitter,event){if(!event){emitter.events.clear();}else{emitter.events.delete(event);}}var gameobjects_exports={};__export(gameobjects_exports,{AnimatedSprite:function(){return AnimatedSprite;},Components:function(){return components_exports;},Container:function(){return Container;},EffectLayer:function(){return EffectLayer;},GameObject:function(){return GameObject;},Layer:function(){return Layer;},Rectangle:function(){return Rectangle2;},RenderLayer:function(){return RenderLayer;},Sprite:function(){return Sprite;},SpriteBatch:function(){return SpriteBatch;},Text:function(){return Text1;}});var components_exports={};__export(components_exports,{Bounds:function(){return bounds_exports;},Input:function(){return input_exports;},Transform:function(){return transform_exports;},Vertex:function(){return Vertex;}});var bounds_exports={};__export(bounds_exports,{BoundsComponent:function(){return BoundsComponent;}});function GetVertices(transform){var _world=transform.world,a=_world.a,b=_world.b,c=_world.c,d=_world.d,tx=_world.tx,ty=_world.ty;var _extent=transform.extent,x=_extent.x,y=_extent.y,right=_extent.right,bottom=_extent.bottom;var x0=x*a+y*c+tx;var y0=x*b+y*d+ty;var x1=x*a+bottom*c+tx;var y1=x*b+bottom*d+ty;var x2=right*a+bottom*c+tx;var y2=right*b+bottom*d+ty;var x3=right*a+y*c+tx;var y3=right*b+y*d+ty;return {x0:x0,y0:y0,x1:x1,y1:y1,x2:x2,y2:y2,x3:x3,y3:y3};}var BoundsComponent=function(){"use strict";function _class2(entity){swcHelpers.classCallCheck(this,_class2);this.fixed=false;this.includeChildren=true;this.visibleOnly=true;this.entity=entity;this.area=new Rectangle();}swcHelpers.createClass(_class2,[{key:"set",value:function set(x,y,width,height){this.area.set(x,y,width,height);}},{key:"get",value:function get(){if(this.entity.isDirty(DIRTY_CONST.BOUNDS)&& !this.fixed){this.update();}return this.area;}},{key:"updateLocal",value:function updateLocal(){var ref=GetVertices(this.entity.transform),x0=ref.x0,y0=ref.y0,x1=ref.x1,y1=ref.y1,x2=ref.x2,y2=ref.y2,x3=ref.x3,y3=ref.y3;var x=Math.min(x0,x1,x2,x3);var y=Math.min(y0,y1,y2,y3);var right=Math.max(x0,x1,x2,x3);var bottom=Math.max(y0,y1,y2,y3);return this.area.set(x,y,right-x,bottom-y);}},{key:"update",value:function update(){var bounds=this.updateLocal();this.entity.clearDirty(DIRTY_CONST.BOUNDS);if(!this.includeChildren|| !this.entity.numChildren){return bounds;}var visibleOnly=this.visibleOnly;var children=this.entity.children;var x=bounds.x;var y=bounds.y;var right=bounds.right;var bottom=bounds.bottom;for(var i4=0;i4<children.length;i4++){var child=children[i4];if(!child||visibleOnly&& !child.visible){continue;}var childBounds=child.bounds.get();if(childBounds.x<x){x=childBounds.x;}if(childBounds.y<y){y=childBounds.y;}if(childBounds.right>right){right=childBounds.right;}if(childBounds.bottom>bottom){bottom=childBounds.bottom;}}return bounds.set(x,y,right-x,bottom-y);}},{key:"destroy",value:function destroy(){this.entity=null;this.area=null;}}]);return _class2;}();var input_exports={};__export(input_exports,{InputComponent:function(){return InputComponent;}});var InputComponent=function(){"use strict";function _class2(entity){swcHelpers.classCallCheck(this,_class2);this.enabled=false;this.enabledChildren=true;this.entity=entity;}swcHelpers.createClass(_class2,[{key:"destroy",value:function destroy(){this.entity=null;this.hitArea=null;}}]);return _class2;}();var transform_exports={};__export(transform_exports,{GetVertices:function(){return GetVertices;},GetVerticesFromValues:function(){return GetVerticesFromValues;},PreRenderVertices:function(){return PreRenderVertices;},TransformComponent:function(){return TransformComponent;},UpdateLocalTransform:function(){return UpdateLocalTransform;},UpdateVertices:function(){return UpdateVertices;},UpdateWorldTransform:function(){return UpdateWorldTransform;}});function GetVerticesFromValues(left,right,top,bottom,x,y,param,param1,param2,param3,param4){var rotation=param=== void 0?0:param,scaleX=param1=== void 0?1:param1,scaleY=param2=== void 0?1:param2,skewX=param3=== void 0?0:param3,skewY=param4=== void 0?0:param4;var a=Math.cos(rotation+skewY)*scaleX;var b=Math.sin(rotation+skewY)*scaleX;var c=-Math.sin(rotation-skewX)*scaleY;var d=Math.cos(rotation-skewX)*scaleY;var x0=left*a+top*c+x;var y0=left*b+top*d+y;var x1=left*a+bottom*c+x;var y1=left*b+bottom*d+y;var x2=right*a+bottom*c+x;var y2=right*b+bottom*d+y;var x3=right*a+top*c+x;var y3=right*b+top*d+y;return {x0:x0,y0:y0,x1:x1,y1:y1,x2:x2,y2:y2,x3:x3,y3:y3};}function PackColors(vertices){vertices.forEach(function(vertex){vertex.packColor();});}function UpdateVertices(gameObject){var vertices=gameObject.vertices;var ref=GetVertices(gameObject.transform),x0=ref.x0,y0=ref.y0,x1=ref.x1,y1=ref.y1,x2=ref.x2,y2=ref.y2,x3=ref.x3,y3=ref.y3;vertices[0].setPosition(x0,y0);vertices[1].setPosition(x1,y1);vertices[2].setPosition(x2,y2);vertices[3].setPosition(x3,y3);return gameObject;}function PreRenderVertices(gameObject){if(gameObject.isDirty(DIRTY_CONST.COLORS)){PackColors(gameObject.vertices);gameObject.clearDirty(DIRTY_CONST.COLORS);}if(gameObject.isDirty(DIRTY_CONST.TRANSFORM)){UpdateVertices(gameObject);gameObject.clearDirty(DIRTY_CONST.TRANSFORM);}return gameObject;}function GetDefaultOriginX(){return ConfigStore.get(CONFIG_DEFAULTS.DEFAULT_ORIGIN).x;}function GetDefaultOriginY(){return ConfigStore.get(CONFIG_DEFAULTS.DEFAULT_ORIGIN).y;}var rectangle_exports={};__export(rectangle_exports,{CeilRectangle:function(){return CeilRectangle;},CeilRectanglePosition:function(){return CeilRectanglePosition;},CenterRectangleOn:function(){return CenterRectangleOn;},CloneRectangle:function(){return CloneRectangle;},CopyRectangleFrom:function(){return CopyRectangleFrom;},DecomposeRectangle:function(){return DecomposeRectangle;},FitRectangleInside:function(){return FitRectangleInside;},FitRectangleOutside:function(){return FitRectangleOutside;},FitRectangleToPoint:function(){return FitRectangleToPoint;},FitRectangleToPoints:function(){return FitRectangleToPoints;},FloorRectangle:function(){return FloorRectangle;},FloorRectanglePosition:function(){return FloorRectanglePosition;},GetRectangleArea:function(){return GetRectangleArea;},GetRectangleAspectRatio:function(){return GetRectangleAspectRatio;},GetRectangleCenter:function(){return GetRectangleCenter;},GetRectangleCenterX:function(){return GetRectangleCenterX;},GetRectangleCenterY:function(){return GetRectangleCenterY;},GetRectangleEdges:function(){return GetRectangleEdges;},GetRectangleIntersection:function(){return GetRectangleIntersection;},GetRectangleMarchingAnts:function(){return GetRectangleMarchingAnts;},GetRectangleOverlap:function(){return GetRectangleOverlap;},GetRectanglePerimeter:function(){return GetRectanglePerimeter;},GetRectanglePerimeterPoint:function(){return GetRectanglePerimeterPoint;},GetRectanglePoint:function(){return GetRectanglePoint;},GetRectanglePoints:function(){return GetRectanglePoints;},GetRectangleRandomPoint:function(){return GetRectangleRandomPoint;},GetRectangleRandomPointOutside:function(){return GetRectangleRandomPointOutside;},GetRectangleSize:function(){return GetRectangleSize;},GetRectangleUnion:function(){return GetRectangleUnion;},InflateRectangle:function(){return InflateRectangle;},MergeRectangle:function(){return MergeRectangle;},Rectangle:function(){return Rectangle;},RectangleContains:function(){return RectangleContains;},RectangleContainsPoint:function(){return RectangleContainsPoint;},RectangleContainsRectangle:function(){return RectangleContainsRectangle;},RectangleEquals:function(){return RectangleEquals;},RectangleFromPoints:function(){return RectangleFromPoints;},RectangleSizeEquals:function(){return RectangleSizeEquals;},ScaleRectangle:function(){return ScaleRectangle;},TranslateRectangle:function(){return TranslateRectangle;},TranslateRectanglePoint:function(){return TranslateRectanglePoint;}});function CeilRectangle(rect){rect.x=Math.ceil(rect.x);rect.y=Math.ceil(rect.y);rect.width=Math.ceil(rect.width);rect.height=Math.ceil(rect.height);return rect;}function CeilRectanglePosition(rect){rect.x=Math.ceil(rect.x);rect.y=Math.ceil(rect.y);return rect;}function CenterRectangleOn(rect,x,y){rect.x=x-rect.width/2;rect.y=y-rect.height/2;return rect;}function CloneRectangle(source){return new Rectangle(source.x,source.y,source.width,source.height);}function CopyRectangleFrom(source,dest){return dest.set(source.x,source.y,source.width,source.height);}function DecomposeRectangle(rect,param){var out=param=== void 0?[]:param;out.push(new Vec2(rect.x,rect.y),new Vec2(rect.right,rect.y),new Vec2(rect.right,rect.bottom),new Vec2(rect.x,rect.bottom));return out;}function GetRectangleAspectRatio(rect){return rect.height===0?NaN:rect.width/rect.height;}function GetRectangleCenterX(rect){return rect.x+rect.width/2;}function GetRectangleCenterY(rect){return rect.y+rect.height/2;}function FitRectangleInside(target,source){var ratio=GetRectangleAspectRatio(target);var width=source.width;var height=source.height;if(ratio<GetRectangleAspectRatio(source)){width=source.height*ratio;}else{height=source.width/ratio;}return target.set(GetRectangleCenterX(source)-target.width/2,GetRectangleCenterY(source)-target.height/2,width,height);}function FitRectangleOutside(target,source){var ratio=GetRectangleAspectRatio(target);var width=source.width;var height=source.height;if(ratio>GetRectangleAspectRatio(source)){width=source.height*ratio;}else{height=source.width/ratio;}return target.set(GetRectangleCenterX(source)-target.width/2,GetRectangleCenterY(source)-target.height/2,width,height);}function FitRectangleToPoint(target,x,y){var minX=Math.min(target.x,x);var maxX=Math.max(target.right,x);var minY=Math.min(target.y,y);var maxY=Math.max(target.bottom,y);return target.set(minX,minY,maxX-minX,maxY-minY);}function FitRectangleToPoints(target,points){var minX=target.x;var maxX=target.right;var minY=target.y;var maxY=target.bottom;for(var i4=0;i4<points.length;i4++){minX=Math.min(minX,points[i4].x);maxX=Math.max(maxX,points[i4].x);minY=Math.min(minY,points[i4].y);maxY=Math.max(maxY,points[i4].y);}return target.set(minX,minY,maxX-minX,maxY-minY);}function FloorRectangle(rect){rect.x=Math.floor(rect.x);rect.y=Math.floor(rect.y);rect.width=Math.floor(rect.width);rect.height=Math.floor(rect.height);return rect;}function FloorRectanglePosition(rect){rect.x=Math.floor(rect.x);rect.y=Math.floor(rect.y);return rect;}function GetRectangleArea(rect){return rect.width*rect.height;}function GetRectangleCenter(rect,param){var out=param=== void 0?new Vec2():param;return out.set(GetRectangleCenterX(rect),GetRectangleCenterY(rect));}var Line=function(){"use strict";function _class2(param,param1,param2,param3){var x1=param=== void 0?0:param,y1=param1=== void 0?0:param1,x2=param2=== void 0?0:param2,y2=param3=== void 0?0:param3;swcHelpers.classCallCheck(this,_class2);this.set(x1,y1,x2,y2);}swcHelpers.createClass(_class2,[{key:"set",value:function set(param,param1,param2,param3){var x1=param=== void 0?0:param,y1=param1=== void 0?0:param1,x2=param2=== void 0?0:param2,y2=param3=== void 0?0:param3;this.x1=x1;this.y1=y1;this.x2=x2;this.y2=y2;return this;}},{key:"left",get:function get(){return Math.min(this.x1,this.x2);},set:function set(value){if(this.x1<=this.x2){this.x1=value;}else{this.x2=value;}}},{key:"right",get:function get(){return Math.max(this.x1,this.x2);},set:function set(value){if(this.x1>this.x2){this.x1=value;}else{this.x2=value;}}},{key:"top",get:function get(){return Math.min(this.y1,this.y2);},set:function set(value){if(this.y1<=this.y2){this.y1=value;}else{this.y2=value;}}},{key:"bottom",get:function get(){return Math.max(this.y1,this.y2);},set:function set(value){if(this.y1>this.y2){this.y1=value;}else{this.y2=value;}}}]);return _class2;}();function GetRectangleEdges(rectangle){var x=rectangle.x,y=rectangle.y,right=rectangle.right,bottom=rectangle.bottom;var line1=new Line(x,y,right,y);var line2=new Line(right,y,right,bottom);var line3=new Line(right,bottom,x,bottom);var line4=new Line(x,bottom,x,y);return [line1,line2,line3,line4];}function GetRectangleIntersection(rectA,rectB,param){var out=param=== void 0?new Rectangle():param;if(RectangleToRectangle(rectA,rectB)){out.set(Math.max(rectA.x,rectB.x),Math.max(rectA.y,rectB.y),Math.min(rectA.right,rectB.right)-out.x,Math.min(rectA.bottom,rectB.bottom)-out.y);}else{out.set();}return out;}function GetRectanglePerimeter(rect){return 2*(rect.width+rect.height);}function GetRectangleMarchingAnts(rect,step,quantity,param){var out=param=== void 0?[]:param;if(!step&& !quantity){return out;}if(!step){step=GetRectanglePerimeter(rect)/quantity;}else{quantity=Math.round(GetRectanglePerimeter(rect)/step);}var x=rect.x;var y=rect.y;var face=0;for(var i4=0;i4<quantity;i4++){out.push(new Vec2(x,y));switch(face){case 0:x+=step;if(x>=rect.right){face=1;y+=x-rect.right;x=rect.right;}break;case 1:y+=step;if(y>=rect.bottom){face=2;x-=y-rect.bottom;y=rect.bottom;}break;case 2:x-=step;if(x<=rect.x){face=3;y-=rect.x-x;x=rect.x;}break;case 3:y-=step;if(y<=rect.y){face=0;y=rect.y;}break;}}return out;}function GetRectangleOverlap(rectA,rectB){return rectA.x<rectB.right&&rectA.right>rectB.x&&rectA.y<rectB.bottom&&rectA.bottom>rectB.y;}function GetRectanglePerimeterPoint(rectangle,angle,param){var out=param=== void 0?new Vec2():param;angle=DegToRad(angle);var s=Math.sin(angle);var c=Math.cos(angle);var dx=c>0?rectangle.width/2:rectangle.width/ -2;var dy=s>0?rectangle.height/2:rectangle.height/ -2;if(Math.abs(dx*s)<Math.abs(dy*c)){dy=dx*s/c;}else{dx=dy*c/s;}return out.set(dx+GetRectangleCenterX(rectangle),dy+GetRectangleCenterY(rectangle));}function GetRectanglePoint(rectangle,position,param){var out=param=== void 0?new Vec2():param;if(position<=0||position>=1){return out.set(rectangle.x,rectangle.y);}var p=GetRectanglePerimeter(rectangle)*position;if(position>0.5){p-=rectangle.width+rectangle.height;if(p<=rectangle.width){return out.set(rectangle.right-p,rectangle.bottom);}else{return out.set(rectangle.x,rectangle.bottom-(p-rectangle.width));}}else if(p<=rectangle.width){return out.set(rectangle.x+p,rectangle.y);}else{return out.set(rectangle.right,rectangle.y+(p-rectangle.width));}}function GetRectanglePoints(rectangle,step,param,param1){var quantity=param=== void 0?0:param,out=param1=== void 0?[]:param1;if(!quantity){quantity=GetRectanglePerimeter(rectangle)/step;}for(var i4=0;i4<quantity;i4++){out.push(GetRectanglePoint(rectangle,i4/quantity));}return out;}function GetRectangleRandomPoint(rect,param){var out=param=== void 0?new Vec2():param;return out.set(rect.x+Math.random()*rect.width,rect.y+Math.random()*rect.height);}function RectangleContainsRectangle(rectA,rectB){if(rectB.width*rectB.height>rectA.width*rectA.height){return false;}return rectB.x>rectA.x&&rectB.x<rectA.right&&rectB.right>rectA.x&&rectB.right<rectA.right&&rectB.y>rectA.y&&rectB.y<rectA.bottom&&rectB.bottom>rectA.y&&rectB.bottom<rectA.bottom;}function GetRectangleRandomPointOutside(outer,inner,param){var out=param=== void 0?new Vec2():param;if(RectangleContainsRectangle(outer,inner)){switch(Between(0,3)){case 0:out.x=outer.x+Math.random()*(inner.right-outer.x);out.y=outer.y+Math.random()*(inner.y-outer.y);break;case 1:out.x=inner.x+Math.random()*(outer.right-inner.x);out.y=inner.bottom+Math.random()*(outer.bottom-inner.bottom);break;case 2:out.x=outer.x+Math.random()*(inner.x-outer.x);out.y=inner.y+Math.random()*(outer.bottom-inner.y);break;case 3:out.x=inner.right+Math.random()*(outer.right-inner.right);out.y=outer.y+Math.random()*(inner.bottom-outer.y);break;}}return out;}function GetRectangleSize(rect,param){var out=param=== void 0?new Vec2():param;return out.set(rect.width,rect.height);}function GetRectangleUnion(rectA,rectB,param){var out=param=== void 0?new Rectangle():param;var x=Math.min(rectA.x,rectB.x);var y=Math.min(rectA.y,rectB.y);var w=Math.max(rectA.right,rectB.right)-x;var h=Math.max(rectA.bottom,rectB.bottom)-y;return out.set(x,y,w,h);}function InflateRectangle(rect,x,y){var cx=GetRectangleCenterX(rect);var cy=GetRectangleCenterY(rect);rect.width=rect.width+x*2;rect.height=rect.height+y*2;return CenterRectangleOn(rect,cx,cy);}function MergeRectangle(target,source){var minX=Math.min(target.x,source.x);var maxX=Math.max(target.right,source.right);var minY=Math.min(target.y,source.y);var maxY=Math.max(target.bottom,source.bottom);return target.set(minX,minY,maxX-minX,maxY-minY);}function RectangleContainsPoint(rect,point){return RectangleContains(rect,point.x,point.y);}function RectangleEquals(rect,toCompare){return rect.x===toCompare.x&&rect.y===toCompare.y&&rect.width===toCompare.width&&rect.height===toCompare.height;}function RectangleFromPoints(points,param){var out=param=== void 0?new Rectangle():param;if(points.length===0){return out;}var minX=Number.MAX_VALUE;var minY=Number.MAX_VALUE;var maxX=MATH_CONST.MIN_SAFE_INTEGER;var maxY=MATH_CONST.MIN_SAFE_INTEGER;for(var i4=0;i4<points.length;i4++){var px=points[i4].x;var py=points[i4].y;minX=Math.min(minX,px);minY=Math.min(minY,py);maxX=Math.max(maxX,px);maxY=Math.max(maxY,py);}return out.set(minX,minY,maxX-minX,maxY-minY);}function RectangleSizeEquals(rect,toCompare){return rect.width===toCompare.width&&rect.height===toCompare.height;}function ScaleRectangle(rect,x,param){var y=param=== void 0?x:param;rect.width*=x;rect.height*=y;return rect;}function TranslateRectangle(rect,x,y){rect.x+=x;rect.y+=y;return rect;}function TranslateRectanglePoint(rect,point){rect.x+=point.x;rect.y+=point.y;return rect;}function UpdateLocalTransform(transform){var local=transform.local;var x=transform.position.x;var y=transform.position.y;var rotation=transform.rotation;var scaleX=transform.scale.x;var scaleY=transform.scale.y;var skewX=transform.skew.x;var skewY=transform.skew.y;local.set(Math.cos(rotation+skewY)*scaleX,Math.sin(rotation+skewY)*scaleX,-Math.sin(rotation-skewX)*scaleY,Math.cos(rotation-skewX)*scaleY,x,y);}function UpdateWorldTransform(gameObject){var parent=gameObject.parent;var transform=gameObject.transform;var lt=transform.local;var wt=transform.world;if(!parent){Mat2dCopyFrom(lt,wt);}else if(transform.passthru){Mat2dCopyFrom(parent.transform.world,wt);}else{var a=lt.a,b=lt.b,c=lt.c,d=lt.d,tx=lt.tx,ty=lt.ty;var _world=parent.transform.world,pa=_world.a,pb=_world.b,pc=_world.c,pd=_world.d,ptx=_world.tx,pty=_world.ty;wt.set(a*pa+b*pc,a*pb+b*pd,c*pa+d*pc,c*pb+d*pd,tx*pa+ty*pc+ptx,tx*pb+ty*pd+pty);}}var TransformComponent=function(){"use strict";function _class2(entity,param,param1){var x=param=== void 0?0:param,y=param1=== void 0?0:param1;swcHelpers.classCallCheck(this,_class2);this.passthru=false;this._rotation=0;this.entity=entity;this.local=new Matrix2D();this.world=new Matrix2D();var update=(function(){return this.update();}).bind(this);var updateExtent=(function(){return this.updateExtent();}).bind(this);this.position=new Vec2Callback(update,x,y);this.scale=new Vec2Callback(update,1,1);this.skew=new Vec2Callback(update);this.origin=new Vec2Callback(updateExtent,GetDefaultOriginX(),GetDefaultOriginY());this.extent=new Rectangle();}swcHelpers.createClass(_class2,[{key:"update",value:function update(){this.updateLocal();this.updateWorld();}},{key:"updateLocal",value:function updateLocal(){this.entity.setDirty(DIRTY_CONST.TRANSFORM,DIRTY_CONST.BOUNDS);UpdateLocalTransform(this);}},{key:"updateWorld",value:function updateWorld(){var entity=this.entity;entity.setDirty(DIRTY_CONST.TRANSFORM,DIRTY_CONST.BOUNDS);UpdateWorldTransform(entity);if(entity.numChildren){this.updateChildren();}}},{key:"updateChildren",value:function updateChildren(){var children=this.entity.children;for(var i4=0;i4<children.length;i4++){var child=children[i4];child.transform.updateWorld();}}},{key:"globalToLocal",value:function globalToLocal(x,y,param){var out=param=== void 0?new Vec2():param;var _world=this.world,a=_world.a,b=_world.b,c=_world.c,d=_world.d,tx=_world.tx,ty=_world.ty;var id=1/(a*d+c* -b);out.x=d*id*x+-c*id*y+(ty*c-tx*d)*id;out.y=a*id*y+-b*id*x+(-ty*a+tx*b)*id;return out;}},{key:"localToGlobal",value:function localToGlobal(x,y,param){var out=param=== void 0?new Vec2():param;var _world=this.world,a=_world.a,b=_world.b,c=_world.c,d=_world.d,tx=_world.tx,ty=_world.ty;out.x=a*x+c*y+tx;out.y=b*x+d*y+ty;return out;}},{key:"setExtent",value:function setExtent(x,y,width,height){this.extent.set(x,y,width,height);this.entity.setDirty(DIRTY_CONST.TRANSFORM,DIRTY_CONST.BOUNDS);}},{key:"updateExtent",value:function updateExtent(width,height){var extent=this.extent;var entity=this.entity;if(width!== void 0){extent.width=width;}if(height!== void 0){extent.height=height;}extent.x=-this.origin.x*extent.width;extent.y=-this.origin.y*extent.height;entity.setDirty(DIRTY_CONST.TRANSFORM,DIRTY_CONST.BOUNDS);}},{key:"rotation",get:function get(){return this._rotation;},set:function set(value){if(value!==this._rotation){this._rotation=value;this.update();}}},{key:"destroy",value:function destroy(){this.position.destroy();this.scale.destroy();this.skew.destroy();this.origin.destroy();this.entity=null;this.local=null;this.world=null;this.position=null;this.scale=null;this.skew=null;this.origin=null;this.extent=null;}}]);return _class2;}();function PackColor(rgb,alpha){var ua=(alpha*255|0)&255;return (ua<<24|rgb)>>>0;}var Vertex=function(){"use strict";function _class2(param,param1,param2){var x=param=== void 0?0:param,y=param1=== void 0?0:param1,z=param2=== void 0?0:param2;swcHelpers.classCallCheck(this,_class2);this.x=0;this.y=0;this.z=0;this.u=0;this.v=0;this.texture=0;this.tint=16777215;this.alpha=1;this.color=4294967295;this.x=x;this.y=y;this.z=z;}swcHelpers.createClass(_class2,[{key:"setPosition",value:function setPosition(x,y,param){var z=param=== void 0?0:param;this.x=x;this.y=y;this.z=z;return this;}},{key:"setUV",value:function setUV(u,v){this.u=u;this.v=v;return this;}},{key:"setColor",value:function setColor(color,param){var alpha=param=== void 0?1:param;this.tint=color;this.alpha=alpha;this.packColor();return this;}},{key:"setAlpha",value:function setAlpha(value){this.alpha=value;return this;}},{key:"setTint",value:function setTint(value){this.tint=value;return this;}},{key:"packColor",value:function packColor(){this.color=PackColor(this.tint,this.alpha);}}]);return _class2;}();function BatchTexturedQuad(texture,vertices,renderPass){var ref=GetVertexBufferEntry(renderPass,1),F32=ref.F32,U32=ref.U32,offset=ref.offset;var textureIndex=SetTexture(renderPass,texture);var vertOffset=offset;vertices.forEach(function(vertex){F32[vertOffset+0]=vertex.x;F32[vertOffset+1]=vertex.y;F32[vertOffset+2]=vertex.u;F32[vertOffset+3]=vertex.v;F32[vertOffset+4]=textureIndex;U32[vertOffset+5]=vertex.color;vertOffset+=6;});}var GameObject=function(){"use strict";function _class2(param,param1){var x=param=== void 0?0:param,y=param1=== void 0?0:param1;swcHelpers.classCallCheck(this,_class2);this.type="GameObject";this.name="";this.willUpdate=true;this.willUpdateChildren=true;this.willRender=true;this.willRenderChildren=true;this.willCacheChildren=false;this.dirty=0;this.dirtyFrame=0;this.visible=true;this.children=[];this.vertices=[];this.events=new Map();this.transform=new TransformComponent(this,x,y);this.bounds=new BoundsComponent(this);this.input=new InputComponent(this);this.dirty=DIRTY_CONST.DEFAULT;this.transform.update();}swcHelpers.createClass(_class2,[{key:"isRenderable",value:function isRenderable(){return this.visible&&this.willRender;}},{key:"isDirty",value:function isDirty(flag){return (this.dirty&flag)!==0;}},{key:"clearDirty",value:function clearDirty(flag){if(this.isDirty(flag)){this.dirty^=flag;}return this;}},{key:"setDirty",value:function setDirty(flag,flag2){if(!this.isDirty(flag)){this.dirty^=flag;this.dirtyFrame=GameInstance.getFrame();}if(!this.isDirty(flag2)){this.dirty^=flag2;}return this;}},{key:"update",value:function update(delta,time){if(this.willUpdateChildren){var children=this.children;for(var i4=0;i4<children.length;i4++){var child=children[i4];if(child&&child.willUpdate){child.update(delta,time);}}}this.postUpdate(delta,time);}},{key:"postUpdate",value:function postUpdate(delta,time){}},{key:"renderGL",value:function renderGL(renderPass){}},{key:"renderCanvas",value:function renderCanvas(renderer){}},{key:"postRenderGL",value:function postRenderGL(renderPass){}},{key:"postRenderCanvas",value:function postRenderCanvas(renderer){}},{key:"numChildren",get:function get(){return this.children.length;}},{key:"getBounds",value:function getBounds(){return this.bounds.get();}},{key:"destroy",value:function destroy(reparentChildren){if(reparentChildren){ReparentChildren(this,reparentChildren);}else{DestroyChildren(this);}Emit(this,DestroyEvent,this);this.transform.destroy();this.bounds.destroy();this.input.destroy();this.events.clear();this.world=null;this.parent=null;this.children=null;this.vertices=[];}}]);return _class2;}();var Container=function(GameObject1){"use strict";swcHelpers.inherits(_class3,GameObject1);function _class3(param,param1){var x=param=== void 0?0:param,y=param1=== void 0?0:param1;swcHelpers.classCallCheck(this,_class3);var _this;_this=swcHelpers.possibleConstructorReturn(this,swcHelpers.getPrototypeOf(_class3).call(this,x,y));_this._alpha=1;_this.type="Container";return _this;}swcHelpers.createClass(_class3,[{key:"setSize",value:function setSize(width,param){var height=param=== void 0?width:param;this.transform.updateExtent(width,height);return this;}},{key:"getSize",value:function getSize(param){var out=param=== void 0?new Vec2():param;return GetRectangleSize(this.transform.extent,out);}},{key:"setPosition",value:function setPosition(x,y){this.transform.position.set(x,y);return this;}},{key:"getPosition",value:function getPosition(param){var out=param=== void 0?new Vec2():param;var position=this.transform.position;return out.set(position.x,position.y);}},{key:"setOrigin",value:function setOrigin(x,param){var y=param=== void 0?x:param;this.transform.origin.set(x,y);return this;}},{key:"getOrigin",value:function getOrigin(param){var out=param=== void 0?new Vec2():param;var origin=this.transform.origin;return out.set(origin.x,origin.y);}},{key:"setSkew",value:function setSkew(x,param){var y=param=== void 0?x:param;this.transform.skew.set(x,y);return this;}},{key:"getSkew",value:function getSkew(param){var out=param=== void 0?new Vec2():param;var skew=this.transform.skew;return out.set(skew.x,skew.y);}},{key:"setScale",value:function setScale(x,param){var y=param=== void 0?x:param;this.transform.scale.set(x,y);return this;}},{key:"getScale",value:function getScale(param){var out=param=== void 0?new Vec2():param;var scale=this.transform.scale;return out.set(scale.x,scale.y);}},{key:"setRotation",value:function setRotation(value){this.transform.rotation=value;return this;}},{key:"getRotation",value:function getRotation(){return this.transform.rotation;}},{key:"width",get:function get(){return this.transform.extent.width;},set:function set(value){this.transform.updateExtent(value);}},{key:"height",get:function get(){return this.transform.extent.height;},set:function set(value){this.transform.updateExtent(void 0,value);}},{key:"x",get:function get(){return this.transform.position.x;},set:function set(value){this.transform.position.x=value;}},{key:"y",get:function get(){return this.transform.position.y;},set:function set(value){this.transform.position.y=value;}},{key:"originX",get:function get(){return this.transform.origin.x;},set:function set(value){this.transform.origin.x=value;}},{key:"originY",get:function get(){return this.transform.origin.y;},set:function set(value){this.transform.origin.y=value;}},{key:"skewX",get:function get(){return this.transform.skew.x;},set:function set(value){this.transform.skew.x=value;}},{key:"skewY",get:function get(){return this.transform.skew.y;},set:function set(value){this.transform.skew.y=value;}},{key:"scaleX",get:function get(){return this.transform.scale.x;},set:function set(value){this.transform.scale.x=value;}},{key:"scaleY",get:function get(){return this.transform.scale.y;},set:function set(value){this.transform.scale.y=value;}},{key:"rotation",get:function get(){return this.transform.rotation;},set:function set(value){this.transform.rotation=value;}},{key:"alpha",get:function get(){return this._alpha;},set:function set(value){if(value!==this._alpha){this._alpha=value;this.vertices.forEach(function(vertex){vertex.setAlpha(value);});this.setDirty(DIRTY_CONST.COLORS);}}}]);return _class3;}(GameObject);function DrawTexturedQuad(frame2,alpha,transform,renderer){if(!frame2){return;}var ctx=renderer.ctx;var _world=transform.world,a=_world.a,b=_world.b,c=_world.c,d=_world.d,tx=_world.tx,ty=_world.ty;var _extent=transform.extent,x=_extent.x,y=_extent.y;ctx.save();ctx.setTransform(a,b,c,d,tx,ty);ctx.globalAlpha=alpha;ctx.drawImage(frame2.texture.image,frame2.x,frame2.y,frame2.width,frame2.height,x,y,frame2.width,frame2.height);ctx.restore();}function SetFrame(texture,key){for(var _len=arguments.length,children=new Array(_len>2?_len-2:0),_key=2;_key<_len;_key++){children[_key-2]=arguments[_key];}var frame2=texture.getFrame(key);var pivot=frame2.pivot;children.forEach(function(child){if(!child||frame2===child.frame){return;}child.frame=frame2;child.hasTexture=true;if(pivot){child.setOrigin(pivot.x,pivot.y);}frame2.copyToExtent(child);frame2.copyToVertices(child.vertices);});return children;}var instance3;var TextureManagerInstance={get:function(){return instance3;},set:function(manager){instance3=manager;}};function SetTexture2(key,frame2){for(var _len=arguments.length,children=new Array(_len>2?_len-2:0),_key=2;_key<_len;_key++){children[_key-2]=arguments[_key];}if(!key){children.forEach(function(child){child.texture=null;child.frame=null;child.hasTexture=false;});}else{var texture=void 0;if(swcHelpers._instanceof(key,Texture)){texture=key;}else{texture=TextureManagerInstance.get().get(key);}if(!texture){console.warn("Invalid Texture key: ".concat(key));}else{children.forEach(function(child){child.texture=texture;});SetFrame.apply(void 0,[texture,frame2].concat(swcHelpers.toConsumableArray(children)));}}return children;}var Sprite=function(Container1){"use strict";swcHelpers.inherits(_class3,Container1);function _class3(x,y,texture,frame2){swcHelpers.classCallCheck(this,_class3);var _this;_this=swcHelpers.possibleConstructorReturn(this,swcHelpers.getPrototypeOf(_class3).call(this,x,y));_this.hasTexture=false;_this._tint=16777215;_this.type="Sprite";_this.vertices=[new Vertex(),new Vertex(),new Vertex(),new Vertex()];_this.setTexture(texture,frame2);return _this;}swcHelpers.createClass(_class3,[{key:"setTexture",value:function setTexture(key,frame2){SetTexture2(key,frame2,this);return this;}},{key:"setFrame",value:function setFrame(key){SetFrame(this.texture,key,this);return this;}},{key:"isRenderable",value:function isRenderable(){return this.visible&&this.willRender&&this.hasTexture&&this.alpha>0;}},{key:"renderGL",value:function renderGL(renderPass){PreRenderVertices(this);BatchTexturedQuad(this.texture,this.vertices,renderPass);}},{key:"renderCanvas",value:function renderCanvas(renderer){PreRenderVertices(this);DrawTexturedQuad(this.frame,this.alpha,this.transform,renderer);}},{key:"tint",get:function get(){return this._tint;},set:function set(value){if(value!==this._tint){this._tint=value;this.vertices.forEach(function(vertex){vertex.setTint(value);});this.setDirty(DIRTY_CONST.COLORS);}}},{key:"destroy",value:function destroy(reparentChildren){swcHelpers.get(swcHelpers.getPrototypeOf(_class3.prototype),"destroy",this).call(this,reparentChildren);this.texture=null;this.frame=null;this.hasTexture=false;}}]);return _class3;}(Container);var AnimatedSprite=function(Sprite1){"use strict";swcHelpers.inherits(_class3,Sprite1);function _class3(x,y,texture,frame2){swcHelpers.classCallCheck(this,_class3);var _this;_this=swcHelpers.possibleConstructorReturn(this,swcHelpers.getPrototypeOf(_class3).call(this,x,y,texture,frame2));_this.type="AnimatedSprite";_this.anims=new Map();_this.animData={currentAnim:"",currentFrames:[],frameIndex:0,animSpeed:0,nextFrameTime:0,repeatCount:0,isPlaying:false,yoyo:false,pendingStart:false,playingForward:true,delay:0,repeatDelay:0,onStart:null,onRepeat:null,onComplete:null};return _this;}swcHelpers.createClass(_class3,[{key:"stop",value:function stop(){var data=this.animData;data.isPlaying=false;data.currentAnim="";if(data.onComplete){data.onComplete(this,data.currentAnim);}}},{key:"nextFrame",value:function nextFrame(){var data=this.animData;data.frameIndex++;if(data.frameIndex===data.currentFrames.length){if(data.yoyo){data.frameIndex--;data.playingForward=false;}else if(data.repeatCount=== -1||data.repeatCount>0){data.frameIndex=0;if(data.repeatCount!== -1){data.repeatCount--;}if(data.onRepeat){data.onRepeat(this,data.currentAnim);}data.nextFrameTime+=data.repeatDelay;}else{data.frameIndex--;return this.stop();}}this.setFrame(data.currentFrames[data.frameIndex]);data.nextFrameTime+=data.animSpeed;}},{key:"prevFrame",value:function prevFrame(){var data=this.animData;data.frameIndex--;if(data.frameIndex=== -1){if(data.repeatCount=== -1||data.repeatCount>0){data.frameIndex=0;data.playingForward=true;if(data.repeatCount!== -1){data.repeatCount--;}if(data.onRepeat){data.onRepeat(this,data.currentAnim);}data.nextFrameTime+=data.repeatDelay;}else{data.frameIndex=0;return this.stop();}}this.setFrame(data.currentFrames[data.frameIndex]);data.nextFrameTime+=data.animSpeed;}},{key:"update",value:function update(delta,now){swcHelpers.get(swcHelpers.getPrototypeOf(_class3.prototype),"update",this).call(this,delta,now);var data=this.animData;if(!data.isPlaying){return;}data.nextFrameTime-=delta*1000;data.nextFrameTime=Math.max(data.nextFrameTime,0);if(data.nextFrameTime===0){if(data.pendingStart){if(data.onStart){data.onStart(this,data.currentAnim);}data.pendingStart=false;data.nextFrameTime=data.animSpeed;}else if(data.playingForward){this.nextFrame();}else{this.prevFrame();}}}},{key:"isPlaying",get:function get(){return this.animData.isPlaying;}},{key:"isPlayingForward",get:function get(){return this.animData.isPlaying&&this.animData.playingForward;}},{key:"currentAnimation",get:function get(){return this.animData.currentAnim;}},{key:"destroy",value:function destroy(reparentChildren){swcHelpers.get(swcHelpers.getPrototypeOf(_class3.prototype),"destroy",this).call(this,reparentChildren);this.anims.clear();this.animData=null;}}]);return _class3;}(Sprite);function BatchSingleQuad(renderPass,x,y,width,height,u0,v0,u1,v1,param,param1){var textureIndex=param=== void 0?0:param,packedColor=param1=== void 0?4294967295:param1;var ref=GetVertexBufferEntry(renderPass,1),F32=ref.F32,U32=ref.U32,offset=ref.offset;F32[offset+0]=x;F32[offset+1]=y;F32[offset+2]=u0;F32[offset+3]=v1;F32[offset+4]=textureIndex;U32[offset+5]=packedColor;F32[offset+6]=x;F32[offset+7]=y+height;F32[offset+8]=u0;F32[offset+9]=v0;F32[offset+10]=textureIndex;U32[offset+11]=packedColor;F32[offset+12]=x+width;F32[offset+13]=y+height;F32[offset+14]=u1;F32[offset+15]=v0;F32[offset+16]=textureIndex;U32[offset+17]=packedColor;F32[offset+18]=x+width;F32[offset+19]=y;F32[offset+20]=u1;F32[offset+21]=v1;F32[offset+22]=textureIndex;U32[offset+23]=packedColor;}function DrawTexturedQuad2(renderPass,texture,shader){if(!shader){shader=renderPass.quadShader;}var _firstFrame=texture.firstFrame,u0=_firstFrame.u0,v0=_firstFrame.v0,u1=_firstFrame.u1,v1=_firstFrame.v1;BindTexture(texture,0);SetVertexBuffer(renderPass,renderPass.quadBuffer);SetShader(renderPass,shader,0);BatchSingleQuad(renderPass,0,0,texture.width,texture.height,u0,v0,u1,v1,0);Flush(renderPass);PopVertexBuffer(renderPass);PopShader(renderPass);UnbindTexture(renderPass);}var Layer=function(GameObject1){"use strict";swcHelpers.inherits(_class3,GameObject1);function _class3(){swcHelpers.classCallCheck(this,_class3);var _this;_this=swcHelpers.possibleConstructorReturn(this,swcHelpers.getPrototypeOf(_class3).call(this));_this.type="Layer";_this.transform.passthru=true;_this.willRender=false;return _this;}return _class3;}(GameObject);var RenderLayer=function(Layer1){"use strict";swcHelpers.inherits(_class3,Layer1);function _class3(){swcHelpers.classCallCheck(this,_class3);var _this;_this=swcHelpers.possibleConstructorReturn(this,swcHelpers.getPrototypeOf(_class3).call(this));_this.type="RenderLayer";_this.willRender=true;_this.willRenderChildren=true;_this.willCacheChildren=true;_this.setDirty(DIRTY_CONST.CHILD_CACHE);var width=GetWidth();var height=GetHeight();var resolution=GetResolution();var texture=new Texture(null,width*resolution,height*resolution);var binding=new GLTextureBinding(texture);texture.binding=binding;binding.framebuffer=CreateFramebuffer(binding.texture);_this.texture=texture;_this.framebuffer=binding.framebuffer;return _this;}swcHelpers.createClass(_class3,[{key:"renderGL",value:function renderGL(renderPass){if(this.numChildren>0){Flush(renderPass);if(!this.willCacheChildren||this.isDirty(DIRTY_CONST.CHILD_CACHE)){SetFramebuffer(renderPass,this.framebuffer,true);this.clearDirty(DIRTY_CONST.CHILD_CACHE);}else{SetFramebuffer(renderPass,this.framebuffer,false);this.postRenderGL(renderPass);}}}},{key:"postRenderGL",value:function postRenderGL(renderPass){Flush(renderPass);PopFramebuffer(renderPass);DrawTexturedQuad2(renderPass,this.texture);this.clearDirty(DIRTY_CONST.TRANSFORM);}}]);return _class3;}(Layer);var EffectLayer=function(RenderLayer1){"use strict";swcHelpers.inherits(_class3,RenderLayer1);function _class3(){for(var _len=arguments.length,shaders=new Array(_len),_key=0;_key<_len;_key++){shaders[_key]=arguments[_key];}swcHelpers.classCallCheck(this,_class3);var _this;_this=swcHelpers.possibleConstructorReturn(this,swcHelpers.getPrototypeOf(_class3).call(this));_this.shaders=[];_this.type="EffectLayer";if(Array.isArray(shaders)){_this.shaders=shaders;}return _this;}swcHelpers.createClass(_class3,[{key:"postRenderGL",value:function postRenderGL(renderPass){var shaders=this.shaders;var texture=this.texture;Flush(renderPass);PopFramebuffer(renderPass);if(shaders.length===0){DrawTexturedQuad2(renderPass,texture);}else{var prevTexture=texture;for(var i5=0;i5<shaders.length;i5++){var shader=shaders[i5];DrawTexturedQuad2(renderPass,prevTexture,shader);prevTexture=shader.texture;}DrawTexturedQuad2(renderPass,prevTexture);}this.clearDirty(DIRTY_CONST.TRANSFORM);}}]);return _class3;}(RenderLayer);var Rectangle2=function(Container1){"use strict";swcHelpers.inherits(_class3,Container1);function _class3(x,y,param,param1,param2){var width=param=== void 0?64:param,height=param1=== void 0?64:param1,color=param2=== void 0?16777215:param2;swcHelpers.classCallCheck(this,_class3);var _this;_this=swcHelpers.possibleConstructorReturn(this,swcHelpers.getPrototypeOf(_class3).call(this,x,y));_this._color=16777215;_this.type="Rectangle";_this.vertices=[new Vertex(),new Vertex(),new Vertex(),new Vertex()];_this.color=color;_this.setWhiteTexture();_this.setSize(width,height);return _this;}swcHelpers.createClass(_class3,[{key:"setWhiteTexture",value:function setWhiteTexture(){this.texture=TextureManagerInstance.get().get("__WHITE");this.frame=this.texture.getFrame();this.frame.copyToExtent(this);this.frame.copyToVertices(this.vertices);}},{key:"setColor",value:function setColor(color){this.color=color;return this;}},{key:"isRenderable",value:function isRenderable(){return this.visible&&this.willRender&&this.alpha>0;}},{key:"renderGL",value:function renderGL(renderPass){PreRenderVertices(this);BatchTexturedQuad(this.texture,this.vertices,renderPass);}},{key:"renderCanvas",value:function renderCanvas(renderer){PreRenderVertices(this);DrawTexturedQuad(this.frame,this.alpha,this.transform,renderer);}},{key:"color",get:function get(){return this._color;},set:function set(value){if(value!==this._color){this._color=value;this.vertices.forEach(function(vertex){vertex.setTint(value);});this.setDirty(DIRTY_CONST.COLORS);}}},{key:"destroy",value:function destroy(reparentChildren){swcHelpers.get(swcHelpers.getPrototypeOf(_class3.prototype),"destroy",this).call(this,reparentChildren);this.texture=null;this.frame=null;}}]);return _class3;}(Container);function BatchTexturedQuadBuffer(batch,renderPass){}var SpriteBatch=function(Layer1){"use strict";swcHelpers.inherits(_class3,Layer1);function _class3(maxSize,texture){swcHelpers.classCallCheck(this,_class3);var _this;_this=swcHelpers.possibleConstructorReturn(this,swcHelpers.getPrototypeOf(_class3).call(this));_this.glTextureIndex=0;_this.hasTexture=false;_this.type="SpriteBatch";_this.willRender=true;_this.setTexture(texture);_this.setMaxSize(maxSize);return _this;}swcHelpers.createClass(_class3,[{key:"resetBuffers",value:function resetBuffers(){var ibo=[];for(var i6=0;i6<this.maxSize*4;i6+=4){ibo.push(i6+0,i6+1,i6+2,i6+2,i6+3,i6+0);}this.data=new ArrayBuffer(this.maxSize*96);this.index=new Uint16Array(ibo);this.vertexViewF32=new Float32Array(this.data);this.vertexViewU32=new Uint32Array(this.data);if(gl){DeleteFramebuffer(this.vertexBuffer);DeleteFramebuffer(this.indexBuffer);this.vertexBuffer=gl.createBuffer();this.indexBuffer=gl.createBuffer();gl.bindBuffer(gl.ARRAY_BUFFER,this.vertexBuffer);gl.bufferData(gl.ARRAY_BUFFER,this.data,gl.STATIC_DRAW);gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,this.indexBuffer);gl.bufferData(gl.ELEMENT_ARRAY_BUFFER,this.index,gl.STATIC_DRAW);gl.bindBuffer(gl.ARRAY_BUFFER,null);}ibo=[];this.count=0;}},{key:"setMaxSize",value:function setMaxSize(value){this.maxSize=Clamp(value,0,65535);this.resetBuffers();return this;}},{key:"setTexture",value:function setTexture(key){var texture;if(swcHelpers._instanceof(key,Texture)){texture=key;}else{texture=TextureManagerInstance.get().get(key);}if(!texture){console.warn("Invalid Texture key: ".concat(key));}else{this.texture=texture;this.hasTexture=true;this.glTextureIndex=-1;}return this;}},{key:"isRenderable",value:function isRenderable(){return this.visible&&this.willRender&&this.hasTexture&&this.count>0;}},{key:"clear",value:function clear(){this.count=0;return this;}},{key:"addToBatch",value:function addToBatch(frame2,color,x0,y0,x1,y1,x2,y2,x3,y3){if(this.count>=this.maxSize){console.warn("SpriteBatch full");return this;}var u0=frame2.u0,u1=frame2.u1,v0=frame2.v0,v1=frame2.v1;var F32=this.vertexViewF32;var U32=this.vertexViewU32;var offset=this.count*24;var textureIndex=this.texture.binding?this.texture.binding.index:0;F32[offset+0]=x0;F32[offset+1]=y0;F32[offset+2]=u0;F32[offset+3]=v0;F32[offset+4]=textureIndex;U32[offset+5]=color;F32[offset+6]=x1;F32[offset+7]=y1;F32[offset+8]=u0;F32[offset+9]=v1;F32[offset+10]=textureIndex;U32[offset+11]=color;F32[offset+12]=x2;F32[offset+13]=y2;F32[offset+14]=u1;F32[offset+15]=v1;F32[offset+16]=textureIndex;U32[offset+17]=color;F32[offset+18]=x3;F32[offset+19]=y3;F32[offset+20]=u1;F32[offset+21]=v0;F32[offset+22]=textureIndex;U32[offset+23]=color;this.setDirty(DIRTY_CONST.TRANSFORM);this.count++;return this;}},{key:"add",value:function add(config){var tmp=config.frame,frame2=tmp=== void 0?null:tmp,_x=config.x,x=_x=== void 0?0:_x,_y=config.y,y=_y=== void 0?0:_y,_rotation=config.rotation,rotation=_rotation=== void 0?0:_rotation,_scaleX=config.scaleX,scaleX=_scaleX=== void 0?1:_scaleX,_scaleY=config.scaleY,scaleY=_scaleY=== void 0?1:_scaleY,_skewX=config.skewX,skewX=_skewX=== void 0?0:_skewX,_skewY=config.skewY,skewY=_skewY=== void 0?0:_skewY,_originX=config.originX,originX=_originX=== void 0?0:_originX,_originY=config.originY,originY=_originY=== void 0?0:_originY,_alpha=config.alpha,alpha=_alpha=== void 0?1:_alpha,_tint=config.tint,tint=_tint=== void 0?16777215:_tint;var textureFrame=this.texture.getFrame(frame2);var ref=textureFrame.getExtent(originX,originY),left=ref.left,right=ref.right,top=ref.top,bottom=ref.bottom;var ref1=GetVerticesFromValues(left,right,top,bottom,x,y,rotation,scaleX,scaleY,skewX,skewY),x0=ref1.x0,y0=ref1.y0,x1=ref1.x1,y1=ref1.y1,x2=ref1.x2,y2=ref1.y2,x3=ref1.x3,y3=ref1.y3;var packedColor=PackColor(tint,alpha);return this.addToBatch(textureFrame,packedColor,x0,y0,x1,y1,x2,y2,x3,y3);}},{key:"addXY",value:function addXY(x,y,frame2){var textureFrame=this.texture.getFrame(frame2);var ref=textureFrame.getExtent(0,0),left=ref.left,right=ref.right,top=ref.top,bottom=ref.bottom;var ref1=GetVerticesFromValues(left,right,top,bottom,x,y),x0=ref1.x0,y0=ref1.y0,x1=ref1.x1,y1=ref1.y1,x2=ref1.x2,y2=ref1.y2,x3=ref1.x3,y3=ref1.y3;return this.addToBatch(textureFrame,4294967295,x0,y0,x1,y1,x2,y2,x3,y3);}},{key:"updateTextureIndex",value:function updateTextureIndex(){var textureIndex=this.texture.binding.index;if(textureIndex===this.glTextureIndex){return;}var F32=this.vertexViewF32;this.glTextureIndex=textureIndex;for(var i6=0;i6<this.count;i6++){F32[i6*24+4]=textureIndex;F32[i6*24+10]=textureIndex;F32[i6*24+16]=textureIndex;F32[i6*24+22]=textureIndex;}}},{key:"renderGL",value:function renderGL(renderPass){BatchTexturedQuadBuffer(this,renderPass);}},{key:"destroy",value:function destroy(){swcHelpers.get(swcHelpers.getPrototypeOf(_class3.prototype),"destroy",this).call(this);DeleteFramebuffer(this.vertexBuffer);DeleteFramebuffer(this.indexBuffer);this.data=null;this.vertexViewF32=null;this.vertexViewU32=null;this.index=null;this.texture=null;this.hasTexture=false;}}]);return _class3;}(Layer);function CreateCanvas(width,height){var canvas=document.createElement("canvas");canvas.width=width;canvas.height=height;return canvas.getContext("2d");}function CanvasTexture(param,param1){var width=param=== void 0?32:param,height=param1=== void 0?32:param1;var ctx=CreateCanvas(width,height);return new Texture(ctx.canvas);}var Text1=function(Sprite1){"use strict";swcHelpers.inherits(_class3,Sprite1);function _class3(x,y,param,font,fillStyle){var text=param=== void 0?"":param;swcHelpers.classCallCheck(this,_class3);var _this;_this=swcHelpers.possibleConstructorReturn(this,swcHelpers.getPrototypeOf(_class3).call(this,x,y,CanvasTexture()));_this.splitRegExp=/(?:\r\n|\r|\n)/;_this.padding={left:0,right:0,top:0,bottom:0};_this.verticalAlign="ascent";_this.lineSpacing=0;_this.font="16px monospace";_this.fillStyle="#fff";_this.strokeStyle="";_this.backgroundStyle="";_this.cornerRadius=0;_this.textAlign="left";_this.textBaseline="alphabetic";_this.lineWidth=0;_this.lineDash=[];_this.antialias=false;_this.type="Text";var game=GameInstance.get();_this.resolution=game.renderer.resolution;_this.canvas=_this.texture.image;_this.context=_this.canvas.getContext("2d");if(font){_this.font=font;}if(fillStyle){_this.fillStyle=fillStyle;}_this.setText(text);return _this;}swcHelpers.createClass(_class3,[{key:"syncContext",value:function syncContext(canvas,ctx){if(this.preRenderCallback){this.preRenderCallback(canvas,ctx);}ctx.font=this.font;ctx.textBaseline=this.textBaseline;ctx.textAlign=this.textAlign;ctx.fillStyle=this.fillStyle;ctx.strokeStyle=this.strokeStyle;ctx.lineWidth=this.lineWidth;ctx.lineCap="round";ctx.lineJoin="round";ctx.setLineDash(this.lineDash);ctx.imageSmoothingEnabled=this.antialias;}},{key:"updateText",value:function updateText(){var canvas=this.canvas;var ctx=this.context;var resolution=this.resolution;var lines=this._text.split(this.splitRegExp);var padding=this.padding;var fillStyle=this.fillStyle;var strokeStyle=this.strokeStyle;var strokeWidth=this.lineWidth;var lineSpacing=this.lineSpacing;var strokeWidthHalf=strokeWidth>0?strokeWidth/2:0;ctx.clearRect(0,0,canvas.width,canvas.height);this.syncContext(canvas,ctx);ctx.textAlign="start";var maxWidth=0;var maxHeight=0;var y=0;var lineMetrics=[];var vAlignAscent=this.verticalAlign==="ascent";var metrics=ctx.measureText("|M\xc9q");var averageLineHeight=Math.ceil(Math.abs(metrics.actualBoundingBoxAscent)+Math.abs(metrics.actualBoundingBoxDescent))+strokeWidth;for(var i6=0;i6<lines.length;i6++){var metrics2=ctx.measureText(lines[i6]);var left=metrics2.actualBoundingBoxLeft;var right=metrics2.actualBoundingBoxRight;var ascent=metrics2.actualBoundingBoxAscent;var descent=metrics2.actualBoundingBoxDescent;if(!ascent&& !descent||lines[i6]===""){ascent=averageLineHeight;descent=0;}var lineWidth=Math.ceil(Math.abs(left)+Math.abs(right))+strokeWidth;var lineHeight=Math.ceil(Math.abs(ascent)+Math.abs(descent))+strokeWidth;if(vAlignAscent){y+=ascent+strokeWidthHalf;if(i6>0){y+=lineSpacing+strokeWidthHalf;}maxHeight=y+descent+strokeWidthHalf;}else{y=maxHeight+(lineHeight-descent-strokeWidthHalf);maxHeight+=lineHeight;if(i6<lines.length-1){maxHeight+=lineSpacing;}}maxWidth=Math.max(maxWidth,lineWidth);lineMetrics.push({lineWidth:lineWidth,lineHeight:lineHeight,ascent:ascent,descent:descent,left:left,right:right,y:y});}maxWidth+=padding.left+padding.right;maxHeight+=padding.top+padding.bottom;var displayWidth=this.fixedWidth?this.fixedWidth:maxWidth;var displayHeight=this.fixedHeight?this.fixedHeight:maxHeight;var canvasWidth=Math.ceil(displayWidth*resolution);var canvasHeight=Math.ceil(displayHeight*resolution);if(canvas.width!==canvasWidth||canvas.height!==canvasHeight){canvas.width=canvasWidth;canvas.height=canvasHeight;this.texture.setSize(displayWidth,displayHeight);this.setSize(displayWidth,displayHeight);}ctx.save();ctx.scale(resolution,resolution);this.syncContext(canvas,ctx);var backgroundStyle=this.backgroundStyle;if(backgroundStyle){ctx.save();ctx.fillStyle=backgroundStyle;ctx.strokeStyle=backgroundStyle;var cornerRadius=this.cornerRadius;var halfRadius=cornerRadius>0?cornerRadius/2:0;if(cornerRadius){ctx.lineWidth=cornerRadius;ctx.strokeRect(halfRadius,halfRadius,displayWidth-cornerRadius,displayHeight-cornerRadius);}ctx.fillRect(halfRadius,halfRadius,displayWidth-cornerRadius,displayHeight-cornerRadius);ctx.restore();}var textAlign=this.textAlign;var isCenter=textAlign==="center";var isRight=textAlign==="right"||textAlign==="end";var yOffset=(displayHeight-maxHeight)/2+padding.top;for(var i7=0;i7<lines.length;i7++){var line=lines[i7];var metrics2=lineMetrics[i7];var tx=padding.left+metrics2.left+strokeWidthHalf;var ty=yOffset+metrics2.y;if(isCenter){tx=displayWidth/2;}else if(isRight){tx=displayWidth-strokeWidthHalf;}if(strokeStyle){ctx.strokeText(line,tx,ty);}if(fillStyle){ctx.fillText(line,tx,ty);}}ctx.restore();if(this.texture.binding){this.texture.binding.update();}this.setDirty(DIRTY_CONST.TEXTURE);return this;}},{key:"text",get:function get(){return this._text;},set:function set(value){this.setText(value);}},{key:"setText",value:function setText(param){var value=param=== void 0?"":param;if(Array.isArray(value)){value=value.join("\n");}if(value!==this._text){this._text=value.toString();this.updateText();}return this;}},{key:"destroy",value:function destroy(reparentChildren){this.texture.destroy();this.fillStyle=null;this.strokeStyle=null;this.backgroundStyle=null;this.canvas=null;this.context=null;swcHelpers.get(swcHelpers.getPrototypeOf(_class3.prototype),"destroy",this).call(this,reparentChildren);}}]);return _class3;}(Sprite);var gameobjects3d_exports={};__export(gameobjects3d_exports,{Box:function(){return Box;},Components:function(){return components_exports2;},Cone:function(){return Cone;},GameObject3D:function(){return GameObject3D;},Geometry:function(){return geometry_exports;},Light:function(){return Light;},Material:function(){return Material;},Mesh:function(){return Mesh;},Plane:function(){return Plane;},RenderLayer3D:function(){return RenderLayer3D;},Sphere:function(){return Sphere;}});var components_exports2={};__export(components_exports2,{Transform3DComponent:function(){return Transform3DComponent;}});var Transform3DComponent=function(){"use strict";function _class3(entity,param,param1,param2){var x=param=== void 0?0:param,y=param1=== void 0?0:param1,z=param2=== void 0?0:param2;swcHelpers.classCallCheck(this,_class3);this.passthru=false;this.entity=entity;this.local=new Matrix4();this.world=new Matrix4();this.normal=new Matrix4();this.position=new Vec3Callback((function(){return this.update();}).bind(this),x,y,z);this.scale=new Vec3Callback((function(){return this.update();}).bind(this),1,1,1);this.origin=new Vec3Callback((function(){return this.update();}).bind(this));this.rotation=new Quaternion();this.rotation.onChange=(function(){return this.update();}).bind(this);this.forward=Vec3Forward();this.up=Vec3Up();this.right=Vec3Right();this.update();}swcHelpers.createClass(_class3,[{key:"rotateX",value:function rotateX(angle){QuatRotateX(this.rotation,angle,this.rotation);}},{key:"rotateY",value:function rotateY(angle){QuatRotateY(this.rotation,angle,this.rotation);}},{key:"rotateZ",value:function rotateZ(angle){QuatRotateZ(this.rotation,angle,this.rotation);}},{key:"update",value:function update(){var model=this.local;var normal=this.normal;Mat4FromRotationTranslationScale(this.rotation,this.position,this.scale,model);Mat4Invert(model,normal);Mat4Transpose(normal,normal);}},{key:"updateLocal",value:function updateLocal(){this.entity.setDirty(DIRTY_CONST.TRANSFORM,DIRTY_CONST.BOUNDS);}},{key:"updateWorld",value:function updateWorld(){var entity=this.entity;entity.setDirty(DIRTY_CONST.TRANSFORM,DIRTY_CONST.BOUNDS);if(entity.numChildren){this.updateChildren();}}},{key:"updateChildren",value:function updateChildren(){var children=this.entity.children;for(var i6=0;i6<children.length;i6++){var child=children[i6];}}},{key:"destroy",value:function destroy(){this.position.destroy();this.scale.destroy();this.origin.destroy();this.rotation.destroy();this.entity=null;this.local=null;this.world=null;this.position=null;this.scale=null;this.origin=null;this.rotation=null;}}]);return _class3;}();var geometry_exports={};__export(geometry_exports,{CreateVertexSet:function(){return CreateVertexSet;},FaceUVNormalTexture:function(){return FaceUVNormalTexture;},Geometry:function(){return Geometry;},GetBufferFromObj:function(){return GetBufferFromObj;},GetBufferFromVertexSet:function(){return GetBufferFromVertexSet;},GetFacesFromVertexSet:function(){return GetFacesFromVertexSet;},ParseObj:function(){return ParseObj;}});function CreateVertexSet(){return {vertices:[],normals:[],uvs:[],indices:[],numberOfVertices:0};}var webgl1_exports={};__export(webgl1_exports,{CreateFramebuffer:function(){return CreateFramebuffer;},CreateGLTexture:function(){return CreateGLTexture;},DeleteFramebuffer:function(){return DeleteFramebuffer;},DeleteGLBuffer:function(){return DeleteGLBuffer;},DeleteGLTexture:function(){return DeleteGLTexture;},GL:function(){return GL;},PackColor:function(){return PackColor;},PackColors:function(){return PackColors;},SetGLTextureFilterMode:function(){return SetGLTextureFilterMode;},UpdateGLTexture:function(){return UpdateGLTexture;},WebGLRenderer:function(){return WebGLRenderer;}});var FaceUVNormalTexture=function(){"use strict";function _class3(v1,v2,v3,n1,n2,n3,uv1,uv2,uv3,param){var scale=param=== void 0?1:param;swcHelpers.classCallCheck(this,_class3);this.color=16777215;this.alpha=1;this.size=30;this.vertex1=new Vertex(v1.x*scale,v1.y*scale,v1.z*scale);this.vertex2=new Vertex(v2.x*scale,v2.y*scale,v2.z*scale);this.vertex3=new Vertex(v3.x*scale,v3.y*scale,v3.z*scale);this.vertex1.setUV(uv1.x,uv1.y);this.vertex2.setUV(uv2.x,uv2.y);this.vertex3.setUV(uv3.x,uv3.y);this.normal1=n1;this.normal2=n2;this.normal3=n3;this._packedColor=PackColor(this.color,this.alpha);}swcHelpers.createClass(_class3,[{key:"setColor",value:function setColor(color,param){var alpha=param=== void 0?1:param;this.color=color;this.alpha=alpha;this._packedColor=PackColor(color,alpha);}},{key:"addToBuffer",value:function addToBuffer(F32,U32,textureID,offset){var v1=this.vertex1;var v2=this.vertex2;var v3=this.vertex3;var n1=this.normal1;var n2=this.normal2;var n3=this.normal3;var color=this._packedColor;F32[offset++]=v1.x;F32[offset++]=v1.y;F32[offset++]=v1.z;F32[offset++]=n1.x;F32[offset++]=n1.y;F32[offset++]=n1.z;F32[offset++]=v1.u;F32[offset++]=v1.v;F32[offset++]=textureID;U32[offset++]=color;F32[offset++]=v2.x;F32[offset++]=v2.y;F32[offset++]=v2.z;F32[offset++]=n2.x;F32[offset++]=n2.y;F32[offset++]=n2.z;F32[offset++]=v2.u;F32[offset++]=v2.v;F32[offset++]=textureID;U32[offset++]=color;F32[offset++]=v3.x;F32[offset++]=v3.y;F32[offset++]=v3.z;F32[offset++]=n3.x;F32[offset++]=n3.y;F32[offset++]=n3.z;F32[offset++]=v3.u;F32[offset++]=v3.v;F32[offset++]=textureID;U32[offset++]=color;return offset;}}]);return _class3;}();function GetVec3(data,index){var x=data[index*3+0];var y=data[index*3+1];var z=data[index*3+2];return [x,y,z];}function GetVec2(data,index){var x=data[index*2+0];var y=data[index*2+1];return [x,y];}function CreateNonIndexedVertexBuffer(data){var vertices=data.vertices,normals=data.normals,uvs=data.uvs;var total=vertices.length;var count=total/3;var batchSize=count/3;var buffer=new VertexBuffer({batchSize:batchSize,isDynamic:false,vertexElementSize:8,elementsPerEntry:3});var F32=buffer.vertexViewF32;var offset=0;var uvIndex=0;for(var i6=0;i6<total;i6+=3){F32[offset++]=vertices[i6+0];F32[offset++]=vertices[i6+1];F32[offset++]=vertices[i6+2];F32[offset++]=normals[i6+0];F32[offset++]=normals[i6+1];F32[offset++]=normals[i6+2];F32[offset++]=uvs[uvIndex+0];F32[offset++]=uvs[uvIndex+1];uvIndex+=2;}buffer.count=count;return buffer;}function CreateVertexBuffer(data){var vertices=data.vertices,normals=data.normals,uvs=data.uvs,indices=data.indices;var buffer=new VertexBuffer({batchSize:indices.length/3,isDynamic:false,vertexElementSize:8,elementsPerEntry:3});var F32=buffer.vertexViewF32;var offset=0;for(var i6=0;i6<indices.length;i6+=3){var i11=indices[i6+0];var i21=indices[i6+1];var i31=indices[i6+2];var v1=GetVec3(vertices,i11);var v2=GetVec3(vertices,i21);var v3=GetVec3(vertices,i31);var n1=GetVec3(normals,i11);var n2=GetVec3(normals,i21);var n3=GetVec3(normals,i31);var uv1=GetVec2(uvs,i11);var uv2=GetVec2(uvs,i21);var uv3=GetVec2(uvs,i31);F32[offset++]=v1[0];F32[offset++]=v1[1];F32[offset++]=v1[2];F32[offset++]=n1[0];F32[offset++]=n1[1];F32[offset++]=n1[2];F32[offset++]=uv1[0];F32[offset++]=uv1[1];F32[offset++]=v2[0];F32[offset++]=v2[1];F32[offset++]=v2[2];F32[offset++]=n2[0];F32[offset++]=n2[1];F32[offset++]=n2[2];F32[offset++]=uv2[0];F32[offset++]=uv2[1];F32[offset++]=v3[0];F32[offset++]=v3[1];F32[offset++]=v3[2];F32[offset++]=n3[0];F32[offset++]=n3[1];F32[offset++]=n3[2];F32[offset++]=uv3[0];F32[offset++]=uv3[1];}buffer.count=indices.length;return buffer;}function GetBufferFromVertexSet(data){if(data.indices&&data.indices.length>0){return CreateVertexBuffer(data);}else{return CreateNonIndexedVertexBuffer(data);}}var Geometry=function(){"use strict";function _class3(data){swcHelpers.classCallCheck(this,_class3);if(data){if(data.hasOwnProperty("vertices")){this.buffer=GetBufferFromVertexSet(data);}else{this.buffer=data;}}}swcHelpers.createClass(_class3,[{key:"destroy",value:function destroy(){this.buffer.destroy();}}]);return _class3;}();var ParseObj=function(){"use strict";function _class3(fileContents,param,param1){var flipUVs=param=== void 0?true:param,defaultModelName=param1=== void 0?"untitled":param1;swcHelpers.classCallCheck(this,_class3);this.currentMaterial="";this.currentGroup="";this.smoothingGroup=0;this.result={materialLibraries:[],models:[]};this.fileContents=fileContents;this.defaultModelName=defaultModelName;this.flipUVs=flipUVs;}swcHelpers.createClass(_class3,[{key:"parseAsync",value:function parseAsync(){return new Promise((function(resolve,reject){try{resolve(this.parse());}catch(theError) {reject(theError);}}).bind(this));}},{key:"parse",value:function parse(){var stripComments=function(line){var commentIndex=line.indexOf("#");if(commentIndex> -1){return line.substring(0,commentIndex);}return line;};var lines=this.fileContents.split("\n");for(var _i=0;_i<lines.length;_i++){var line=lines[_i];var strippedline=stripComments(line);var lineItems=strippedline.replace(/\s\s+/g," ").trim().split(" ");switch(lineItems[0].toLowerCase()){case "o":this.parseObject(lineItems);break;case "g":this.parseGroup(lineItems);break;case "v":this.parseVertexCoords(lineItems);break;case "vt":this.parseTextureCoords(lineItems);break;case "vn":this.parseVertexNormal(lineItems);break;case "s":this.parseSmoothShadingStatement(lineItems);break;case "f":this.parsePolygon(lineItems);break;case "mtllib":this.parseMtlLib(lineItems);break;case "usemtl":this.parseUseMtl(lineItems);break;}}this.fileContents="";return this.result;}},{key:"currentModel",value:function currentModel(){if(this.result.models.length===0){this.result.models.push({faces:[],name:this.defaultModelName,textureCoords:[],vertexNormals:[],vertices:[]});this.currentGroup="";this.smoothingGroup=0;}return this.result.models[this.result.models.length-1];}},{key:"parseObject",value:function parseObject(lineItems){var modelName=lineItems.length>=2?lineItems[1]:this.defaultModelName;this.result.models.push({faces:[],name:modelName,textureCoords:[],vertexNormals:[],vertices:[]});this.currentGroup="";this.smoothingGroup=0;}},{key:"parseGroup",value:function parseGroup(lineItems){if(lineItems.length!==2){throw "Group statements must have exactly 1 argument (eg. g group_1)";}this.currentGroup=lineItems[1];}},{key:"parseVertexCoords",value:function parseVertexCoords(lineItems){var len=lineItems.length;var x=len>=2?parseFloat(lineItems[1]):0;var y=len>=3?parseFloat(lineItems[2]):0;var z=len>=4?parseFloat(lineItems[3]):0;this.currentModel().vertices.push({x:x,y:y,z:z});}},{key:"parseTextureCoords",value:function parseTextureCoords(lineItems){var len=lineItems.length;var u=len>=2?parseFloat(lineItems[1]):0;var v=len>=3?parseFloat(lineItems[2]):0;var w=len>=4?parseFloat(lineItems[3]):0;if(isNaN(u)){u=0;}if(isNaN(v)){v=0;}if(isNaN(w)){w=0;}if(this.flipUVs){v=1-v;}this.currentModel().textureCoords.push({u:u,v:v,w:w});}},{key:"parseVertexNormal",value:function parseVertexNormal(lineItems){var len=lineItems.length;var x=len>=2?parseFloat(lineItems[1]):0;var y=len>=3?parseFloat(lineItems[2]):0;var z=len>=4?parseFloat(lineItems[3]):0;this.currentModel().vertexNormals.push({x:x,y:y,z:z});}},{key:"parsePolygon",value:function parsePolygon(lineItems){var totalVertices=lineItems.length-1;if(totalVertices<3){throw "Face < 3 vertices";}var face={group:this.currentGroup,material:this.currentMaterial,smoothingGroup:this.smoothingGroup,vertices:[]};for(var i6=0;i6<totalVertices;i6++){var vertexString=lineItems[i6+1];var vertexValues=vertexString.split("/");var vvLen=vertexValues.length;if(vvLen<1||vvLen>3){throw "Too many / values for single vertex";}var vertexIndex=0;var textureCoordsIndex=0;var vertexNormalIndex=0;vertexIndex=parseInt(vertexValues[0],10);if(vvLen>1&&vertexValues[1]!==""){textureCoordsIndex=parseInt(vertexValues[1],10);}if(vvLen>2){vertexNormalIndex=parseInt(vertexValues[2],10);}if(vertexIndex===0){throw "Faces uses invalid vertex index of 0";}if(vertexIndex<0){vertexIndex=this.currentModel().vertices.length+1+vertexIndex;}textureCoordsIndex-=1;vertexIndex-=1;vertexNormalIndex-=1;face.vertices.push({textureCoordsIndex:textureCoordsIndex,vertexIndex:vertexIndex,vertexNormalIndex:vertexNormalIndex});}this.currentModel().faces.push(face);}},{key:"parseMtlLib",value:function parseMtlLib(lineItems){if(lineItems.length>=2){this.result.materialLibraries.push(lineItems[1]);}}},{key:"parseUseMtl",value:function parseUseMtl(lineItems){if(lineItems.length>=2){this.currentMaterial=lineItems[1];}}},{key:"parseSmoothShadingStatement",value:function parseSmoothShadingStatement(lineItems){if(lineItems.length!==2){throw "Smoothing group statements must have exactly 1 argument (eg. s <number|off>)";}var groupNumber=lineItems[1].toLowerCase()==="off"?0:parseInt(lineItems[1],10);this.smoothingGroup=groupNumber;}}]);return _class3;}();function GetBufferFromObj(data,param){var flipUVs=param=== void 0?true:param;var parser=new ParseObj(data,flipUVs);var result=parser.parse();var output=[];result.models.forEach(function(model){var faces=model.faces,textureCoords=model.textureCoords,vertexNormals=model.vertexNormals,vertices=model.vertices;var totalFaces=0;for(var i6=0;i6<faces.length;i6++){totalFaces+=faces[i6].vertices.length===4?6:3;}var buffer=new VertexBuffer({batchSize:totalFaces,isDynamic:false,vertexElementSize:8,elementsPerEntry:3});var F32=buffer.vertexViewF32;var offset=0;for(var i7=0;i7<faces.length;i7++){var face=faces[i7];var i12=face.vertices[0];var i22=face.vertices[1];var i32=face.vertices[2];var v1=vertices[i12.vertexIndex];var v2=vertices[i22.vertexIndex];var v3=vertices[i32.vertexIndex];var n1=vertexNormals[i12.vertexNormalIndex];var n2=vertexNormals[i22.vertexNormalIndex];var n3=vertexNormals[i32.vertexNormalIndex];var uv1=textureCoords[i12.textureCoordsIndex];var uv2=textureCoords[i22.textureCoordsIndex];var uv3=textureCoords[i32.textureCoordsIndex];F32[offset++]=v1.x;F32[offset++]=v1.y;F32[offset++]=v1.z;F32[offset++]=n1.x;F32[offset++]=n1.y;F32[offset++]=n1.z;F32[offset++]=uv1.u;F32[offset++]=uv1.v;F32[offset++]=v2.x;F32[offset++]=v2.y;F32[offset++]=v2.z;F32[offset++]=n2.x;F32[offset++]=n2.y;F32[offset++]=n2.z;F32[offset++]=uv2.u;F32[offset++]=uv2.v;F32[offset++]=v3.x;F32[offset++]=v3.y;F32[offset++]=v3.z;F32[offset++]=n3.x;F32[offset++]=n3.y;F32[offset++]=n3.z;F32[offset++]=uv3.u;F32[offset++]=uv3.v;buffer.count+=3;if(face.vertices.length===4){var i41=face.vertices[3];var v4=vertices[i41.vertexIndex];var n4=vertexNormals[i41.vertexNormalIndex];var uv4=textureCoords[i41.textureCoordsIndex];F32[offset++]=v1.x;F32[offset++]=v1.y;F32[offset++]=v1.z;F32[offset++]=n1.x;F32[offset++]=n1.y;F32[offset++]=n1.z;F32[offset++]=uv1.u;F32[offset++]=uv1.v;F32[offset++]=v3.x;F32[offset++]=v3.y;F32[offset++]=v3.z;F32[offset++]=n3.x;F32[offset++]=n3.y;F32[offset++]=n3.z;F32[offset++]=uv3.u;F32[offset++]=uv3.v;F32[offset++]=v4.x;F32[offset++]=v4.y;F32[offset++]=v4.z;F32[offset++]=n4.x;F32[offset++]=n4.y;F32[offset++]=n4.z;F32[offset++]=uv4.u;F32[offset++]=uv4.v;buffer.count+=3;}}output.push({name:model.name,buffer:buffer});});return output;}function GetVec32(data,index){var x=data[index*3+0];var y=data[index*3+1];var z=data[index*3+2];return [x,y,z];}function GetVec22(data,index){var x=data[index*2+0];var y=data[index*2+1];return [x,y];}function GetFacesFromVertexSet(data){var vertices=data.vertices,normals=data.normals,uvs=data.uvs,indices=data.indices;var faces=[];for(var i6=0;i6<indices.length;i6+=3){var i13=indices[i6+0];var i23=indices[i6+1];var i33=indices[i6+2];var v1=GetVec32(vertices,i13);var v2=GetVec32(vertices,i23);var v3=GetVec32(vertices,i33);var n1=GetVec32(normals,i13);var n2=GetVec32(normals,i23);var n3=GetVec32(normals,i33);var uv1=GetVec22(uvs,i13);var uv2=GetVec22(uvs,i23);var uv3=GetVec22(uvs,i33);var f=new FaceUVNormalTexture({x:v1[0],y:v1[1],z:v1[2]},{x:v2[0],y:v2[1],z:v2[2]},{x:v3[0],y:v3[1],z:v3[2]},{x:n1[0],y:n1[1],z:n1[2]},{x:n2[0],y:n2[1],z:n2[2]},{x:n3[0],y:n3[1],z:n3[2]},{x:uv1[0],y:uv1[1]},{x:uv2[0],y:uv2[1]},{x:uv3[0],y:uv3[1]},1);faces.push(f);}return faces;}function PlaneGeometry(data,param,param1,param2,param3,param4,param5,param6,param7,param8,param9,param10,param11,param12){var x=param=== void 0?0:param,y=param1=== void 0?0:param1,z=param2=== void 0?0:param2,u=param3=== void 0?0:param3,v=param4=== void 0?1:param4,w=param5=== void 0?2:param5,udir=param6=== void 0?1:param6,vdir=param7=== void 0?-1:param7,width=param8=== void 0?1:param8,height=param9=== void 0?1:param9,depth=param10=== void 0?1:param10,gridX=param11=== void 0?1:param11,gridY=param12=== void 0?1:param12;if(!data){data=CreateVertexSet();}var vertices=data.vertices,normals=data.normals,uvs=data.uvs,indices=data.indices,numberOfVertices=data.numberOfVertices;var segmentWidth=width/gridX;var segmentHeight=height/gridY;var widthHalf=width/2;var heightHalf=height/2;var depthHalf=depth/2;var gridX1=gridX+1;var gridY1=gridY+1;var vertexCounter=0;var vector=[];for(var iy=0;iy<gridY1;iy++){var by=iy*segmentHeight-heightHalf;for(var ix=0;ix<gridX1;ix++){var bx=ix*segmentWidth-widthHalf;vector[u]=bx*udir;vector[v]=by*vdir;vector[w]=depthHalf;vertices.push(x+vector[0],y+vector[1],z+vector[2]);vector[u]=0;vector[v]=0;vector[w]=depth>0?1:-1;normals.push(vector[0],vector[1],vector[2]);uvs.push(ix/gridX);uvs.push(1-iy/gridY);vertexCounter+=1;}}for(var iy1=0;iy1<gridY;iy1++){for(var ix=0;ix<gridX;ix++){var a=numberOfVertices+ix+gridX1*iy1;var b=numberOfVertices+ix+gridX1*(iy1+1);var c=numberOfVertices+(ix+1)+gridX1*(iy1+1);var d=numberOfVertices+(ix+1)+gridX1*iy1;indices.push(a,b,d);indices.push(b,c,d);}}data.numberOfVertices+=vertexCounter;return data;}function BoxGeometry(param,param1,param2,param3,param4,param5,param6,param7,param8){var x=param=== void 0?0:param,y=param1=== void 0?0:param1,z=param2=== void 0?0:param2,width=param3=== void 0?1:param3,height=param4=== void 0?1:param4,depth=param5=== void 0?1:param5,widthSegments=param6=== void 0?1:param6,heightSegments=param7=== void 0?1:param7,depthSegments=param8=== void 0?1:param8;var data=CreateVertexSet();PlaneGeometry(data,x,y,z,2,1,0,-1,-1,depth,height,width,depthSegments,heightSegments);PlaneGeometry(data,x,y,z,2,1,0,1,-1,depth,height,-width,depthSegments,heightSegments);PlaneGeometry(data,x,y,z,0,2,1,1,1,width,depth,height,widthSegments,depthSegments);PlaneGeometry(data,x,y,z,0,2,1,1,-1,width,depth,-height,widthSegments,depthSegments);PlaneGeometry(data,x,y,z,0,1,2,1,-1,width,height,depth,widthSegments,heightSegments);PlaneGeometry(data,x,y,z,0,1,2,-1,-1,width,height,-depth,widthSegments,heightSegments);return data;}var GameObject3D=function(){"use strict";function _class3(param,param1,param2){var x=param=== void 0?0:param,y=param1=== void 0?0:param1,z=param2=== void 0?0:param2;swcHelpers.classCallCheck(this,_class3);this.type="GameObject3D";this.name="";this.willUpdate=true;this.willUpdateChildren=true;this.willRender=true;this.willRenderChildren=true;this.willCacheChildren=false;this.dirty=0;this.dirtyFrame=0;this.visible=true;this.children=[];this.events=new Map();this.transform=new Transform3DComponent(this,x,y,z);this.dirty=DIRTY_CONST.DEFAULT;}swcHelpers.createClass(_class3,[{key:"isRenderable",value:function isRenderable(){return this.visible&&this.willRender;}},{key:"isDirty",value:function isDirty(flag){return (this.dirty&flag)!==0;}},{key:"clearDirty",value:function clearDirty(flag){if(this.isDirty(flag)){this.dirty^=flag;}return this;}},{key:"setDirty",value:function setDirty(flag,flag2){if(!this.isDirty(flag)){this.dirty^=flag;this.dirtyFrame=GameInstance.getFrame();}if(!this.isDirty(flag2)){this.dirty^=flag2;}return this;}},{key:"update",value:function update(delta,time){if(this.willUpdateChildren){var children=this.children;for(var i6=0;i6<children.length;i6++){var child=children[i6];if(child&&child.willUpdate){child.update(delta,time);}}}this.postUpdate(delta,time);}},{key:"postUpdate",value:function postUpdate(delta,time){}},{key:"renderGL",value:function renderGL(renderPass){}},{key:"postRenderGL",value:function postRenderGL(renderPass){}},{key:"numChildren",get:function get(){return this.children.length;}},{key:"destroy",value:function destroy(reparentChildren){if(reparentChildren){}else{}Emit(this,DestroyEvent,this);this.transform.destroy();this.events.clear();this.world=null;this.parent=null;this.children=null;}}]);return _class3;}();var Material=function(){"use strict";function _class3(param){var config=param=== void 0?{}:param;swcHelpers.classCallCheck(this,_class3);this.isDirty=false;var _ambient=config.ambient,ambient=_ambient=== void 0?[1,1,1]:_ambient,_diffuse=config.diffuse,diffuse=_diffuse=== void 0?[1,1,1]:_diffuse,_specular=config.specular,specular=_specular=== void 0?[1,1,1]:_specular,_shine=config.shine,shine=_shine=== void 0?0.25:_shine;var onChange=(function(){return this.update();}).bind(this);this.ambient=new RGBCallback(onChange).fromArray(ambient);this.diffuse=new RGBCallback(onChange).fromArray(diffuse);this.specular=new RGBCallback(onChange).fromArray(specular);this._shine=shine;}swcHelpers.createClass(_class3,[{key:"shine",get:function get(){return this._shine;},set:function set(value){this._shine=Clamp(value,0,1);this.isDirty=true;}},{key:"update",value:function update(){this.isDirty=true;}},{key:"setUniforms",value:function setUniforms(shader){shader.setUniform("uMaterialAmbient",this.ambient.toArray());shader.setUniform("uMaterialDiffuse",this.diffuse.toArray());shader.setUniform("uMaterialSpecular",this.specular.toArray());shader.setUniform("uMaterialShine",this._shine*256);}},{key:"destroy",value:function destroy(){this.ambient.destroy();this.diffuse.destroy();this.specular.destroy();}}]);return _class3;}();function SetFrame2(texture,key){for(var _len=arguments.length,children=new Array(_len>2?_len-2:0),_key=2;_key<_len;_key++){children[_key-2]=arguments[_key];}var frame2=texture.getFrame(key);children.forEach(function(child){if(!child||frame2===child.frame){return;}child.frame=frame2;child.hasTexture=true;});return children;}function SetTexture3(key,frame2){for(var _len=arguments.length,children=new Array(_len>2?_len-2:0),_key=2;_key<_len;_key++){children[_key-2]=arguments[_key];}if(!key){children.forEach(function(child){child.texture=null;child.frame=null;child.hasTexture=false;});}else{var texture=void 0;if(swcHelpers._instanceof(key,Texture)){texture=key;}else{texture=TextureManagerInstance.get().get(key);}if(!texture){console.warn("Invalid Texture key: ".concat(key));}else{children.forEach(function(child){child.texture=texture;});SetFrame2.apply(void 0,[texture,frame2].concat(swcHelpers.toConsumableArray(children)));}}return children;}var Mesh=function(GameObject3D1){"use strict";swcHelpers.inherits(_class3,GameObject3D1);function _class3(param,param1,param2,geometry,param3){var x=param=== void 0?0:param,y=param1=== void 0?0:param1,z=param2=== void 0?0:param2,material=param3=== void 0?new Material():param3;swcHelpers.classCallCheck(this,_class3);var _this;_this=swcHelpers.possibleConstructorReturn(this,swcHelpers.getPrototypeOf(_class3).call(this,x,y,z));_this.hasTexture=false;_this.cullFaces=true;_this.geometry=geometry;_this.material=material;_this.setTexture("__WHITE");return _this;}swcHelpers.createClass(_class3,[{key:"setTexture",value:function setTexture(key,frame2){SetTexture3(key,frame2,this);return this;}},{key:"setFrame",value:function setFrame(key){SetFrame2(this.texture,key,this);return this;}},{key:"setMaterial",value:function setMaterial(material){this.material=material;return this;}},{key:"renderGL",value:function renderGL(renderPass){var shader=renderPass.currentShader.shader;shader.setUniform("uModelMatrix",this.transform.local.data);shader.setUniform("uNormalMatrix",this.transform.normal.data);if(this.hasTexture){var textureIndex=SetTexture(renderPass,this.texture);shader.setUniform("uTexture",textureIndex);}this.material.setUniforms(shader);FlushBuffer(renderPass,this.geometry.buffer);}},{key:"destroy",value:function destroy(reparentChildren){swcHelpers.get(swcHelpers.getPrototypeOf(_class3.prototype),"destroy",this).call(this,reparentChildren);this.geometry=null;this.material=null;this.texture=null;this.frame=null;this.hasTexture=false;}}]);return _class3;}(GameObject3D);var Box=function(Mesh1){"use strict";swcHelpers.inherits(_class3,Mesh1);function _class3(param,param1,param2,param3,param4,param5,param6,param7,param8){var x=param=== void 0?0:param,y=param1=== void 0?0:param1,z=param2=== void 0?0:param2,width=param3=== void 0?1:param3,height=param4=== void 0?1:param4,depth=param5=== void 0?1:param5,widthSegments=param6=== void 0?1:param6,heightSegments=param7=== void 0?1:param7,depthSegments=param8=== void 0?1:param8;swcHelpers.classCallCheck(this,_class3);var data=BoxGeometry(0,0,0,width,height,depth,widthSegments,heightSegments,depthSegments);var geometry=new Geometry(data);return swcHelpers.possibleConstructorReturn(this,swcHelpers.getPrototypeOf(_class3).call(this,x,y,z,geometry));}return _class3;}(Mesh);function GenerateCap(top,data,index,halfHeight,radiusTop,radiusBottom,radialSegments,thetaStart,thetaLength){var vertices=data.vertices,normals=data.normals,uvs=data.uvs,indices=data.indices;var uv=new Vec2();var vertex=new Vec3();var radius=top===true?radiusTop:radiusBottom;var sign=top===true?1:-1;var centerIndexStart=index;for(var x=1;x<=radialSegments;x++){vertices.push(0,halfHeight*sign,0);normals.push(0,sign,0);uvs.push(0.5,0.5);index++;}var centerIndexEnd=index;for(var x1=0;x1<=radialSegments;x1++){var u=x1/radialSegments;var theta=u*thetaLength+thetaStart;var cosTheta=Math.cos(theta);var sinTheta=Math.sin(theta);vertex.x=radius*sinTheta;vertex.y=halfHeight*sign;vertex.z=radius*cosTheta;vertices.push(vertex.x,vertex.y,vertex.z);normals.push(0,sign,0);uv.x=cosTheta*0.5+0.5;uv.y=sinTheta*0.5*sign+0.5;uvs.push(uv.x,uv.y);index++;}for(var x2=0;x2<radialSegments;x2++){var c=centerIndexStart+x2;var i7=centerIndexEnd+x2;if(top){indices.push(i7,i7+1,c);}else{indices.push(i7+1,i7,c);}}return index;}function CylinderGeometry(param,param1,param2,param3,param4,param5,param6,param7){var radiusTop=param=== void 0?1:param,radiusBottom=param1=== void 0?1:param1,height=param2=== void 0?1:param2,radialSegments=param3=== void 0?8:param3,heightSegments=param4=== void 0?1:param4,openEnded=param5=== void 0?false:param5,thetaStart=param6=== void 0?0:param6,thetaLength=param7=== void 0?Math.PI*2:param7;var data=CreateVertexSet();var vertices=data.vertices,normals=data.normals,uvs=data.uvs,indices=data.indices;var index=0;var indexArray=[];var halfHeight=height/2;var normal=new Vec3();var vertex=new Vec3();var slope=(radiusBottom-radiusTop)/height;for(var y=0;y<=heightSegments;y++){var indexRow=[];var v=y/heightSegments;var radius=v*(radiusBottom-radiusTop)+radiusTop;for(var x=0;x<=radialSegments;x++){var u=x/radialSegments;var theta=u*thetaLength+thetaStart;var sinTheta=Math.sin(theta);var cosTheta=Math.cos(theta);vertex.x=radius*sinTheta;vertex.y=-v*height+halfHeight;vertex.z=radius*cosTheta;vertices.push(vertex.x,vertex.y,vertex.z);normal.set(sinTheta,slope,cosTheta);Vec3Normalize(normal,normal);normals.push(normal.x,normal.y,normal.z);uvs.push(u,1-v);indexRow.push(index++);}indexArray.push(indexRow);}for(var x=0;x<radialSegments;x++){for(var y1=0;y1<heightSegments;y1++){var a=indexArray[y1][x];var b=indexArray[y1+1][x];var c=indexArray[y1+1][x+1];var d=indexArray[y1][x+1];indices.push(a,b,d);indices.push(b,c,d);}}if(!openEnded){if(radiusTop>0){index=GenerateCap(true,data,index,halfHeight,radiusTop,radiusBottom,radialSegments,thetaStart,thetaLength);}if(radiusBottom>0){GenerateCap(false,data,index,halfHeight,radiusTop,radiusBottom,radialSegments,thetaStart,thetaLength);}}data.numberOfVertices=vertices.length;return data;}function ConeGeometry(param,param1,param2,param3,param4,param5,param6){var radius=param=== void 0?1:param,height=param1=== void 0?1:param1,radialSegments=param2=== void 0?8:param2,heightSegments=param3=== void 0?1:param3,openEnded=param4=== void 0?false:param4,thetaStart=param5=== void 0?0:param5,thetaLength=param6=== void 0?Math.PI*2:param6;return CylinderGeometry(0,radius,height,radialSegments,heightSegments,openEnded,thetaStart,thetaLength);}var Cone=function(Mesh1){"use strict";swcHelpers.inherits(_class3,Mesh1);function _class3(param,param1,param2,param3,param4,param5,param6,param7,param8,param9){var x=param=== void 0?0:param,y2=param1=== void 0?0:param1,z=param2=== void 0?0:param2,radius=param3=== void 0?1:param3,height=param4=== void 0?1:param4,radialSegments=param5=== void 0?8:param5,heightSegments=param6=== void 0?1:param6,openEnded=param7=== void 0?false:param7,thetaStart=param8=== void 0?0:param8,thetaLength=param9=== void 0?Math.PI*2:param9;swcHelpers.classCallCheck(this,_class3);var data=ConeGeometry(radius,height,radialSegments,heightSegments,openEnded,thetaStart,thetaLength);var geometry=new Geometry(data);return swcHelpers.possibleConstructorReturn(this,swcHelpers.getPrototypeOf(_class3).call(this,x,y2,z,geometry));}return _class3;}(Mesh);var Light=function(){"use strict";function _class3(param){var config=param=== void 0?{}:param;swcHelpers.classCallCheck(this,_class3);this.isDirty=false;var _x=config.x,x=_x=== void 0?0:_x,_y=config.y,y2=_y=== void 0?0:_y,_z=config.z,z=_z=== void 0?0.1:_z,_ambient=config.ambient,ambient=_ambient=== void 0?[1,1,1]:_ambient,_diffuse=config.diffuse,diffuse=_diffuse=== void 0?[1,1,1]:_diffuse,_specular=config.specular,specular=_specular=== void 0?[1,1,1]:_specular;var onChange=(function(){return this.update();}).bind(this);this.position=new Vec3Callback(onChange,x,y2,z);this.ambient=new RGBCallback(onChange).fromArray(ambient);this.diffuse=new RGBCallback(onChange).fromArray(diffuse);this.specular=new RGBCallback(onChange).fromArray(specular);}swcHelpers.createClass(_class3,[{key:"setUniforms",value:function setUniforms(shader){shader.setUniform("uLightPosition",this.position.toArray());shader.setUniform("uLightAmbient",this.ambient.toArray());shader.setUniform("uLightDiffuse",this.diffuse.toArray());shader.setUniform("uLightSpecular",this.specular.toArray());}},{key:"update",value:function update(){this.isDirty=true;}},{key:"destroy",value:function destroy(){this.position.destroy();this.ambient.destroy();this.diffuse.destroy();this.specular.destroy();}}]);return _class3;}();var Plane=function(Mesh1){"use strict";swcHelpers.inherits(_class3,Mesh1);function _class3(param,param1,param2,param3,param4,param5,param6){var x=param=== void 0?0:param,y2=param1=== void 0?0:param1,z=param2=== void 0?0:param2,width=param3=== void 0?1:param3,height=param4=== void 0?1:param4,widthSegments=param5=== void 0?1:param5,heightSegments=param6=== void 0?1:param6;swcHelpers.classCallCheck(this,_class3);var data=PlaneGeometry(null,0,0,0,0,1,2,1,-1,width,height,1,widthSegments,heightSegments);var geometry=new Geometry(data);return swcHelpers.possibleConstructorReturn(this,swcHelpers.getPrototypeOf(_class3).call(this,x,y2,z,geometry));}return _class3;}(Mesh);var RenderLayer3D=function(Layer1){"use strict";swcHelpers.inherits(_class3,Layer1);function _class3(){swcHelpers.classCallCheck(this,_class3);var _this;_this=swcHelpers.possibleConstructorReturn(this,swcHelpers.getPrototypeOf(_class3).call(this));_this.type="RenderLayer";_this.willRender=true;_this.willRenderChildren=true;_this.willCacheChildren=true;_this.setDirty(DIRTY_CONST.CHILD_CACHE);var width=GetWidth();var height=GetHeight();var resolution=GetResolution();var texture=new Texture(null,width*resolution,height*resolution);var binding=new GLTextureBinding(texture);texture.binding=binding;binding.framebuffer=CreateFramebuffer(binding.texture);binding.depthbuffer=CreateDepthBuffer(binding.framebuffer,texture.width,texture.height);_this.texture=texture;_this.framebuffer=binding.framebuffer;return _this;}swcHelpers.createClass(_class3,[{key:"renderGL",value:function renderGL(renderPass){if(this.numChildren>0){Flush(renderPass);if(!this.willCacheChildren||this.isDirty(DIRTY_CONST.CHILD_CACHE)){SetFramebuffer(renderPass,this.framebuffer,true);this.clearDirty(DIRTY_CONST.CHILD_CACHE);}else{SetFramebuffer(renderPass,this.framebuffer,false);this.postRenderGL(renderPass);}}}},{key:"postRenderGL",value:function postRenderGL(renderPass){Flush(renderPass);PopFramebuffer(renderPass);DrawTexturedQuad2(renderPass,this.texture);this.clearDirty(DIRTY_CONST.TRANSFORM);}}]);return _class3;}(Layer);function SphereGeometry(param,param1,param2,param3,param4,param5,param6){var radius=param=== void 0?1:param,widthSegments=param1=== void 0?3:param1,heightSegments=param2=== void 0?3:param2,phiStart=param3=== void 0?0:param3,phiLength=param4=== void 0?Math.PI*2:param4,thetaStart=param5=== void 0?0:param5,thetaLength=param6=== void 0?Math.PI:param6;widthSegments=Math.max(3,Math.floor(widthSegments)||8);heightSegments=Math.max(2,Math.floor(heightSegments)||6);var thetaEnd=Math.min(thetaStart+thetaLength,Math.PI);var data=CreateVertexSet();var vertices=data.vertices,normals=data.normals,uvs=data.uvs,indices=data.indices;var index=0;var grid=[];var vertex=new Vec3();var normal=new Vec3();for(var iy=0;iy<=heightSegments;iy++){var verticesRow=[];var v=iy/heightSegments;var uOffset=0;if(iy===0&&thetaStart===0){uOffset=0.5/widthSegments;}else if(iy===heightSegments&&thetaEnd==Math.PI){uOffset=-0.5/widthSegments;}for(var ix=0;ix<=widthSegments;ix++){var u=ix/widthSegments;vertex.x=-radius*Math.cos(phiStart+u*phiLength)*Math.sin(thetaStart+v*thetaLength);vertex.y=radius*Math.cos(thetaStart+v*thetaLength);vertex.z=radius*Math.sin(phiStart+u*phiLength)*Math.sin(thetaStart+v*thetaLength);vertices.push(vertex.x,vertex.y,vertex.z);Vec3Normalize(vertex,normal);normals.push(normal.x,normal.y,normal.z);uvs.push(u+uOffset,1-v);verticesRow.push(index++);}grid.push(verticesRow);}for(var iy1=0;iy1<heightSegments;iy1++){for(var ix=0;ix<widthSegments;ix++){var a=grid[iy1][ix+1];var b=grid[iy1][ix];var c=grid[iy1+1][ix];var d=grid[iy1+1][ix+1];if(iy1!==0||thetaStart>0){indices.push(a,b,d);}if(iy1!==heightSegments-1||thetaEnd<Math.PI){indices.push(b,c,d);}}}data.numberOfVertices=vertices.length;return data;}var Sphere=function(Mesh1){"use strict";swcHelpers.inherits(_class3,Mesh1);function _class3(param,param1,param2,param3,param4,param5,param6,param7,param8,param9){var x=param=== void 0?0:param,y2=param1=== void 0?0:param1,z=param2=== void 0?0:param2,radius=param3=== void 0?1:param3,widthSegments=param4=== void 0?3:param4,heightSegments=param5=== void 0?3:param5,phiStart=param6=== void 0?0:param6,phiLength=param7=== void 0?Math.PI*2:param7,thetaStart=param8=== void 0?0:param8,thetaLength=param9=== void 0?Math.PI:param9;swcHelpers.classCallCheck(this,_class3);var data=SphereGeometry(radius,widthSegments,heightSegments,phiStart,phiLength,thetaStart,thetaLength);var geometry=new Geometry(data);return swcHelpers.possibleConstructorReturn(this,swcHelpers.getPrototypeOf(_class3).call(this,x,y2,z,geometry));}return _class3;}(Mesh);var geom_exports={};__export(geom_exports,{Circle:function(){return circle_exports;},Ellipse:function(){return ellipse_exports;},Intersects:function(){return intersects_exports;},Line:function(){return line_exports;},Rectangle:function(){return rectangle_exports;},Triangle:function(){return triangle_exports;}});var circle_exports={};__export(circle_exports,{Circle:function(){return Circle;},CircleContains:function(){return CircleContains;},CircleContainsPoint:function(){return CircleContainsPoint;},CircleContainsRect:function(){return CircleContainsRect;},CircleEquals:function(){return CircleEquals;},CloneCircle:function(){return CloneCircle;},CopyCircleFrom:function(){return CopyCircleFrom;},GetCircleArea:function(){return GetCircleArea;},GetCircleBounds:function(){return GetCircleBounds;},GetCircleCircumference:function(){return GetCircleCircumference;},GetCircleCircumferencePoint:function(){return GetCircleCircumferencePoint;},GetCirclePoint:function(){return GetCirclePoint;},GetCirclePoints:function(){return GetCirclePoints;},GetCircleRandomPoint:function(){return GetCircleRandomPoint;},TranslateCircle:function(){return TranslateCircle;},TranslateCirclePoint:function(){return TranslateCirclePoint;}});function CircleContains(circle,x,y2){if(circle.radius>0&&x>=circle.left&&x<=circle.right&&y2>=circle.top&&y2<=circle.bottom){var dx=(circle.x-x)*(circle.x-x);var dy=(circle.y-y2)*(circle.y-y2);return dx+dy<=circle.radius*circle.radius;}else{return false;}}var Circle=function(){"use strict";function _class3(param,param1,param2){var x=param=== void 0?0:param,y2=param1=== void 0?0:param1,radius=param2=== void 0?0:param2;swcHelpers.classCallCheck(this,_class3);this.set(x,y2,radius);}swcHelpers.createClass(_class3,[{key:"set",value:function set(param,param1,param2){var x=param=== void 0?0:param,y2=param1=== void 0?0:param1,radius=param2=== void 0?0:param2;this.x=x;this.y=y2;this.radius=radius;return this;}},{key:"contains",value:function contains(x,y2){return CircleContains(this,x,y2);}},{key:"radius",get:function get(){return this._radius;},set:function set(value){this._radius=value;this._diameter=value*2;}},{key:"diameter",get:function get(){return this._diameter;},set:function set(value){this._diameter=value;this._radius=value*0.5;}},{key:"left",get:function get(){return this.x-this._radius;},set:function set(value){this.x=value+this._radius;}},{key:"right",get:function get(){return this.x+this._radius;},set:function set(value){this.x=value-this._radius;}},{key:"top",get:function get(){return this.y-this._radius;},set:function set(value){this.y=value+this._radius;}},{key:"bottom",get:function get(){return this.y+this._radius;},set:function set(value){this.y=value-this._radius;}}]);return _class3;}();function CircleContainsPoint(circle,point){return CircleContains(circle,point.x,point.y);}function CircleContainsRect(circle,rect){return CircleContains(circle,rect.x,rect.y)&&CircleContains(circle,rect.right,rect.y)&&CircleContains(circle,rect.x,rect.bottom)&&CircleContains(circle,rect.right,rect.bottom);}function CircleEquals(circle,toCompare){return circle.x===toCompare.x&&circle.y===toCompare.y&&circle.radius===toCompare.radius;}function CloneCircle(source){return new Circle(source.x,source.y,source.radius);}function CopyCircleFrom(source,dest){return dest.set(source.x,source.y,source.radius);}function GetCircleArea(circle){return circle.radius>0?Math.PI*circle.radius*circle.radius:0;}function GetCircleBounds(circle,param){var out=param=== void 0?new Rectangle():param;return out.set(circle.left,circle.top,circle.diameter,circle.diameter);}function GetCircleCircumference(circle){return 2*(Math.PI*circle.radius);}function GetCircleCircumferencePoint(circle,angle,param){var out=param=== void 0?new Vec2():param;return out.set(circle.x+circle.radius*Math.cos(angle),circle.y+circle.radius*Math.sin(angle));}function GetCirclePoint(circle,position,param){var out=param=== void 0?new Vec2():param;var angle=FromPercent(position,0,MATH_CONST.PI2);return GetCircleCircumferencePoint(circle,angle,out);}function GetCirclePoints(circle,step,param,param1){var quantity=param=== void 0?0:param,out=param1=== void 0?[]:param1;if(!quantity){quantity=GetCircleCircumference(circle)/step;}for(var i8=0;i8<quantity;i8++){var angle=FromPercent(i8/quantity,0,MATH_CONST.PI2);out.push(GetCircleCircumferencePoint(circle,angle));}return out;}function GetCircleRandomPoint(circle,param){var out=param=== void 0?new Vec2():param;var t=2*Math.PI*Math.random();var u=Math.random()+Math.random();var r=u>1?2-u:u;var x=r*Math.cos(t);var y2=r*Math.sin(t);return out.set(circle.x+x*circle.radius,circle.y+y2*circle.radius);}function TranslateCircle(circle,x,y2){circle.x+=x;circle.y+=y2;return circle;}function TranslateCirclePoint(circle,point){circle.x+=point.x;circle.y+=point.y;return circle;}var ellipse_exports={};__export(ellipse_exports,{CloneEllipse:function(){return CloneEllipse;},CopyEllipseFrom:function(){return CopyEllipseFrom;},Ellipse:function(){return Ellipse;},EllipseContains:function(){return EllipseContains;},EllipseContainsPoint:function(){return EllipseContainsPoint;},EllipseContainsRect:function(){return EllipseContainsRect;},EllipseEquals:function(){return EllipseEquals;},GetEllipseArea:function(){return GetEllipseArea;},GetEllipseBounds:function(){return GetEllipseBounds;},GetEllipseCircumference:function(){return GetEllipseCircumference;},GetEllipseCircumferencePoint:function(){return GetEllipseCircumferencePoint;},GetEllipsePoint:function(){return GetEllipsePoint;},GetEllipsePoints:function(){return GetEllipsePoints;},GetEllipseRandomPoint:function(){return GetEllipseRandomPoint;},TranslateEllipse:function(){return TranslateEllipse;},TranslateEllipsePoint:function(){return TranslateEllipsePoint;}});function EllipseContains(ellipse,x,y2){if(ellipse.width<=0||ellipse.height<=0){return false;}var normx=(x-ellipse.x)/ellipse.width;var normy=(y2-ellipse.y)/ellipse.height;normx*=normx;normy*=normy;return normx+normy<0.25;}var Ellipse=function(){"use strict";function _class3(param,param1,param2,param3){var x=param=== void 0?0:param,y2=param1=== void 0?0:param1,width=param2=== void 0?0:param2,height=param3=== void 0?0:param3;swcHelpers.classCallCheck(this,_class3);this.set(x,y2,width,height);}swcHelpers.createClass(_class3,[{key:"set",value:function set(param,param1,param2,param3){var x=param=== void 0?0:param,y2=param1=== void 0?0:param1,width=param2=== void 0?0:param2,height=param3=== void 0?0:param3;this.x=x;this.y=y2;this.width=width;this.height=height;return this;}},{key:"contains",value:function contains(x,y2){return EllipseContains(this,x,y2);}},{key:"getMinorRadius",value:function getMinorRadius(){return Math.min(this.width,this.height)/2;}},{key:"getMajorRadius",value:function getMajorRadius(){return Math.max(this.width,this.height)/2;}},{key:"left",get:function get(){return this.x-this.width/2;},set:function set(value){this.x=value+this.width/2;}},{key:"right",get:function get(){return this.x+this.width/2;},set:function set(value){this.x=value-this.width/2;}},{key:"top",get:function get(){return this.y-this.height/2;},set:function set(value){this.y=value+this.height/2;}},{key:"bottom",get:function get(){return this.y+this.height/2;},set:function set(value){this.y=value-this.height/2;}}]);return _class3;}();function CloneEllipse(source){return new Ellipse(source.x,source.y,source.width,source.height);}function CopyEllipseFrom(source,dest){return dest.set(source.x,source.y,source.width,source.height);}function EllipseContainsPoint(ellipse,point){return EllipseContains(ellipse,point.x,point.y);}function EllipseContainsRect(ellipse,rect){return EllipseContains(ellipse,rect.x,rect.y)&&EllipseContains(ellipse,rect.right,rect.y)&&EllipseContains(ellipse,rect.x,rect.bottom)&&EllipseContains(ellipse,rect.right,rect.bottom);}function EllipseEquals(ellipse,toCompare){return ellipse.x===toCompare.x&&ellipse.y===toCompare.y&&ellipse.width===toCompare.width&&ellipse.height===toCompare.height;}function GetEllipseArea(ellipse){if(ellipse.width<=0||ellipse.height<=0){return 0;}return ellipse.getMajorRadius()*ellipse.getMinorRadius()*Math.PI;}function GetEllipseBounds(ellipse,param){var out=param=== void 0?new Rectangle():param;return out.set(ellipse.left,ellipse.top,ellipse.width,ellipse.height);}function GetEllipseCircumference(ellipse){var rx=ellipse.width/2;var ry=ellipse.height/2;var h=Math.pow(rx-ry,2)/Math.pow(rx+ry,2);return Math.PI*(rx+ry)*(1+3*h/(10+Math.sqrt(4-3*h)));}function GetEllipseCircumferencePoint(ellipse,angle,param){var out=param=== void 0?new Vec2():param;var halfWidth=ellipse.width/2;var halfHeight=ellipse.height/2;return out.set(ellipse.x+halfWidth*Math.cos(angle),ellipse.y+halfHeight*Math.sin(angle));}function GetEllipsePoint(ellipse,position,param){var out=param=== void 0?new Vec2():param;var angle=FromPercent(position,0,MATH_CONST.PI2);return GetEllipseCircumferencePoint(ellipse,angle,out);}function GetEllipsePoints(ellipse,step,param,param1){var quantity=param=== void 0?0:param,out=param1=== void 0?[]:param1;if(!quantity){quantity=GetEllipseCircumference(ellipse)/step;}for(var i8=0;i8<quantity;i8++){var angle=FromPercent(i8/quantity,0,MATH_CONST.PI2);out.push(GetEllipseCircumferencePoint(ellipse,angle));}return out;}function GetEllipseRandomPoint(ellipse,param){var out=param=== void 0?new Vec2():param;var p=Math.random()*Math.PI*2;var s=Math.sqrt(Math.random());out.x=ellipse.x+s*Math.cos(p)*ellipse.width/2;out.y=ellipse.y+s*Math.sin(p)*ellipse.height/2;return out;}function TranslateEllipse(ellipse,x,y2){ellipse.x+=x;ellipse.y+=y2;return ellipse;}function TranslateEllipsePoint(ellipse,point){ellipse.x+=point.x;ellipse.y+=point.y;return ellipse;}var intersects_exports={};__export(intersects_exports,{CircleToCircle:function(){return CircleToCircle;},CircleToRectangle:function(){return CircleToRectangle;},GetCircleToCircle:function(){return GetCircleToCircle;},GetCircleToRectangle:function(){return GetCircleToRectangle;},GetLineToCircle:function(){return GetLineToCircle;},GetLineToRectangle:function(){return GetLineToRectangle;},GetRectangleIntersection:function(){return GetRectangleIntersection2;},GetRectangleToRectangle:function(){return GetRectangleToRectangle;},GetRectangleToTriangle:function(){return GetRectangleToTriangle;},GetTriangleToCircle:function(){return GetTriangleToCircle;},GetTriangleToLine:function(){return GetTriangleToLine;},GetTriangleToTriangle:function(){return GetTriangleToTriangle;},LineToCircle:function(){return LineToCircle;},LineToLine:function(){return LineToLine;},LineToRectangle:function(){return LineToRectangle;},PointToLine:function(){return PointToLine;},PointToLineSegment:function(){return PointToLineSegment;},RectangleToRectangle:function(){return RectangleToRectangle;},RectangleToTriangle:function(){return RectangleToTriangle;},TriangleToCircle:function(){return TriangleToCircle;},TriangleToLine:function(){return TriangleToLine;},TriangleToTriangle:function(){return TriangleToTriangle;}});function CircleToCircle(circleA,circleB){return GetVec2Distance(circleA,circleB)<=circleA.radius+circleB.radius;}function CircleToRectangle(circle,rect){var halfWidth=rect.width/2;var halfHeight=rect.height/2;var cx=Math.abs(circle.x-rect.x-halfWidth);var cy=Math.abs(circle.y-rect.y-halfHeight);var xDist=halfWidth+circle.radius;var yDist=halfHeight+circle.radius;if(cx>xDist||cy>yDist){return false;}else if(cx<=halfWidth||cy<=halfHeight){return true;}else{var xCornerDist=cx-halfWidth;var yCornerDist=cy-halfHeight;var xCornerDistSq=xCornerDist*xCornerDist;var yCornerDistSq=yCornerDist*yCornerDist;var maxCornerDistSq=circle.radius*circle.radius;return xCornerDistSq+yCornerDistSq<=maxCornerDistSq;}}function GetCircleToCircle(circleA,circleB,param){var out=param=== void 0?[]:param;if(CircleToCircle(circleA,circleB)){var x0=circleA.x;var y0=circleA.y;var r0=circleA.radius;var x1=circleB.x;var y11=circleB.y;var r1=circleB.radius;var coefficientA;var coefficientB;var coefficientC;var lambda;var x;if(y0===y11){x=(r1*r1-r0*r0-x1*x1+x0*x0)/(2*(x0-x1));coefficientA=1;coefficientB=-2*y11;coefficientC=x1*x1+x*x-2*x1*x+y11*y11-r1*r1;lambda=coefficientB*coefficientB-4*coefficientA*coefficientC;if(lambda===0){out.push(new Vec2(x,-coefficientB/(2*coefficientA)));}else if(lambda>0){out.push(new Vec2(x,(-coefficientB+Math.sqrt(lambda))/(2*coefficientA)));out.push(new Vec2(x,(-coefficientB-Math.sqrt(lambda))/(2*coefficientA)));}}else{var v1=(x0-x1)/(y0-y11);var n=(r1*r1-r0*r0-x1*x1+x0*x0-y11*y11+y0*y0)/(2*(y0-y11));coefficientA=v1*v1+1;coefficientB=2*y0*v1-2*n*v1-2*x0;coefficientC=x0*x0+y0*y0+n*n-r0*r0-2*y0*n;lambda=coefficientB*coefficientB-4*coefficientA*coefficientC;if(lambda===0){x=-coefficientB/(2*coefficientA);out.push(new Vec2(x,n-x*v1));}else if(lambda>0){x=(-coefficientB+Math.sqrt(lambda))/(2*coefficientA);out.push(new Vec2(x,n-x*v1));x=(-coefficientB-Math.sqrt(lambda))/(2*coefficientA);out.push(new Vec2(x,n-x*v1));}}}return out;}var tmp=new Vec2();function LineToCircle(line,circle,nearest){if(!nearest){nearest=tmp;}var x1=line.x1,y12=line.y1,x2=line.x2,y2=line.y2;if(CircleContains(circle,x1,y12)){nearest.set(x1,y12);return true;}if(CircleContains(circle,x2,y2)){nearest.set(x2,y2);return true;}var dx=x2-x1;var dy=y2-y12;var lcx=circle.x-x1;var lcy=circle.y-y12;var dLen2=dx*dx+dy*dy;var px=dx;var py=dy;if(dLen2>0){var dp=(lcx*dx+lcy*dy)/dLen2;px*=dp;py*=dp;}nearest.set(x1+px,y12+py);var pLen2=px*px+py*py;return pLen2<=dLen2&&px*dx+py*dy>=0&&CircleContains(circle,nearest.x,nearest.y);}function GetLineToCircle(line,circle,param){var out=param=== void 0?[]:param;if(LineToCircle(line,circle)){var x1=line.x1,y12=line.y1,x2=line.x2,y2=line.y2;var cr=circle.radius;var lDirX=x2-x1;var lDirY=y2-y12;var oDirX=x1-circle.x;var oDirY=y12-circle.y;var coefficientA=lDirX*lDirX+lDirY*lDirY;var coefficientB=2*(lDirX*oDirX+lDirY*oDirY);var coefficientC=oDirX*oDirX+oDirY*oDirY-cr*cr;var lambda=coefficientB*coefficientB-4*coefficientA*coefficientC;var x;var y3;if(lambda===0){var root=-coefficientB/(2*coefficientA);x=x1+root*lDirX;y3=y12+root*lDirY;if(root>=0&&root<=1){out.push(new Vec2(x,y3));}}else if(lambda>0){var root1=(-coefficientB-Math.sqrt(lambda))/(2*coefficientA);x=x1+root1*lDirX;y3=y12+root1*lDirY;if(root1>=0&&root1<=1){out.push(new Vec2(x,y3));}var root2=(-coefficientB+Math.sqrt(lambda))/(2*coefficientA);x=x1+root2*lDirX;y3=y12+root2*lDirY;if(root2>=0&&root2<=1){out.push(new Vec2(x,y3));}}}return out;}function GetCircleToRectangle(circle,rect,param){var out=param=== void 0?[]:param;if(CircleToRectangle(circle,rect)){var ref=GetRectangleEdges(rect),line1=ref[0],line2=ref[1],line3=ref[2],line4=ref[3];GetLineToCircle(line1,circle,out);GetLineToCircle(line2,circle,out);GetLineToCircle(line3,circle,out);GetLineToCircle(line4,circle,out);}return out;}function LineToLine(line1,line2,out){var x1=line1.x1,y13=line1.y1,x2=line1.x2,y2=line1.y2;var x3=line2.x1,y31=line2.y1,x4=line2.x2,y4=line2.y2;var numA=(x4-x3)*(y13-y31)-(y4-y31)*(x1-x3);var numB=(x2-x1)*(y13-y31)-(y2-y13)*(x1-x3);var deNom=(y4-y31)*(x2-x1)-(x4-x3)*(y2-y13);if(deNom===0){return false;}var uA=numA/deNom;var uB=numB/deNom;if(uA>=0&&uA<=1&&uB>=0&&uB<=1){if(out){out.set(x1+uA*(x2-x1),y13+uA*(y2-y13));}return true;}return false;}function LineToRectangle(line,rect){var x1=line.x1,y13=line.y1,x2=line.x2,y2=line.y2;var x=rect.x,y4=rect.y,right=rect.right,bottom=rect.bottom;var t=0;if(x1>=x&&x1<=right&&y13>=y4&&y13<=bottom||x2>=x&&x2<=right&&y2>=y4&&y2<=bottom){return true;}if(x1<x&&x2>=x){t=y13+(y2-y13)*(x-x1)/(x2-x1);if(t>y4&&t<=bottom){return true;}}else if(x1>right&&x2<=right){t=y13+(y2-y13)*(right-x1)/(x2-x1);if(t>=y4&&t<=bottom){return true;}}if(y13<y4&&y2>=y4){t=x1+(x2-x1)*(y4-y13)/(y2-y13);if(t>=x&&t<=right){return true;}}else if(y13>bottom&&y2<=bottom){t=x1+(x2-x1)*(bottom-y13)/(y2-y13);if(t>=x&&t<=right){return true;}}return false;}function GetLineToRectangle(line,rect,param){var out=param=== void 0?[]:param;if(LineToRectangle(line,rect)){var ref=GetRectangleEdges(rect),lineA=ref[0],lineB=ref[1],lineC=ref[2],lineD=ref[3];var points=[new Vec2(),new Vec2(),new Vec2(),new Vec2()];var results=[LineToLine(lineA,line,points[0]),LineToLine(lineB,line,points[1]),LineToLine(lineC,line,points[2]),LineToLine(lineD,line,points[3])];for(var i8=0;i8<results.length;i8++){if(results[i8]){out.push(points[i8]);}}}return out;}function GetRectangleIntersection2(rectA,rectB,param){var out=param=== void 0?new Rectangle():param;if(RectangleToRectangle(rectA,rectB)){var x=Math.max(rectA.x,rectB.x);var y2=Math.max(rectA.y,rectB.y);return out.set(x,y2,Math.min(rectA.right,rectB.right)-x,Math.min(rectA.bottom,rectB.bottom)-y2);}}function GetRectangleToRectangle(rectA,rectB,param){var out=param=== void 0?[]:param;if(RectangleToRectangle(rectA,rectB)){var ref=GetRectangleEdges(rectA),lineA=ref[0],lineB=ref[1],lineC=ref[2],lineD=ref[3];GetLineToRectangle(lineA,rectB,out);GetLineToRectangle(lineB,rectB,out);GetLineToRectangle(lineC,rectB,out);GetLineToRectangle(lineD,rectB,out);}return out;}function GetTriangleEdges(triangle){var x1=triangle.x1,y13=triangle.y1,x2=triangle.x2,y21=triangle.y2,x3=triangle.x3,y31=triangle.y3;var edge1=new Line(x1,y13,x2,y21);var edge2=new Line(x2,y21,x3,y31);var edge3=new Line(x3,y31,x1,y13);return [edge1,edge2,edge3];}function TriangleContains(triangle,x,y4){var x1=triangle.x1,y13=triangle.y1,x2=triangle.x2,y21=triangle.y2,x3=triangle.x3,y31=triangle.y3;var v0x=x3-x1;var v0y=y31-y13;var v1x=x2-x1;var v1y=y21-y13;var v2x=x-x1;var v2y=y4-y13;var dot00=v0x*v0x+v0y*v0y;var dot01=v0x*v1x+v0y*v1y;var dot02=v0x*v2x+v0y*v2y;var dot11=v1x*v1x+v1y*v1y;var dot12=v1x*v2x+v1y*v2y;var b=dot00*dot11-dot01*dot01;var inv=b===0?0:1/b;var u=(dot11*dot02-dot01*dot12)*inv;var v=(dot00*dot12-dot01*dot02)*inv;return u>=0&&v>=0&&u+v<1;}function TriangleContainsPoints(triangle,points,param,param1){var returnFirst=param=== void 0?false:param,out=param1=== void 0?[]:param1;var skip=false;points.forEach(function(point){if(skip){return;}var x=point.x,y4=point.y;if(TriangleContains(triangle,x,y4)){out.push(new Vec2(x,y4));if(returnFirst){skip=true;}}});return out;}function RectangleToTriangle(rect,triangle){if(triangle.left>rect.right||triangle.right<rect.x||triangle.top>rect.bottom||triangle.bottom<rect.y){return false;}var ref=GetTriangleEdges(triangle),triA=ref[0],triB=ref[1],triC=ref[2];if(RectangleContains(rect,triA.x1,triA.y1)||RectangleContains(rect,triA.x2,triA.y2)){return true;}if(RectangleContains(rect,triB.x1,triB.y1)||RectangleContains(rect,triB.x2,triB.y2)){return true;}if(RectangleContains(rect,triC.x1,triC.y1)||RectangleContains(rect,triC.x2,triC.y2)){return true;}var ref1=GetRectangleEdges(rect),rectA=ref1[0],rectB=ref1[1],rectC=ref1[2],rectD=ref1[3];if(LineToLine(triA,rectA)||LineToLine(triA,rectB)||LineToLine(triA,rectC)||LineToLine(triA,rectD)){return true;}if(LineToLine(triB,rectA)||LineToLine(triB,rectB)||LineToLine(triB,rectC)||LineToLine(triB,rectD)){return true;}if(LineToLine(triC,rectA)||LineToLine(triC,rectB)||LineToLine(triC,rectC)||LineToLine(triC,rectD)){return true;}var within=TriangleContainsPoints(triangle,DecomposeRectangle(rect),true);return within.length>0;}function GetRectangleToTriangle(rect,triangle,param){var out=param=== void 0?[]:param;if(RectangleToTriangle(rect,triangle)){var ref=GetTriangleEdges(triangle),lineA=ref[0],lineB=ref[1],lineC=ref[2];GetLineToRectangle(lineA,rect,out);GetLineToRectangle(lineB,rect,out);GetLineToRectangle(lineC,rect,out);}return out;}function TriangleToCircle(triangle,circle){if(triangle.left>circle.right||triangle.right<circle.left||triangle.top>circle.bottom||triangle.bottom<circle.top){return false;}if(TriangleContains(triangle,circle.x,circle.y)){return true;}var ref=GetTriangleEdges(triangle),line1=ref[0],line2=ref[1],line3=ref[2];return LineToCircle(line1,circle)||LineToCircle(line2,circle)||LineToCircle(line3,circle);}function GetTriangleToCircle(triangle,circle,param){var out=param=== void 0?[]:param;if(TriangleToCircle(triangle,circle)){var ref=GetTriangleEdges(triangle),lineA=ref[0],lineB=ref[1],lineC=ref[2];GetLineToCircle(lineA,circle,out);GetLineToCircle(lineB,circle,out);GetLineToCircle(lineC,circle,out);}return out;}function TriangleToLine(triangle,line){var x1=line.x1,y13=line.y1,x2=line.x2,y21=line.y2;if(TriangleContains(triangle,x1,y13)||TriangleContains(triangle,x2,y21)){return true;}var ref=GetTriangleEdges(triangle),line1=ref[0],line2=ref[1],line3=ref[2];return LineToLine(line1,line)||LineToLine(line2,line)||LineToLine(line3,line);}function GetTriangleToLine(triangle,line,param){var out=param=== void 0?[]:param;if(TriangleToLine(triangle,line)){var ref=GetTriangleEdges(triangle),lineA=ref[0],lineB=ref[1],lineC=ref[2];var points=[new Vec2(),new Vec2(),new Vec2()];var results=[LineToLine(lineA,line,points[0]),LineToLine(lineB,line,points[1]),LineToLine(lineC,line,points[2])];for(var i9=0;i9<results.length;i9++){if(results[i9]){out.push(points[i9]);}}}return out;}function DecomposeTriangle(triangle,param){var out=param=== void 0?[]:param;var x1=triangle.x1,y13=triangle.y1,x2=triangle.x2,y21=triangle.y2,x3=triangle.x3,y31=triangle.y3;out.push(new Vec2(x1,y13),new Vec2(x2,y21),new Vec2(x3,y31));return out;}function TriangleToTriangle(triangleA,triangleB){if(triangleA.left>triangleB.right||triangleA.right<triangleB.left||triangleA.top>triangleB.bottom||triangleA.bottom<triangleB.top){return false;}var ref=GetTriangleEdges(triangleA),lineAA=ref[0],lineAB=ref[1],lineAC=ref[2];var ref1=GetTriangleEdges(triangleB),lineBA=ref1[0],lineBB=ref1[1],lineBC=ref1[2];if(LineToLine(lineAA,lineBA)||LineToLine(lineAA,lineBB)||LineToLine(lineAA,lineBC)||LineToLine(lineAB,lineBA)||LineToLine(lineAB,lineBB)||LineToLine(lineAB,lineBC)||LineToLine(lineAC,lineBA)||LineToLine(lineAC,lineBB)||LineToLine(lineAC,lineBC)){return true;}var withinA=TriangleContainsPoints(triangleB,DecomposeTriangle(triangleA),true);if(withinA.length>0){return true;}var withinB=TriangleContainsPoints(triangleA,DecomposeTriangle(triangleB),true);return withinB.length>0;}function GetTriangleToTriangle(triangleA,triangleB,param){var out=param=== void 0?[]:param;if(TriangleToTriangle(triangleA,triangleB)){var ref=GetTriangleEdges(triangleB),lineA=ref[0],lineB=ref[1],lineC=ref[2];GetTriangleToLine(triangleA,lineA,out);GetTriangleToLine(triangleA,lineB,out);GetTriangleToLine(triangleA,lineC,out);}return out;}function PointToLine(point,line,param){var lineThickness=param=== void 0?1:param;var x1=line.x1,y13=line.y1,x2=line.x2,y21=line.y2;var px=point.x,py=point.y;var L2=(x2-x1)*(x2-x1)+(y21-y13)*(y21-y13);if(L2===0){return false;}var r=((px-x1)*(x2-x1)+(py-y13)*(y21-y13))/L2;if(r<0){return Math.sqrt((x1-px)*(x1-px)+(y13-py)*(y13-py))<=lineThickness;}else if(r>=0&&r<=1){var s=((y13-py)*(x2-x1)-(x1-px)*(y21-y13))/L2;return Math.abs(s)*Math.sqrt(L2)<=lineThickness;}else{return Math.sqrt((x2-px)*(x2-px)+(y21-py)*(y21-py))<=lineThickness;}}function PointToLineSegment(point,line){if(!PointToLine(point,line)){return false;}var x1=line.x1,y13=line.y1,x2=line.x2,y21=line.y2;var x=point.x,y4=point.y;var xMin=Math.min(x1,x2);var xMax=Math.max(x1,x2);var yMin=Math.min(y13,y21);var yMax=Math.max(y13,y21);return x>=xMin&&x<=xMax&&y4>=yMin&&y4<=yMax;}var line_exports={};__export(line_exports,{CenterLineOn:function(){return CenterLineOn;},CloneLine:function(){return CloneLine;},CopyLineFrom:function(){return CopyLineFrom;},ExtendLine:function(){return ExtendLine;},GetLineAngle:function(){return GetLineAngle;},GetLineBresenhamPoints:function(){return GetLineBresenhamPoints;},GetLineHeight:function(){return GetLineHeight;},GetLineLength:function(){return GetLineLength;},GetLineMidPoint:function(){return GetLineMidPoint;},GetLineNearestPoint:function(){return GetLineNearestPoint;},GetLineNormal:function(){return GetLineNormal;},GetLineNormalAngle:function(){return GetLineNormalAngle;},GetLineNormalX:function(){return GetLineNormalX;},GetLineNormalY:function(){return GetLineNormalY;},GetLinePerpSlope:function(){return GetLinePerpSlope;},GetLinePoint:function(){return GetLinePoint;},GetLinePoints:function(){return GetLinePoints;},GetLineRandomPoint:function(){return GetLineRandomPoint;},GetLineReflectAngle:function(){return GetLineReflectAngle;},GetLineSlope:function(){return GetLineSlope;},GetLineWidth:function(){return GetLineWidth;},GetShortestLineDistance:function(){return GetShortestLineDistance;},Line:function(){return Line;},LineEquals:function(){return LineEquals;},LineSetToAngle:function(){return LineSetToAngle;},RotateLine:function(){return RotateLine;},RotateLineAround:function(){return RotateLineAround;},RotateLineAroundPoint:function(){return RotateLineAroundPoint;},TranslateLine:function(){return TranslateLine;},TranslateLinePoint:function(){return TranslateLinePoint;}});function CenterLineOn(line,x,y4){var tx=x-(line.x1+line.x2)/2;var ty=y4-(line.y1+line.y2)/2;line.x1+=tx;line.y1+=ty;line.x2+=tx;line.y2+=ty;return line;}function CloneLine(source){return new Line(source.x1,source.y1,source.x2,source.y2);}function CopyLineFrom(source,dest){return dest.set(source.x1,source.y1,source.x2,source.y2);}function GetLineLength(line){var x1=line.x1,y13=line.y1,x2=line.x2,y21=line.y2;return Math.sqrt((x2-x1)*(x2-x1)+(y21-y13)*(y21-y13));}function ExtendLine(line,left,param){var right=param=== void 0?left:param;var length=GetLineLength(line);var slopX=line.x2-line.x1;var slopY=line.y2-line.y1;if(left){line.x1=line.x1-slopX/length*left;line.y1=line.y1-slopY/length*left;}if(right){line.x2=line.x2+slopX/length*right;line.y2=line.y2+slopY/length*right;}return line;}function GetLineAngle(line){return Math.atan2(line.y2-line.y1,line.x2-line.x1);}function GetLineBresenhamPoints(line,param,param1){var stepRate=param=== void 0?1:param,results=param1=== void 0?[]:param1;var x1=Math.round(line.x1);var y13=Math.round(line.y1);var x2=Math.round(line.x2);var y21=Math.round(line.y2);var dx=Math.abs(x2-x1);var dy=Math.abs(y21-y13);var sx=x1<x2?1:-1;var sy=y13<y21?1:-1;var err=dx-dy;results.push(new Vec2(x1,y13));var i10=1;while(!(x1===x2&&y13===y21)){var e2=err<<1;if(e2> -dy){err-=dy;x1+=sx;}if(e2<dx){err+=dx;y13+=sy;}if(i10%stepRate===0){results.push(new Vec2(x1,y13));}i10++;}return results;}function GetLineHeight(line){return Math.abs(line.y1-line.y2);}function GetLineMidPoint(line,param){var out=param=== void 0?new Vec2():param;out.x=(line.x1+line.x2)/2;out.y=(line.y1+line.y2)/2;return out;}function GetLineNearestPoint(line,point,param){var out=param=== void 0?new Vec2():param;var x1=line.x1,y13=line.y1,x2=line.x2,y21=line.y2;var L2=(x2-x1)*(x2-x1)+(y21-y13)*(y21-y13);if(L2===0){return out;}var r=((point.x-x1)*(x2-x1)+(point.y-y13)*(y21-y13))/L2;out.x=x1+r*(x2-x1);out.y=y13+r*(y21-y13);return out;}function GetLineNormal(line,param){var out=param=== void 0?new Vec2():param;var a=GetLineAngle(line)-MATH_CONST.HALF_PI;out.x=Math.cos(a);out.y=Math.sin(a);return out;}function GetLineNormalAngle(line){var angle=GetLineAngle(line)-MATH_CONST.HALF_PI;return Wrap(angle,-Math.PI,Math.PI);}function GetLineNormalX(line){return Math.cos(GetLineAngle(line)-MATH_CONST.HALF_PI);}function GetLineNormalY(line){return Math.sin(GetLineAngle(line)-MATH_CONST.HALF_PI);}function GetLinePerpSlope(line){var x1=line.x1,y13=line.y1,x2=line.x2,y21=line.y2;return -((x2-x1)/(y21-y13));}function GetLinePoint(line,position,param){var out=param=== void 0?new Vec2():param;out.x=line.x1+(line.x2-line.x1)*position;out.y=line.y1+(line.y2-line.y1)*position;return out;}function GetLinePoints(line,quantity,param,param1){var stepRate=param=== void 0?0:param,out=param1=== void 0?[]:param1;if(!quantity){quantity=GetLineLength(line)/stepRate;}var x1=line.x1,y13=line.y1,x2=line.x2,y21=line.y2;for(var i10=0;i10<quantity;i10++){var position=i10/quantity;var x=x1+(x2-x1)*position;var y4=y13+(y21-y13)*position;out.push(new Vec2(x,y4));}return out;}function GetLineRandomPoint(line,param){var out=param=== void 0?new Vec2():param;var t=Math.random();out.x=line.x1+t*(line.x2-line.x1);out.y=line.y1+t*(line.y2-line.y1);return out;}function GetLineReflectAngle(lineA,lineB){return 2*GetLineNormalAngle(lineB)-Math.PI-GetLineAngle(lineA);}function GetLineSlope(line){var x1=line.x1,y13=line.y1,x2=line.x2,y21=line.y2;return (y21-y13)/(x2-x1);}function GetLineWidth(line){return Math.abs(line.x1-line.x2);}function GetShortestLineDistance(line,point){var x1=line.x1,y13=line.y1,x2=line.x2,y21=line.y2;var L2=(x2-x1)*(x2-x1)+(y21-y13)*(y21-y13);if(L2===0){return 0;}var s=((y13-point.y)*(x2-x1)-(x1-point.x)*(y21-y13))/L2;return Math.abs(s)*Math.sqrt(L2);}function LineEquals(line,toCompare){return line.x1===toCompare.x1&&line.y1===toCompare.y1&&line.x2===toCompare.x2&&line.y2===toCompare.y2;}function LineSetToAngle(line,x,y5,angle,length){line.x1=x;line.y1=y5;line.x2=x+Math.cos(angle)*length;line.y2=y5+Math.sin(angle)*length;return line;}function RotateLineAround(line,x,y5,angle){var c=Math.cos(angle);var s=Math.sin(angle);var tx=line.x1-x;var ty=line.y1-y5;line.x1=tx*c-ty*s+x;line.y1=tx*s+ty*c+y5;tx=line.x2-x;ty=line.y2-y5;line.x2=tx*c-ty*s+x;line.y2=tx*s+ty*c+y5;return line;}function RotateLine(line,angle){var x=(line.x1+line.x2)/2;var y5=(line.y1+line.y2)/2;return RotateLineAround(line,x,y5,angle);}function RotateLineAroundPoint(line,point,angle){return RotateLineAround(line,point.x,point.y,angle);}function TranslateLine(line,x,y5){line.x1+=x;line.y1+=y5;line.x2+=x;line.y2+=y5;return line;}function TranslateLinePoint(line,v){return TranslateLine(line,v.x,v.y);}var triangle_exports={};__export(triangle_exports,{BuildEquilateralTriangle:function(){return BuildEquilateralTriangle;},BuildRightTriangle:function(){return BuildRightTriangle;},CenterTriangleOn:function(){return CenterTriangleOn;},CloneTriangle:function(){return CloneTriangle;},CopyTriangleFrom:function(){return CopyTriangleFrom;},DecomposeTriangle:function(){return DecomposeTriangle;},GetTriangleArea:function(){return GetTriangleArea;},GetTriangleCentroid:function(){return GetTriangleCentroid;},GetTriangleCircumCenter:function(){return GetTriangleCircumCenter;},GetTriangleCircumCircle:function(){return GetTriangleCircumCircle;},GetTriangleEdges:function(){return GetTriangleEdges;},GetTriangleInCenter:function(){return GetTriangleInCenter;},GetTrianglePerimeter:function(){return GetTrianglePerimeter;},GetTrianglePoint:function(){return GetTrianglePoint;},GetTrianglePoints:function(){return GetTrianglePoints;},GetTriangleRandomPoint:function(){return GetTriangleRandomPoint;},RotateTriangle:function(){return RotateTriangle;},RotateTriangleAround:function(){return RotateTriangleAround;},RotateTriangleAroundPoint:function(){return RotateTriangleAroundPoint;},TranslateTriangle:function(){return TranslateTriangle;},Triangle:function(){return Triangle;},TriangleContains:function(){return TriangleContains;},TriangleContainsPoint:function(){return TriangleContainsPoint;},TriangleContainsPoints:function(){return TriangleContainsPoints;},TriangleEquals:function(){return TriangleEquals;}});var Triangle=function(){"use strict";function _class3(param,param1,param2,param3,param4,param5){var x1=param=== void 0?0:param,y13=param1=== void 0?0:param1,x2=param2=== void 0?0:param2,y21=param3=== void 0?0:param3,x3=param4=== void 0?0:param4,y31=param5=== void 0?0:param5;swcHelpers.classCallCheck(this,_class3);this.set(x1,y13,x2,y21,x3,y31);}swcHelpers.createClass(_class3,[{key:"set",value:function set(param,param1,param2,param3,param4,param5){var x1=param=== void 0?0:param,y13=param1=== void 0?0:param1,x2=param2=== void 0?0:param2,y21=param3=== void 0?0:param3,x3=param4=== void 0?0:param4,y31=param5=== void 0?0:param5;this.x1=x1;this.y1=y13;this.x2=x2;this.y2=y21;this.x3=x3;this.y3=y31;return this;}},{key:"contains",value:function contains(x,y5){return TriangleContains(this,x,y5);}},{key:"left",get:function get(){return Math.min(this.x1,this.x2,this.x3);},set:function set(value){var diff=0;if(this.x1<=this.x2&&this.x1<=this.x3){diff=this.x1-value;}else if(this.x2<=this.x1&&this.x2<=this.x3){diff=this.x2-value;}else{diff=this.x3-value;}this.x1-=diff;this.x2-=diff;this.x3-=diff;}},{key:"right",get:function get(){return Math.max(this.x1,this.x2,this.x3);},set:function set(value){var diff=0;if(this.x1>=this.x2&&this.x1>=this.x3){diff=this.x1-value;}else if(this.x2>=this.x1&&this.x2>=this.x3){diff=this.x2-value;}else{diff=this.x3-value;}this.x1-=diff;this.x2-=diff;this.x3-=diff;}},{key:"top",get:function get(){return Math.min(this.y1,this.y2,this.y3);},set:function set(value){var diff=0;if(this.y1<=this.y2&&this.y1<=this.y3){diff=this.y1-value;}else if(this.y2<=this.y1&&this.y2<=this.y3){diff=this.y2-value;}else{diff=this.y3-value;}this.y1-=diff;this.y2-=diff;this.y3-=diff;}},{key:"bottom",get:function get(){return Math.max(this.y1,this.y2,this.y3);},set:function set(value){var diff=0;if(this.y1>=this.y2&&this.y1>=this.y3){diff=this.y1-value;}else if(this.y2>=this.y1&&this.y2>=this.y3){diff=this.y2-value;}else{diff=this.y3-value;}this.y1-=diff;this.y2-=diff;this.y3-=diff;}}]);return _class3;}();function BuildEquilateralTriangle(x,y5,length){var height=length*(Math.sqrt(3)/2);var x1=x;var y13=y5;var x2=x+length/2;var y21=y5+height;var x3=x-length/2;var y31=y5+height;return new Triangle(x1,y13,x2,y21,x3,y31);}function BuildRightTriangle(x,y5,width,param){var height=param=== void 0?width:param;var x1=x;var y13=y5;var x2=x;var y21=y5-height;var x3=x+width;var y31=y5;return new Triangle(x1,y13,x2,y21,x3,y31);}function GetTriangleCentroid(triangle,param){var out=param=== void 0?new Vec2():param;return out.set((triangle.x1+triangle.x2+triangle.x3)/3,(triangle.y1+triangle.y2+triangle.y3)/3);}function TranslateTriangle(triangle,x,y5){triangle.x1+=x;triangle.y1+=y5;triangle.x2+=x;triangle.y2+=y5;triangle.x3+=x;triangle.y3+=y5;return triangle;}function CenterTriangleOn(triangle,x,y5,param){var centerFunc=param=== void 0?GetTriangleCentroid:param;var center=centerFunc(triangle);var diffX=x-center.x;var diffY=y5-center.y;return TranslateTriangle(triangle,diffX,diffY);}function CloneTriangle(source){var x1=source.x1,y13=source.y1,x2=source.x2,y21=source.y2,x3=source.x3,y31=source.y3;return new Triangle(x1,y13,x2,y21,x3,y31);}function CopyTriangleFrom(source,dest){var x1=source.x1,y13=source.y1,x2=source.x2,y21=source.y2,x3=source.x3,y31=source.y3;return dest.set(x1,y13,x2,y21,x3,y31);}function GetTriangleArea(triangle){var x1=triangle.x1,y13=triangle.y1,x2=triangle.x2,y21=triangle.y2,x3=triangle.x3,y31=triangle.y3;return Math.abs(((x3-x1)*(y21-y13)-(x2-x1)*(y31-y13))/2);}function Det(m00,m01,m10,m11){return m00*m11-m01*m10;}function GetTriangleCircumCenter(triangle,param){var out=param=== void 0?new Vec2():param;var cx=triangle.x3;var cy=triangle.y3;var ax=triangle.x1-cx;var ay=triangle.y1-cy;var bx=triangle.x2-cx;var by=triangle.y2-cy;var denom=2*Det(ax,ay,bx,by);var numx=Det(ay,ax*ax+ay*ay,by,bx*bx+by*by);var numy=Det(ax,ax*ax+ay*ay,bx,bx*bx+by*by);return out.set(cx-numx/denom,cy+numy/denom);}function GetTriangleCircumCircle(triangle,param){var out=param=== void 0?new Circle():param;var x1=triangle.x1,y13=triangle.y1,x2=triangle.x2,y21=triangle.y2,x3=triangle.x3,y31=triangle.y3;var A=x2-x1;var B=y21-y13;var C=x3-x1;var D=y31-y13;var E=A*(x1+x2)+B*(y13+y21);var F=C*(x1+x3)+D*(y13+y31);var G=2*(A*(y31-y21)-B*(x3-x2));if(Math.abs(G)<0.000001){var minX=Math.min(x1,x2,x3);var minY=Math.min(y13,y21,y31);var dx=(Math.max(x1,x2,x3)-minX)*0.5;var dy=(Math.max(y13,y21,y31)-minY)*0.5;return out.set(minX+dx,minY+dy,Math.sqrt(dx*dx+dy*dy));}else{var cx=(D*E-B*F)/G;var cy=(A*F-C*E)/G;var dx=cx-x1;var dy=cy-y13;return out.set(cx,cy,Math.sqrt(dx*dx+dy*dy));}}function GetLength(x1,y13,x2,y21){var x=x1-x2;var y5=y13-y21;return Math.sqrt(x*x+y5*y5);}function GetTriangleInCenter(triangle,param){var out=param=== void 0?new Vec2():param;var x1=triangle.x1,y13=triangle.y1,x2=triangle.x2,y21=triangle.y2,x3=triangle.x3,y31=triangle.y3;var d1=GetLength(x3,y31,x2,y21);var d2=GetLength(x1,y13,x3,y31);var d3=GetLength(x2,y21,x1,y13);var p=d1+d2+d3;return out.set((x1*d1+x2*d2+x3*d3)/p,(y13*d1+y21*d2+y31*d3)/p);}function GetTrianglePerimeter(triangle){var ref=GetTriangleEdges(triangle),line1=ref[0],line2=ref[1],line3=ref[2];return GetLineLength(line1)+GetLineLength(line2)+GetLineLength(line3);}function GetTrianglePoint(triangle,position,param){var out=param=== void 0?new Vec2():param;var ref=GetTriangleEdges(triangle),line1=ref[0],line2=ref[1],line3=ref[2];if(position<=0||position>=1){return out.set(line1.x1,line1.y1);}var length1=GetLineLength(line1);var length2=GetLineLength(line2);var length3=GetLineLength(line3);var perimeter=length1+length2+length3;var p=perimeter*position;var localPosition=0;if(p<length1){localPosition=p/length1;var x1=line1.x1,y13=line1.y1,x2=line1.x2,y21=line1.y2;return out.set(x1+(x2-x1)*localPosition,y13+(y21-y13)*localPosition);}else if(p>length1+length2){p-=length1+length2;localPosition=p/length3;var x1=line3.x1,y14=line3.y1,x2=line3.x2,y22=line3.y2;return out.set(x1+(x2-x1)*localPosition,y14+(y22-y14)*localPosition);}else{p-=length1;localPosition=p/length2;var x1=line2.x1,y15=line2.y1,x2=line2.x2,y23=line2.y2;return out.set(x1+(x2-x1)*localPosition,y15+(y23-y15)*localPosition);}}function GetTrianglePoints(triangle,quantity,stepRate,param){var out=param=== void 0?[]:param;var ref=GetTriangleEdges(triangle),line1=ref[0],line2=ref[1],line3=ref[2];var length1=GetLineLength(line1);var length2=GetLineLength(line2);var length3=GetLineLength(line3);var perimeter=length1+length2+length3;if(!quantity){quantity=perimeter/stepRate;}for(var i10=0;i10<quantity;i10++){var p=perimeter*(i10/quantity);var localPosition=0;var point=void 0;if(p<length1){localPosition=p/length1;var x1=line1.x1,y16=line1.y1,x2=line1.x2,y24=line1.y2;point=new Vec2(x1+(x2-x1)*localPosition,y16+(y24-y16)*localPosition);}else if(p>length1+length2){p-=length1+length2;localPosition=p/length3;var x1=line3.x1,y17=line3.y1,x2=line3.x2,y25=line3.y2;point=new Vec2(x1+(x2-x1)*localPosition,y17+(y25-y17)*localPosition);}else{p-=length1;localPosition=p/length2;var x1=line2.x1,y18=line2.y1,x2=line2.x2,y26=line2.y2;point=new Vec2(x1+(x2-x1)*localPosition,y18+(y26-y18)*localPosition);}out.push(point);}return out;}function GetTriangleRandomPoint(triangle,param){var out=param=== void 0?new Vec2():param;var x1=triangle.x1,y19=triangle.y1,x2=triangle.x2,y27=triangle.y2,x3=triangle.x3,y31=triangle.y3;var ux=x2-x1;var uy=y27-y19;var vx=x3-x1;var vy=y31-y19;var r=Math.random();var s=Math.random();if(r+s>=1){r=1-r;s=1-s;}return out.set(x1+(ux*r+vx*s),y19+(uy*r+vy*s));}function RotateTriangleAround(triangle,x,y5,angle){var x1=triangle.x1,y19=triangle.y1,x2=triangle.x2,y27=triangle.y2,x3=triangle.x3,y31=triangle.y3;var c=Math.cos(angle);var s=Math.sin(angle);return triangle.set((x1-x)*c-(y19-y5)*s+x,(x1-x)*s+(y19-y5)*c+y5,(x2-x)*c-(y27-y5)*s+x,(x2-x)*s+(y27-y5)*c+y5,(x3-x)*c-(y31-y5)*s+x,(x3-x)*s+(y31-y5)*c+y5);}function RotateTriangle(triangle,angle){var point=GetTriangleInCenter(triangle);return RotateTriangleAround(triangle,point.x,point.y,angle);}function RotateTriangleAroundPoint(triangle,point,angle){return RotateTriangleAround(triangle,point.x,point.y,angle);}function TriangleContainsPoint(triangle,point){return TriangleContains(triangle,point.x,point.y);}function TriangleEquals(src,dest){return src.x1===dest.x1&&src.y1===dest.y1&&src.x2===dest.x2&&src.y2===dest.y2&&src.x3===dest.x3&&src.y3===dest.y3;}var geom3d_exports={};__export(geom3d_exports,{BoxGeometry:function(){return BoxGeometry;},ConeGeometry:function(){return ConeGeometry;},CylinderGeometry:function(){return CylinderGeometry;},PlaneGeometry:function(){return PlaneGeometry;},SphereGeometry:function(){return SphereGeometry;},TorusGeometry:function(){return TorusGeometry;}});function TorusGeometry(param,param1,param2,param3,param4){var radius=param=== void 0?1:param,tube=param1=== void 0?0.4:param1,radialSegments=param2=== void 0?8:param2,tubularSegments=param3=== void 0?6:param3,arc=param4=== void 0?Math.PI*2:param4;var data=CreateVertexSet();var vertices=data.vertices,normals=data.normals,uvs=data.uvs,indices=data.indices;var center=new Vec3();var vertex=new Vec3();var normal=new Vec3();for(var j=0;j<=radialSegments;j++){for(var i10=0;i10<=tubularSegments;i10++){var u=i10/tubularSegments*arc;var v=j/radialSegments*Math.PI*2;vertex.x=(radius+tube*Math.cos(v))*Math.cos(u);vertex.y=(radius+tube*Math.cos(v))*Math.sin(u);vertex.z=tube*Math.sin(v);vertices.push(vertex.x,vertex.y,vertex.z);center.x=radius*Math.cos(u);center.y=radius*Math.sin(u);Vec3Subtract(vertex,center,normal);Vec3Normalize(normal,normal);normals.push(normal.x,normal.y,normal.z);uvs.push(i10/tubularSegments);uvs.push(j/radialSegments);}}for(var j1=1;j1<=radialSegments;j1++){for(var i14=1;i14<=tubularSegments;i14++){var a=(tubularSegments+1)*j1+i14-1;var b=(tubularSegments+1)*(j1-1)+i14-1;var c=(tubularSegments+1)*(j1-1)+i14;var d=(tubularSegments+1)*j1+i14;indices.push(a,b,d);indices.push(b,c,d);}}data.numberOfVertices=vertices.length;return data;}var input_exports2={};__export(input_exports2,{Keyboard:function(){return keyboard_exports;},Mouse:function(){return mouse_exports;},SetInteractive:function(){return SetInteractive;}});var keyboard_exports={};__export(keyboard_exports,{GetKeyDownDuration:function(){return GetKeyDownDuration;},Key:function(){return Key;},Keyboard:function(){return Keyboard;},Keys:function(){return keys_exports;},SetKeyRepeatRate:function(){return SetKeyRepeatRate;}});var keys_exports={};__export(keys_exports,{AKey:function(){return AKey;},ArrowKeys:function(){return ArrowKeys;},BKey:function(){return BKey;},CKey:function(){return CKey;},DKey:function(){return DKey;},DownKey:function(){return DownKey;},EKey:function(){return EKey;},FKey:function(){return FKey;},GKey:function(){return GKey;},HKey:function(){return HKey;},IKey:function(){return IKey;},JKey:function(){return JKey;},KKey:function(){return KKey;},LKey:function(){return LKey;},LeftKey:function(){return LeftKey;},MKey:function(){return MKey;},NKey:function(){return NKey;},OKey:function(){return OKey;},PKey:function(){return PKey;},QKey:function(){return QKey;},RKey:function(){return RKey;},RightKey:function(){return RightKey;},SKey:function(){return SKey;},SpaceKey:function(){return SpaceKey;},TKey:function(){return TKey;},UKey:function(){return UKey;},UpKey:function(){return UpKey;},VKey:function(){return VKey;},WASDKeys:function(){return WASDKeys;},WKey:function(){return WKey;},XKey:function(){return XKey;},YKey:function(){return YKey;},ZKey:function(){return ZKey;}});var Key=function(){"use strict";function _class3(value){swcHelpers.classCallCheck(this,_class3);this.capture=true;this.isDown=false;this.enabled=true;this.repeatRate=0;this.canRepeat=true;this.timeDown=0;this.timeUpdated=0;this.timeUp=0;this.value=value;this.events=new Map();}swcHelpers.createClass(_class3,[{key:"getValue",value:function getValue(){return this.value;}},{key:"down",value:function down(event){if(!this.enabled){return;}if(this.capture){event.preventDefault();}this.shiftKey=event.shiftKey;this.ctrlKey=event.ctrlKey;this.altKey=event.altKey;if(this.isDown&&this.canRepeat){this.timeUpdated=event.timeStamp;var delay=this.timeUpdated-this.timeDown;if(delay>=this.repeatRate){Emit(this,"keydown",this);if(this.downCallback){this.downCallback(this);}}}else{this.isDown=true;this.timeDown=event.timeStamp;this.timeUpdated=event.timeStamp;Emit(this,"keydown",this);if(this.downCallback){this.downCallback(this);}}}},{key:"up",value:function up(event){if(!this.enabled){return;}if(this.capture){event.preventDefault();}this.shiftKey=event.shiftKey;this.ctrlKey=event.ctrlKey;this.altKey=event.altKey;if(this.isDown){this.isDown=false;this.timeUp=event.timeStamp;this.timeUpdated=event.timeStamp;Emit(this,"keyup",this);if(this.upCallback){this.upCallback(this);}}}},{key:"reset",value:function reset(){this.isDown=false;this.timeUpdated=this.timeDown;this.timeUp=this.timeDown;}},{key:"destroy",value:function destroy(){this.downCallback=null;this.upCallback=null;this.events.clear();}}]);return _class3;}();var AKey=function(Key1){"use strict";swcHelpers.inherits(_class3,Key1);function _class3(){swcHelpers.classCallCheck(this,_class3);return swcHelpers.possibleConstructorReturn(this,swcHelpers.getPrototypeOf(_class3).call(this,"a"));}return _class3;}(Key);var ArrowKeys=function _class3(keyboardManager,config){"use strict";swcHelpers.classCallCheck(this,_class3);var _left=config.left,left=_left=== void 0?true:_left,_right=config.right,right=_right=== void 0?true:_right,_up=config.up,up=_up=== void 0?true:_up,_down=config.down,down=_down=== void 0?true:_down,_space=config.space,space=_space=== void 0?true:_space;var keys=keyboardManager.keys;if(left){this.left=new Key("ArrowLeft");keys.set(this.left.value,this.left);}if(right){this.right=new Key("ArrowRight");keys.set(this.right.value,this.right);}if(up){this.up=new Key("ArrowUp");keys.set(this.up.value,this.up);}if(down){this.down=new Key("ArrowDown");keys.set(this.down.value,this.down);}if(space){this.space=new Key(" ");keys.set(this.space.value,this.space);}};var BKey=function(Key1){"use strict";swcHelpers.inherits(_class4,Key1);function _class4(){swcHelpers.classCallCheck(this,_class4);return swcHelpers.possibleConstructorReturn(this,swcHelpers.getPrototypeOf(_class4).call(this,"b"));}return _class4;}(Key);var CKey=function(Key1){"use strict";swcHelpers.inherits(_class4,Key1);function _class4(){swcHelpers.classCallCheck(this,_class4);return swcHelpers.possibleConstructorReturn(this,swcHelpers.getPrototypeOf(_class4).call(this,"c"));}return _class4;}(Key);var DKey=function(Key1){"use strict";swcHelpers.inherits(_class4,Key1);function _class4(){swcHelpers.classCallCheck(this,_class4);return swcHelpers.possibleConstructorReturn(this,swcHelpers.getPrototypeOf(_class4).call(this,"d"));}return _class4;}(Key);var DownKey=function(Key1){"use strict";swcHelpers.inherits(_class4,Key1);function _class4(){swcHelpers.classCallCheck(this,_class4);return swcHelpers.possibleConstructorReturn(this,swcHelpers.getPrototypeOf(_class4).call(this,"ArrowDown"));}return _class4;}(Key);var EKey=function(Key1){"use strict";swcHelpers.inherits(_class4,Key1);function _class4(){swcHelpers.classCallCheck(this,_class4);return swcHelpers.possibleConstructorReturn(this,swcHelpers.getPrototypeOf(_class4).call(this,"e"));}return _class4;}(Key);var FKey=function(Key1){"use strict";swcHelpers.inherits(_class4,Key1);function _class4(){swcHelpers.classCallCheck(this,_class4);return swcHelpers.possibleConstructorReturn(this,swcHelpers.getPrototypeOf(_class4).call(this,"f"));}return _class4;}(Key);var GKey=function(Key1){"use strict";swcHelpers.inherits(_class4,Key1);function _class4(){swcHelpers.classCallCheck(this,_class4);return swcHelpers.possibleConstructorReturn(this,swcHelpers.getPrototypeOf(_class4).call(this,"g"));}return _class4;}(Key);var HKey=function(Key1){"use strict";swcHelpers.inherits(_class4,Key1);function _class4(){swcHelpers.classCallCheck(this,_class4);return swcHelpers.possibleConstructorReturn(this,swcHelpers.getPrototypeOf(_class4).call(this,"h"));}return _class4;}(Key);var IKey=function(Key1){"use strict";swcHelpers.inherits(_class4,Key1);function _class4(){swcHelpers.classCallCheck(this,_class4);return swcHelpers.possibleConstructorReturn(this,swcHelpers.getPrototypeOf(_class4).call(this,"i"));}return _class4;}(Key);var JKey=function(Key1){"use strict";swcHelpers.inherits(_class4,Key1);function _class4(){swcHelpers.classCallCheck(this,_class4);return swcHelpers.possibleConstructorReturn(this,swcHelpers.getPrototypeOf(_class4).call(this,"j"));}return _class4;}(Key);var KKey=function(Key1){"use strict";swcHelpers.inherits(_class4,Key1);function _class4(){swcHelpers.classCallCheck(this,_class4);return swcHelpers.possibleConstructorReturn(this,swcHelpers.getPrototypeOf(_class4).call(this,"k"));}return _class4;}(Key);var LKey=function(Key1){"use strict";swcHelpers.inherits(_class4,Key1);function _class4(){swcHelpers.classCallCheck(this,_class4);return swcHelpers.possibleConstructorReturn(this,swcHelpers.getPrototypeOf(_class4).call(this,"l"));}return _class4;}(Key);var LeftKey=function(Key1){"use strict";swcHelpers.inherits(_class4,Key1);function _class4(){swcHelpers.classCallCheck(this,_class4);return swcHelpers.possibleConstructorReturn(this,swcHelpers.getPrototypeOf(_class4).call(this,"ArrowLeft"));}return _class4;}(Key);var MKey=function(Key1){"use strict";swcHelpers.inherits(_class4,Key1);function _class4(){swcHelpers.classCallCheck(this,_class4);return swcHelpers.possibleConstructorReturn(this,swcHelpers.getPrototypeOf(_class4).call(this,"m"));}return _class4;}(Key);var NKey=function(Key1){"use strict";swcHelpers.inherits(_class4,Key1);function _class4(){swcHelpers.classCallCheck(this,_class4);return swcHelpers.possibleConstructorReturn(this,swcHelpers.getPrototypeOf(_class4).call(this,"n"));}return _class4;}(Key);var OKey=function(Key1){"use strict";swcHelpers.inherits(_class4,Key1);function _class4(){swcHelpers.classCallCheck(this,_class4);return swcHelpers.possibleConstructorReturn(this,swcHelpers.getPrototypeOf(_class4).call(this,"o"));}return _class4;}(Key);var PKey=function(Key1){"use strict";swcHelpers.inherits(_class4,Key1);function _class4(){swcHelpers.classCallCheck(this,_class4);return swcHelpers.possibleConstructorReturn(this,swcHelpers.getPrototypeOf(_class4).call(this,"p"));}return _class4;}(Key);var QKey=function(Key1){"use strict";swcHelpers.inherits(_class4,Key1);function _class4(){swcHelpers.classCallCheck(this,_class4);return swcHelpers.possibleConstructorReturn(this,swcHelpers.getPrototypeOf(_class4).call(this,"q"));}return _class4;}(Key);var RKey=function(Key1){"use strict";swcHelpers.inherits(_class4,Key1);function _class4(){swcHelpers.classCallCheck(this,_class4);return swcHelpers.possibleConstructorReturn(this,swcHelpers.getPrototypeOf(_class4).call(this,"r"));}return _class4;}(Key);var RightKey=function(Key1){"use strict";swcHelpers.inherits(_class4,Key1);function _class4(){swcHelpers.classCallCheck(this,_class4);return swcHelpers.possibleConstructorReturn(this,swcHelpers.getPrototypeOf(_class4).call(this,"ArrowRight"));}return _class4;}(Key);var SKey=function(Key1){"use strict";swcHelpers.inherits(_class4,Key1);function _class4(){swcHelpers.classCallCheck(this,_class4);return swcHelpers.possibleConstructorReturn(this,swcHelpers.getPrototypeOf(_class4).call(this,"s"));}return _class4;}(Key);var SpaceKey=function(Key1){"use strict";swcHelpers.inherits(_class4,Key1);function _class4(){swcHelpers.classCallCheck(this,_class4);return swcHelpers.possibleConstructorReturn(this,swcHelpers.getPrototypeOf(_class4).call(this," "));}return _class4;}(Key);var TKey=function(Key1){"use strict";swcHelpers.inherits(_class4,Key1);function _class4(){swcHelpers.classCallCheck(this,_class4);return swcHelpers.possibleConstructorReturn(this,swcHelpers.getPrototypeOf(_class4).call(this,"t"));}return _class4;}(Key);var UKey=function(Key1){"use strict";swcHelpers.inherits(_class4,Key1);function _class4(){swcHelpers.classCallCheck(this,_class4);return swcHelpers.possibleConstructorReturn(this,swcHelpers.getPrototypeOf(_class4).call(this,"u"));}return _class4;}(Key);var UpKey=function(Key1){"use strict";swcHelpers.inherits(_class4,Key1);function _class4(){swcHelpers.classCallCheck(this,_class4);return swcHelpers.possibleConstructorReturn(this,swcHelpers.getPrototypeOf(_class4).call(this,"ArrowUp"));}return _class4;}(Key);var VKey=function(Key1){"use strict";swcHelpers.inherits(_class4,Key1);function _class4(){swcHelpers.classCallCheck(this,_class4);return swcHelpers.possibleConstructorReturn(this,swcHelpers.getPrototypeOf(_class4).call(this,"v"));}return _class4;}(Key);var WASDKeys=function _class4(keyboardManager,config){"use strict";swcHelpers.classCallCheck(this,_class4);var _W=config.W,W=_W=== void 0?true:_W,_A=config.A,A=_A=== void 0?true:_A,_S=config.S,S=_S=== void 0?true:_S,_D=config.D,D=_D=== void 0?true:_D,_space=config.space,space=_space=== void 0?true:_space;var keys=keyboardManager.keys;if(W){this.W=new Key("w");keys.set(this.W.value,this.W);}if(A){this.A=new Key("a");keys.set(this.A.value,this.A);}if(S){this.S=new Key("s");keys.set(this.S.value,this.S);}if(D){this.D=new Key("d");keys.set(this.D.value,this.D);}if(space){this.space=new Key(" ");keys.set(this.space.value,this.space);}};var WKey=function(Key1){"use strict";swcHelpers.inherits(_class5,Key1);function _class5(){swcHelpers.classCallCheck(this,_class5);return swcHelpers.possibleConstructorReturn(this,swcHelpers.getPrototypeOf(_class5).call(this,"w"));}return _class5;}(Key);var XKey=function(Key1){"use strict";swcHelpers.inherits(_class5,Key1);function _class5(){swcHelpers.classCallCheck(this,_class5);return swcHelpers.possibleConstructorReturn(this,swcHelpers.getPrototypeOf(_class5).call(this,"x"));}return _class5;}(Key);var YKey=function(Key1){"use strict";swcHelpers.inherits(_class5,Key1);function _class5(){swcHelpers.classCallCheck(this,_class5);return swcHelpers.possibleConstructorReturn(this,swcHelpers.getPrototypeOf(_class5).call(this,"y"));}return _class5;}(Key);var ZKey=function(Key1){"use strict";swcHelpers.inherits(_class5,Key1);function _class5(){swcHelpers.classCallCheck(this,_class5);return swcHelpers.possibleConstructorReturn(this,swcHelpers.getPrototypeOf(_class5).call(this,"z"));}return _class5;}(Key);function GetKeyDownDuration(key){if(key.isDown){return key.timeUpdated-key.timeDown;}else{return key.timeUp-key.timeDown;}}var Keyboard=function(EventEmitter1){"use strict";swcHelpers.inherits(_class5,EventEmitter1);function _class5(){swcHelpers.classCallCheck(this,_class5);var _this;_this=swcHelpers.possibleConstructorReturn(this,swcHelpers.getPrototypeOf(_class5).call(this));_this.keyConversion={Up:"ArrowUp",Down:"ArrowDown",Left:"ArrowLeft",Right:"ArrowRight",Spacebar:" ",Win:"Meta",Scroll:"ScrollLock",Del:"Delete",Apps:"ContextMenu",Esc:"Escape",Add:"+",Subtract:"-",Multiply:"*",Decimal:".",Divide:"/"};_this.keydownHandler=function(event){return _this.onKeyDown(event);};_this.keyupHandler=function(event){return _this.onKeyUp(event);};_this.blurHandler=function(){return _this.onBlur();};window.addEventListener("keydown",_this.keydownHandler);window.addEventListener("keyup",_this.keyupHandler);window.addEventListener("blur",_this.blurHandler);_this.keys=new Map();return _this;}swcHelpers.createClass(_class5,[{key:"addKeys",value:function addKeys(){for(var _len=arguments.length,keys=new Array(_len),_key=0;_key<_len;_key++){keys[_key]=arguments[_key];}keys.forEach((function(key){this.keys.set(key.getValue(),key);}).bind(this));}},{key:"clearKeys",value:function clearKeys(){this.keys.clear();}},{key:"onBlur",value:function onBlur(){this.keys.forEach(function(key){key.reset();});}},{key:"getKeyValue",value:function getKeyValue(key){if(this.keyConversion.hasOwnProperty(key)){return this.keyConversion[key];}else{return key;}}},{key:"onKeyDown",value:function onKeyDown(event){var value=this.getKeyValue(event.key);if(this.keys.has(value)){var key=this.keys.get(value);key.down(event);}Emit(this,"keydown-"+value,event);Emit(this,"keydown",event);}},{key:"onKeyUp",value:function onKeyUp(event){var value=this.getKeyValue(event.key);if(this.keys.has(value)){var key=this.keys.get(value);key.up(event);}Emit(this,"keyup-"+value,event);Emit(this,"keyup",event);}},{key:"destroy",value:function destroy(){window.removeEventListener("keydown",this.keydownHandler);window.removeEventListener("keyup",this.keyupHandler);window.removeEventListener("blur",this.blurHandler);Emit(this,"destroy");}}]);return _class5;}(EventEmitter);function SetKeyRepeatRate(rate){for(var _len=arguments.length,keys=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){keys[_key-1]=arguments[_key];}keys.forEach(function(key){key.repeatRate=rate;});return keys;}var mouse_exports={};__export(mouse_exports,{Mouse:function(){return Mouse;}});var Mouse=function(EventEmitter1){"use strict";swcHelpers.inherits(_class5,EventEmitter1);function _class5(target){swcHelpers.classCallCheck(this,_class5);var _this;_this=swcHelpers.possibleConstructorReturn(this,swcHelpers.getPrototypeOf(_class5).call(this));_this.primaryDown=false;_this.auxDown=false;_this.secondaryDown=false;_this.blockContextMenu=true;_this.resolution=1;_this.mousedownHandler=function(event){return _this.onMouseDown(event);};_this.mouseupHandler=function(event){return _this.onMouseUp(event);};_this.mousemoveHandler=function(event){return _this.onMouseMove(event);};_this.mousewheelHandler=function(event){return _this.onMouseWheel(event);};_this.contextmenuHandler=function(event){return _this.onContextMenuEvent(event);};_this.blurHandler=function(){return _this.onBlur();};_this.localPoint=new Vec2();_this.hitPoint=new Vec2();_this.transPoint=new Vec2();if(!target){target=GameInstance.get().renderer.canvas;}target.addEventListener("mousedown",_this.mousedownHandler);target.addEventListener("mouseup",_this.mouseupHandler);target.addEventListener("wheel",_this.mousewheelHandler,{passive:false});target.addEventListener("contextmenu",_this.contextmenuHandler);window.addEventListener("mouseup",_this.mouseupHandler);window.addEventListener("mousemove",_this.mousemoveHandler);window.addEventListener("blur",_this.blurHandler);_this.target=target;return _this;}swcHelpers.createClass(_class5,[{key:"onBlur",value:function onBlur(){}},{key:"onMouseDown",value:function onMouseDown(event){this.positionToPoint(event);this.primaryDown=event.button===0;this.auxDown=event.button===1;this.secondaryDown=event.button===2;Emit(this,"pointerdown",this.localPoint.x,this.localPoint.y,event.button,event);}},{key:"onMouseUp",value:function onMouseUp(event){this.positionToPoint(event);this.primaryDown=!(event.button===0);this.auxDown=!(event.button===1);this.secondaryDown=!(event.button===2);Emit(this,"pointerup",this.localPoint.x,this.localPoint.y,event.button,event);}},{key:"onMouseMove",value:function onMouseMove(event){this.positionToPoint(event);Emit(this,"pointermove",this.localPoint.x,this.localPoint.y,event);}},{key:"onMouseWheel",value:function onMouseWheel(event){Emit(this,"wheel",event.deltaX,event.deltaY,event.deltaZ,event);}},{key:"onContextMenuEvent",value:function onContextMenuEvent(event){if(this.blockContextMenu){event.preventDefault();}Emit(this,"contextmenu",event);}},{key:"positionToPoint",value:function positionToPoint(event){return this.localPoint.set(event.offsetX,event.offsetY);}},{key:"getInteractiveChildren",value:function getInteractiveChildren(parent,results){var children=parent.children;for(var i15=0;i15<children.length;i15++){var child=children[i15];if(!child.visible|| !child.input.enabled){continue;}results.push(child);if(child.input.enabledChildren&&child.numChildren){this.getInteractiveChildren(child,results);}}}},{key:"checkHitArea",value:function checkHitArea(entity,px,py){if(entity.input.hitArea){if(entity.input.hitArea.contains(px,py)){return true;}}else{return entity.transform.extent.contains(px,py);}return false;}},{key:"hitTest",value:function hitTest(){for(var _len=arguments.length,entities=new Array(_len),_key=0;_key<_len;_key++){entities[_key]=arguments[_key];}var localX=this.localPoint.x;var localY=this.localPoint.y;var point=this.transPoint;for(var i15=0;i15<entities.length;i15++){var entity=entities[i15];if(!entity.world){continue;}var mat=Mat2dAppend(entity.world.camera.worldTransform,entity.transform.world);Mat2dGlobalToLocal(mat,localX,localY,point);if(this.checkHitArea(entity,point.x,point.y)){this.hitPoint.set(point.x,point.y);return true;}}return false;}},{key:"hitTestChildren",value:function hitTestChildren(parent,param){var topOnly=param=== void 0?true:param;var output=[];if(!parent.visible){return output;}var candidates=[];var parentInput=parent.input;if(parentInput&&parentInput.enabled){candidates.push(parent);}if(parentInput.enabledChildren&&parent.numChildren){this.getInteractiveChildren(parent,candidates);}for(var i15=candidates.length-1;i15>=0;i15--){var entity=candidates[i15];if(this.hitTest(entity)){output.push(entity);if(topOnly){break;}}}return output;}},{key:"shutdown",value:function shutdown(){var target=this.target;target.removeEventListener("mousedown",this.mousedownHandler);target.removeEventListener("mouseup",this.mouseupHandler);target.removeEventListener("wheel",this.mousewheelHandler);target.removeEventListener("contextmenu",this.contextmenuHandler);window.removeEventListener("mouseup",this.mouseupHandler);window.removeEventListener("mousemove",this.mousemoveHandler);window.removeEventListener("blur",this.blurHandler);}}]);return _class5;}(EventEmitter);function SetInteractive(){for(var _len=arguments.length,children=new Array(_len),_key=0;_key<_len;_key++){children[_key]=arguments[_key];}children.forEach(function(child){child.input.enabled=true;});return children;}var loader_exports={};__export(loader_exports,{File:function(){return File1;},Files:function(){return files_exports;},Loader:function(){return Loader;}});var files_exports={};__export(files_exports,{AtlasFile:function(){return AtlasFile;},BitmapTextFile:function(){return BitmapTextFile;},CSVFile:function(){return CSVFile;},ImageFile:function(){return ImageFile;},JSONFile:function(){return JSONFile;},JSONGeometryFile:function(){return JSONGeometryFile;},OBJFile:function(){return OBJFile;},OBJGeometryFile:function(){return OBJGeometryFile;},SpriteSheetFile:function(){return SpriteSheetFile;},XMLFile:function(){return XMLFile;}});function AtlasParser(texture,data){var frames;if(Array.isArray(data.textures)){frames=data.textures[0].frames;}else if(Array.isArray(data.frames)){frames=data.frames;}else if(data.hasOwnProperty("frames")){frames=Object.values(data.frames);}else{console.warn("Invalid Texture Atlas JSON");}if(frames){var newFrame;for(var i15=0;i15<frames.length;i15++){var src=frames[i15];newFrame=texture.addFrame(src.filename,src.frame.x,src.frame.y,src.frame.w,src.frame.h);if(src.trimmed){newFrame.setTrim(src.sourceSize.w,src.sourceSize.h,src.spriteSourceSize.x,src.spriteSourceSize.y,src.spriteSourceSize.w,src.spriteSourceSize.h);}else{newFrame.setSourceSize(src.sourceSize.w,src.sourceSize.h);}if(src.rotated){}if(src.anchor){newFrame.setPivot(src.anchor.x,src.anchor.y);}}}}var File1=function _class5(key,url,config){"use strict";swcHelpers.classCallCheck(this,_class5);this.responseType="text";this.crossOrigin=void 0;this.skipCache=false;this.hasLoaded=false;this.key=key;this.url=url;this.config=config;};function GetURL(key,url,extension,loader){if(!url){url=key+extension;}if(/^(?:blob:|data:|http:\/\/|https:\/\/|\/\/)/.exec(url)){return url;}else if(loader){return loader.baseURL+loader.path+url;}else{return url;}}function ImageTagLoader(file){file.data=new Image();if(file.crossOrigin){file.data.crossOrigin=file.crossOrigin;}return new Promise(function(resolve,reject){file.data.onload=function(){if(file.data.onload){file.data.onload=null;file.data.onerror=null;resolve(file);}};file.data.onerror=function(event){if(file.data.onload){file.data.onload=null;file.data.onerror=null;file.error=event;reject(file);}};file.data.src=file.url;if(file.data.complete&&file.data.width&&file.data.height){file.data.onload=null;file.data.onerror=null;resolve(file);}});}function ImageFile(key,url,glConfig){var file=new File1(key,url);file.load=function(){file.url=GetURL(file.key,file.url,".png",file.loader);if(file.loader){file.crossOrigin=file.loader.crossOrigin;}return new Promise(function(resolve,reject){var textureManager=TextureManagerInstance.get();if(textureManager.has(file.key)){resolve(file);}else{ImageTagLoader(file).then(function(file2){textureManager.add(file2.key,file2.data,glConfig);resolve(file2);}).catch(function(file2){reject(file2);});}});};return file;}var caches=new Map();var Cache1={get:function(type){if(!caches.has(type)){caches.set(type,new Map());}return caches.get(type);},getEntry:function(cache,entry){if(caches.has(cache)){return caches.get(cache).get(entry);}}};function XHRLoader(file){var xhr=new XMLHttpRequest();xhr.open("GET",file.url,true);xhr.responseType=file.responseType;return new Promise(function(resolve,reject){xhr.onload=function(){file.data=xhr.responseText;file.hasLoaded=true;resolve(file);};xhr.onerror=function(){file.hasLoaded=true;reject(file);};xhr.send();});}function JSONFile(key,url){var file=new File1(key,url);file.load=function(){file.url=GetURL(file.key,file.url,".json",file.loader);return new Promise(function(resolve,reject){var cache=Cache1.get("JSON");if(!file.skipCache&&cache.has(file.key)){resolve(file);}else{XHRLoader(file).then(function(file2){file2.data=JSON.parse(file2.data);if(!file2.skipCache){cache.set(file2.key,file2.data);}resolve(file2);}).catch(function(file2){reject(file2);});}});};return file;}function AtlasFile(key,textureURL,atlasURL,glConfig){var json=JSONFile(key,atlasURL);var image=ImageFile(key,textureURL,glConfig);var file=new File1(key,"");file.load=function(){json.url=GetURL(json.key,json.url,".json",file.loader);image.url=GetURL(image.key,image.url,".png",file.loader);return new Promise(function(resolve,reject){json.skipCache=true;json.load().then(function(){image.load().then(function(){AtlasParser(TextureManagerInstance.get().get(key),json.data);resolve(file);}).catch(function(){reject(file);});}).catch(function(){reject(file);});});};return file;}function GetValue(node,attribute){return parseInt(node.getAttribute(attribute),10);}function BitmapTextParser(texture,xml,frame2){var xSpacing=0;var ySpacing=0;var info=xml.getElementsByTagName("info")[0];var common=xml.getElementsByTagName("common")[0];var data={font:info.getAttribute("face"),size:GetValue(info,"size"),lineHeight:GetValue(common,"lineHeight")+ySpacing,chars:{}};var letters=xml.getElementsByTagName("char");for(var i16=0;i16<letters.length;i16++){var node=letters[i16];var charCode=GetValue(node,"id");var x=GetValue(node,"x");var y5=GetValue(node,"y");var width=GetValue(node,"width");var height=GetValue(node,"height");data.chars[charCode]={x:x,y:y5,width:width,height:height,xOffset:GetValue(node,"xoffset"),yOffset:GetValue(node,"yoffset"),xAdvance:GetValue(node,"xadvance")+xSpacing,kerning:{}};texture.addFrame(charCode,x,y5,width,height);}var kernings=xml.getElementsByTagName("kerning");for(var i17=0;i17<kernings.length;i17++){var kern=kernings[i17];var first=GetValue(kern,"first");var second=GetValue(kern,"second");var amount=GetValue(kern,"amount");data.chars[second].kerning[first]=amount;}return data;}function XMLFile(key,url){var file=new File1(key,url);file.load=function(){file.url=GetURL(file.key,file.url,".xml",file.loader);return new Promise(function(resolve,reject){var cache=Cache1.get("XML");if(!file.skipCache&&cache.has(file.key)){resolve(file);}else{XHRLoader(file).then(function(file2){var xml=ParseXML(file2.data);if(xml!==null){file2.data=xml;if(!file2.skipCache){cache.set(file2.key,xml);}resolve(file2);}else{reject(file2);}}).catch(function(file2){reject(file2);});}});};return file;}function BitmapTextFile(key,textureURL,fontDataURL,glConfig){var xml=XMLFile(key,fontDataURL);var image=ImageFile(key,textureURL,glConfig);var file=new File1(key,"");file.load=function(){xml.url=GetURL(xml.key,xml.url,".xml",file.loader);image.url=GetURL(image.key,image.url,".png",file.loader);return new Promise(function(resolve,reject){xml.skipCache=true;xml.load().then(function(){image.load().then(function(){var texture=TextureManagerInstance.get().get(key);var fontData=BitmapTextParser(texture,xml.data);texture.data=fontData;resolve(file);}).catch(function(){reject(file);});}).catch(function(){reject(file);});});};return file;}function CSVFile(key,url){var file=new File1(key,url);file.load=function(){file.url=GetURL(file.key,file.url,".csv",file.loader);return new Promise(function(resolve,reject){var cache=Cache1.get("CSV");if(!file.skipCache&&cache.has(file.key)){resolve(file);}else{XHRLoader(file).then(function(file2){if(!file2.skipCache){cache.set(file2.key,file2.data);}resolve(file2);}).catch(function(file2){reject(file2);});}});};return file;}function JSONGeometryFile(key,url,mappingConfig){var file=new File1(key,url);var _vertices=mappingConfig.vertices,vertices=_vertices=== void 0?"verts":_vertices,_normals=mappingConfig.normals,normals=_normals=== void 0?"normals":_normals,_uvs=mappingConfig.uvs,uvs=_uvs=== void 0?"uvs":_uvs,_numberOfVertices=mappingConfig.numberOfVertices,numberOfVertices=_numberOfVertices=== void 0?0:_numberOfVertices;file.load=function(){file.url=GetURL(file.key,file.url,".json",file.loader);return new Promise(function(resolve,reject){var cache=Cache1.get("Geometry");if(!file.skipCache&&cache.has(file.key)){resolve(file);}else{XHRLoader(file).then(function(file2){var data=JSON.parse(file2.data);var geom=new Geometry({vertices:data[vertices],normals:data[normals],uvs:data[uvs],numberOfVertices:numberOfVertices});file2.data=geom;if(!file2.skipCache){cache.set(file2.key,geom);}resolve(file2);}).catch(function(file2){reject(file2);});}});};return file;}function OBJFile(key,url){var file=new File1(key,url);file.load=function(){file.url=GetURL(file.key,file.url,".obj",file.loader);return new Promise(function(resolve,reject){var cache=Cache1.get("Obj");if(!file.skipCache&&cache.has(file.key)){resolve(file);}else{XHRLoader(file).then(function(file2){if(!file2.skipCache){cache.set(file2.key,file2.data);}resolve(file2);}).catch(function(file2){reject(file2);});}});};return file;}function OBJGeometryFile(key,url,param){var flipUVs=param=== void 0?true:param;var file=new File1(key,url);file.load=function(){file.url=GetURL(file.key,file.url,".obj",file.loader);return new Promise(function(resolve,reject){var cache=Cache1.get("Geometry");if(!file.skipCache&&cache.has(file.key)){resolve(file);}else{XHRLoader(file).then(function(file2){var models=GetBufferFromObj(file2.data,flipUVs);file2.data=models;if(!file2.skipCache){var key2=file2.key;models.forEach(function(model,index){if(index>0){key2=file2.key+index.toString();}var geom=new Geometry(model.buffer);cache.set(key2,geom);});}resolve(file2);}).catch(function(file2){reject(file2);});}});};return file;}function SpriteSheetParser(texture,x,y6,width,height,frameConfig){var _frameWidth=frameConfig.frameWidth,frameWidth=_frameWidth=== void 0?null:_frameWidth,_endFrame=frameConfig.endFrame,endFrame=_endFrame=== void 0?-1:_endFrame,_margin=frameConfig.margin,margin=_margin=== void 0?0:_margin,_spacing=frameConfig.spacing,spacing=_spacing=== void 0?0:_spacing;var _frameHeight=frameConfig.frameHeight,frameHeight=_frameHeight=== void 0?null:_frameHeight,_startFrame=frameConfig.startFrame,startFrame=_startFrame=== void 0?0:_startFrame;if(!frameHeight){frameHeight=frameWidth;}if(frameWidth===null){throw new Error("SpriteSheetParser: Invalid frameWidth");}var row=Math.floor((width-margin+spacing)/(frameWidth+spacing));var column=Math.floor((height-margin+spacing)/(frameHeight+spacing));var total=row*column;if(total===0){console.warn("SpriteSheetParser: Frame config will result in zero frames");}if(startFrame>total||startFrame< -total){startFrame=0;}if(startFrame<0){startFrame=total+startFrame;}if(endFrame!== -1){total=startFrame+(endFrame+1);}var fx=margin;var fy=margin;var ax=0;var ay=0;for(var i16=0;i16<total;i16++){ax=0;ay=0;var w=fx+frameWidth;var h=fy+frameHeight;if(w>width){ax=w-width;}if(h>height){ay=h-height;}texture.addFrame(i16,x+fx,y6+fy,frameWidth-ax,frameHeight-ay);fx+=frameWidth+spacing;if(fx+frameWidth>width){fx=margin;fy+=frameHeight+spacing;}}}function SpriteSheetFile(key,url,frameConfig,glConfig){var file=new File1(key,url);file.load=function(){file.url=GetURL(file.key,file.url,".png",file.loader);if(file.loader){file.crossOrigin=file.loader.crossOrigin;}return new Promise(function(resolve,reject){var textureManager=TextureManagerInstance.get();if(textureManager.has(file.key)){resolve(file);}else{ImageTagLoader(file).then(function(file2){var texture=textureManager.add(file2.key,file2.data,glConfig);if(texture){SpriteSheetParser(texture,0,0,texture.width,texture.height,frameConfig);resolve(file2);}else{reject(file2);}}).catch(function(file2){reject(file2);});}});};return file;}var Loader=function(EventEmitter1){"use strict";swcHelpers.inherits(_class6,EventEmitter1);function _class6(){swcHelpers.classCallCheck(this,_class6);var _this;_this=swcHelpers.possibleConstructorReturn(this,swcHelpers.getPrototypeOf(_class6).call(this));_this.baseURL="";_this.path="";_this.crossOrigin="anonymous";_this.maxParallelDownloads=-1;_this.isLoading=false;_this.reset();return _this;}swcHelpers.createClass(_class6,[{key:"reset",value:function reset(){this.isLoading=false;this.queue=new Set();this.inflight=new Set();this.completed=new Set();this.progress=0;}},{key:"add",value:function add(){for(var _len=arguments.length,file=new Array(_len),_key=0;_key<_len;_key++){file[_key]=arguments[_key];}file.forEach((function(entity){entity.loader=this;this.queue.add(entity);}).bind(this));return this;}},{key:"start",value:function start(){if(this.isLoading){return null;}return new Promise((function(resolve,reject){this.completed.clear();this.progress=0;if(this.queue.size>0){this.isLoading=true;this.onComplete=resolve;this.onError=reject;Emit(this,"start");this.nextFile();}else{this.progress=1;Emit(this,"complete");resolve(this);}}).bind(this));}},{key:"nextFile",value:function nextFile(){var limit=this.queue.size;if(this.maxParallelDownloads!== -1){limit=Math.min(limit,this.maxParallelDownloads)-this.inflight.size;}if(limit){var iterator=this.queue.values();while(limit>0){var file=iterator.next().value;this.inflight.add(file);this.queue.delete(file);file.load().then((function(file2){return this.fileComplete(file2);}).bind(this)).catch((function(file2){return this.fileError(file2);}).bind(this));limit--;}}else if(this.inflight.size===0){this.stop();}}},{key:"stop",value:function stop(){if(!this.isLoading){return;}this.isLoading=false;Emit(this,"complete",this.completed);this.onComplete();this.completed.clear();}},{key:"updateProgress",value:function updateProgress(file){this.inflight.delete(file);this.completed.add(file);var totalCompleted=this.completed.size;var totalQueued=this.queue.size+this.inflight.size;if(totalCompleted>0){this.progress=totalCompleted/(totalCompleted+totalQueued);}Emit(this,"progress",this.progress,totalCompleted,totalQueued);this.nextFile();}},{key:"fileComplete",value:function fileComplete(file){Emit(this,"filecomplete",file);this.updateProgress(file);}},{key:"fileError",value:function fileError(file){Emit(this,"fileerror",file);this.updateProgress(file);}},{key:"totalFilesToLoad",value:function totalFilesToLoad(){return this.queue.size+this.inflight.size;}},{key:"setBaseURL",value:function setBaseURL(param){var url=param=== void 0?"":param;if(url!==""&&url.substr(-1)!=="/"){url=url.concat("/");}this.baseURL=url;return this;}},{key:"setPath",value:function setPath(param){var path=param=== void 0?"":param;if(path!==""&&path.substr(-1)!=="/"){path=path.concat("/");}this.path=path;return this;}},{key:"setCORS",value:function setCORS(crossOrigin){this.crossOrigin=crossOrigin;return this;}},{key:"setMaxParallelDownloads",value:function setMaxParallelDownloads(max){this.maxParallelDownloads=max;return this;}}]);return _class6;}(EventEmitter);var materials3d_exports={};__export(materials3d_exports,{BlackPlastic:function(){return BlackPlastic;},BlackRubber:function(){return BlackRubber;},Brass:function(){return Brass;},Bronze:function(){return Bronze;},Chrome:function(){return Chrome;},Copper:function(){return Copper;},CyanPlastic:function(){return CyanPlastic;},CyanRubber:function(){return CyanRubber;},Emerald:function(){return Emerald;},Gold:function(){return Gold;},GreenPlastic:function(){return GreenPlastic;},GreenRubber:function(){return GreenRubber;},Jade:function(){return Jade;},Obsidian:function(){return Obsidian;},Pearl:function(){return Pearl;},RedPlastic:function(){return RedPlastic;},RedRubber:function(){return RedRubber;},Ruby:function(){return Ruby;},Silver:function(){return Silver;},Turquoise:function(){return Turquoise;},WhitePlastic:function(){return WhitePlastic;},WhiteRubber:function(){return WhiteRubber;},YellowPlastic:function(){return YellowPlastic;},YellowRubber:function(){return YellowRubber;}});var BlackPlastic=new Material({ambient:[0,0,0],diffuse:[0.01,0.01,0.01],specular:[0.5,0.5,0.5],shine:0.25});var BlackRubber=new Material({ambient:[0.02,0.02,0.02],diffuse:[0.01,0.01,0.01],specular:[0.4,0.4,0.4],shine:0.078125});var Brass=new Material({ambient:[0.329412,0.223529,0.027451],diffuse:[0.780392,0.568627,0.113725],specular:[0.992157,0.941176,0.807843],shine:0.21794872});var Bronze=new Material({ambient:[0.2125,0.1275,0.054],diffuse:[0.714,0.4284,0.18144],specular:[0.393548,0.271906,0.166721],shine:0.2});var Chrome=new Material({ambient:[0.25,0.25,0.25],diffuse:[0.4,0.4,0.4],specular:[0.774597,0.774597,0.774597],shine:0.6});var Copper=new Material({ambient:[0.19125,0.0735,0.0225],diffuse:[0.7038,0.27048,0.0828],specular:[0.256777,0.137622,0.086014],shine:0.1});var CyanPlastic=new Material({ambient:[0,0.1,0.06],diffuse:[0,0.50980392,0.50980392],specular:[0.50196078,0.50196078,0.50196078],shine:0.25});var CyanRubber=new Material({ambient:[0,0.05,0.05],diffuse:[0.4,0.5,0.5],specular:[0.04,0.7,0.7],shine:0.078125});var Emerald=new Material({ambient:[0.0215,0.1745,0.0215],diffuse:[0.07568,0.61424,0.07568],specular:[0.633,0.727811,0.633],shine:0.6});var Gold=new Material({ambient:[0.24725,0.1995,0.0745],diffuse:[0.75164,0.60648,0.22648],specular:[0.628281,0.555802,0.366065],shine:0.4});var GreenPlastic=new Material({ambient:[0,0,0],diffuse:[0.1,0.35,0.1],specular:[0.45,0.55,0.45],shine:0.25});var GreenRubber=new Material({ambient:[0,0.05,0],diffuse:[0.4,0.5,0.4],specular:[0.04,0.7,0.04],shine:0.078125});var Jade=new Material({ambient:[0.135,0.2225,0.1575],diffuse:[0.54,0.89,0.63],specular:[0.316228,0.316228,0.316228],shine:0.1});var Obsidian=new Material({ambient:[0.05375,0.05,0.06625],diffuse:[0.18275,0.17,0.22525],specular:[0.332741,0.328634,0.346435],shine:0.3});var Pearl=new Material({ambient:[0.25,0.20725,0.20725],diffuse:[1,0.829,0.829],specular:[0.296648,0.296648,0.296648],shine:0.088});var RedPlastic=new Material({ambient:[0,0,0],diffuse:[0.5,0,0],specular:[0.7,0.6,0.6],shine:0.25});var RedRubber=new Material({ambient:[0.05,0,0],diffuse:[0.5,0.4,0.4],specular:[0.7,0.04,0.04],shine:0.078125});var Ruby=new Material({ambient:[0.1745,0.01175,0.01175],diffuse:[0.61424,0.04136,0.04136],specular:[0.727811,0.626959,0.626959],shine:0.6});var Silver=new Material({ambient:[0.19225,0.19225,0.19225],diffuse:[0.50754,0.50754,0.50754],specular:[0.508273,0.508273,0.508273],shine:0.4});var Turquoise=new Material({ambient:[0.1,0.18725,0.1745],diffuse:[0.396,0.74151,0.69102],specular:[0.297254,0.30829,0.306678],shine:0.1});var WhitePlastic=new Material({ambient:[0,0,0],diffuse:[0.55,0.55,0.55],specular:[0.7,0.7,0.7],shine:0.25});var WhiteRubber=new Material({ambient:[0.05,0.05,0.05],diffuse:[0.5,0.5,0.5],specular:[0.7,0.7,0.7],shine:0.078125});var YellowPlastic=new Material({ambient:[0,0,0],diffuse:[0.5,0.5,0],specular:[0.6,0.6,0.5],shine:0.25});var YellowRubber=new Material({ambient:[0.05,0.05,0],diffuse:[0.5,0.5,0.4],specular:[0.7,0.7,0.04],shine:0.078125});var textures_exports={};__export(textures_exports,{CreateCanvas:function(){return CreateCanvas;},Frame:function(){return Frame;},GetFrames:function(){return GetFrames;},GetFramesInRange:function(){return GetFramesInRange;},Palettes:function(){return palettes_exports;},Parsers:function(){return parsers_exports;},SetFilter:function(){return SetFilter;},Texture:function(){return Texture;},TextureManager:function(){return TextureManager;},Types:function(){return types_exports;}});var palettes_exports={};__export(palettes_exports,{Arne16:function(){return Arne16;},C64:function(){return C64;},CGA:function(){return CGA;},JMP:function(){return JMP;},MSX:function(){return MSX;},PICO8:function(){return PICO8;}});var Arne16=["#000","#9D9D9D","#FFF","#BE2633","#E06F8B","#493C2B","#A46422","#EB8931","#F7E26B","#2F484E","#44891A","#A3CE27","#1B2632","#005784","#31A2F2","#B2DCEF"];var C64=["#000","#fff","#8b4131","#7bbdc5","#8b41ac","#6aac41","#3931a4","#d5de73","#945a20","#5a4100","#bd736a","#525252","#838383","#acee8b","#7b73de","#acacac"];var CGA=["#000","#2234d1","#0c7e45","#44aacc","#8a3622","#5c2e78","#aa5c3d","#b5b5b5","#5e606e","#4c81fb","#6cd947","#7be2f9","#eb8a60","#e23d69","#ffd93f","#fff"];var JMP=["#000","#191028","#46af45","#a1d685","#453e78","#7664fe","#833129","#9ec2e8","#dc534b","#e18d79","#d6b97b","#e9d8a1","#216c4b","#d365c8","#afaab9","#f5f4eb"];var MSX=["#000","#191028","#46af45","#a1d685","#453e78","#7664fe","#833129","#9ec2e8","#dc534b","#e18d79","#d6b97b","#e9d8a1","#216c4b","#d365c8","#afaab9","#fff"];var PICO8=["#000","#1D2B53","#7E2553","#008751","#AB5236","#5F574F","#C2C3C7","#FFF1E8","#FF004D","#FFA300","#FFEC27","#00E436","#29ADFF","#83769C","#FF77A8","#FFCCAA"];var parsers_exports={};__export(parsers_exports,{AtlasParser:function(){return AtlasParser;},BitmapTextParser:function(){return BitmapTextParser;},SpriteSheetParser:function(){return SpriteSheetParser;}});var types_exports={};__export(types_exports,{CanvasTexture:function(){return CanvasTexture;},GridTexture:function(){return GridTexture;},LinearGradientTexture:function(){return LinearGradientTexture;},PixelTexture:function(){return PixelTexture;},RenderTexture:function(){return RenderTexture;},SolidColorTexture:function(){return SolidColorTexture;}});function GridTexture(color1,color2,param,param1,param2,param3){var width=param=== void 0?32:param,height=param1=== void 0?32:param1,cols=param2=== void 0?2:param2,rows=param3=== void 0?2:param3;var ctx=CreateCanvas(width,height);var colWidth=width/cols;var rowHeight=height/rows;ctx.fillStyle=color1;ctx.fillRect(0,0,width,height);ctx.fillStyle=color2;for(var y6=0;y6<rows;y6++){for(var x=y6%2;x<cols;x+=2){ctx.fillRect(x*colWidth,y6*rowHeight,colWidth,rowHeight);}}return new Texture(ctx.canvas);}function LinearGradientTexture(config){var _width=config.width,width=_width=== void 0?256:_width,_height=config.height,height=_height=== void 0?256:_height,_horizontal=config.horizontal,horizontal=_horizontal=== void 0?false:_horizontal,_x0=config.x0,x0=_x0=== void 0?0:_x0,_y0=config.y0,y0=_y0=== void 0?0:_y0,_x1=config.x1,x1=_x1=== void 0?horizontal?width:0:_x1,_y1=config.y1,y19=_y1=== void 0?horizontal?0:height:_y1,_colorStops=config.colorStops,colorStops=_colorStops=== void 0?[{offset:0,color:"red"}]:_colorStops;var ctx=CreateCanvas(width,height);var gradient=ctx.createLinearGradient(x0,y0,x1,y19);for(var _i=0,_iter=colorStops.values();_i<_iter.length;_i++){var colorStop=_iter[_i];gradient.addColorStop(colorStop.offset,colorStop.color);}ctx.fillStyle=gradient;ctx.fillRect(0,0,width,height);return new Texture(ctx.canvas);}function PixelTexture(config){var _data=config.data,data=_data=== void 0?[]:_data,_palette=config.palette,palette=_palette=== void 0?Arne16:_palette,_pixelWidth=config.pixelWidth,pixelWidth=_pixelWidth=== void 0?1:_pixelWidth,_pixelHeight=config.pixelHeight,pixelHeight=_pixelHeight=== void 0?pixelWidth:_pixelHeight,_preRender=config.preRender,preRender=_preRender=== void 0?null:_preRender,_postRender=config.postRender,postRender=_postRender=== void 0?null:_postRender;var _canvas=config.canvas,canvas=_canvas=== void 0?null:_canvas,_resizeCanvas=config.resizeCanvas,resizeCanvas=_resizeCanvas=== void 0?true:_resizeCanvas,_clearCanvas=config.clearCanvas,clearCanvas=_clearCanvas=== void 0?true:_clearCanvas;var width=Math.floor(Math.abs(data[0].length*pixelWidth));var height=Math.floor(Math.abs(data.length*pixelHeight));if(!canvas){canvas=CreateCanvas(width,height).canvas;resizeCanvas=false;clearCanvas=false;}if(resizeCanvas){canvas.width=width;canvas.height=height;}var ctx=canvas.getContext("2d");if(clearCanvas){ctx.clearRect(0,0,width,height);}if(preRender){preRender(canvas,ctx);}for(var y6=0;y6<data.length;y6++){var row=data[y6];for(var x=0;x<row.length;x++){var d=row[x];if(d!=="."&&d!==" "){ctx.fillStyle=palette[parseInt("0x"+d.toUpperCase())];ctx.fillRect(x*pixelWidth,y6*pixelHeight,pixelWidth,pixelHeight);}}}if(postRender){postRender(canvas,ctx);}return new Texture(canvas);}var RenderTexture=function(Texture1){"use strict";swcHelpers.inherits(_class6,Texture1);function _class6(renderer,param,param1){var width=param=== void 0?256:param,height=param1=== void 0?width:param1;swcHelpers.classCallCheck(this,_class6);var _this;_this=swcHelpers.possibleConstructorReturn(this,swcHelpers.getPrototypeOf(_class6).call(this,null,width,height));_this.renderer=renderer;return _this;}swcHelpers.createClass(_class6,[{key:"cls",value:function cls(){return this;}},{key:"batchStart",value:function batchStart(){return this;}},{key:"batchDraw",value:function batchDraw(sprites){for(var i16=0,len=sprites.length;i16<len;i16++){}return this;}},{key:"batchEnd",value:function batchEnd(){var renderer=this.renderer;renderer.reset();return this;}},{key:"draw",value:function draw(){for(var _len=arguments.length,sprites=new Array(_len),_key=0;_key<_len;_key++){sprites[_key]=arguments[_key];}this.batchStart();this.batchDraw(sprites);this.batchEnd();return this;}}]);return _class6;}(Texture);function SolidColorTexture(param,param1,param2){var color=param=== void 0?"rgba(0,0,0,0)":param,width=param1=== void 0?32:param1,height=param2=== void 0?32:param2;var ctx=CreateCanvas(width,height);ctx.fillStyle=color;ctx.fillRect(0,0,width,height);return new Texture(ctx.canvas);}function GetFrames(texture,frames){var output=[];frames.forEach(function(key){output.push(texture.getFrame(key));});return output;}function GetFramesInRange(texture,config){var _prefix=config.prefix,prefix=_prefix=== void 0?"":_prefix,_start=config.start,start=_start=== void 0?0:_start,_zeroPad=config.zeroPad,zeroPad=_zeroPad=== void 0?0:_zeroPad,_suffix=config.suffix,suffix=_suffix=== void 0?"":_suffix;var end=config.end;var output=[];var diff=start<end?1:-1;end+=diff;for(var i16=start;i16!==end;i16+=diff){var frameKey=prefix+i16.toString().padStart(zeroPad,"0")+suffix;output.push(texture.getFrame(frameKey));}return output;}function SetFilter(linear){for(var _len=arguments.length,textures=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){textures[_key-1]=arguments[_key];}textures.forEach(function(texture){if(texture.binding){texture.binding.setFilter(linear);}});return textures;}var TextureManager=function(){"use strict";function _class6(){swcHelpers.classCallCheck(this,_class6);this.textures=new Map();this.createDefaultTextures();TextureManagerInstance.set(this);}swcHelpers.createClass(_class6,[{key:"createDefaultTextures",value:function createDefaultTextures(){this.add("__BLANK",new Texture(CreateCanvas(32,32).canvas));var missing=CreateCanvas(32,32);missing.strokeStyle="#0f0";missing.moveTo(0,0);missing.lineTo(32,32);missing.stroke();missing.strokeRect(0.5,0.5,31,31);this.add("__MISSING",new Texture(missing.canvas));var white=CreateCanvas(32,32);white.fillStyle="#fff";white.fillRect(0,0,32,32);this.add("__WHITE",new Texture(white.canvas));}},{key:"get",value:function get(key){var textures=this.textures;if(textures.has(key)){return textures.get(key);}else{return textures.get("__MISSING");}}},{key:"has",value:function has(key){return this.textures.has(key);}},{key:"add",value:function add(key,source,glConfig){var texture;var textures=this.textures;if(!textures.has(key)){if(swcHelpers._instanceof(source,Texture)){texture=source;}else{texture=new Texture(source,0,0,glConfig);}texture.key=key;textures.set(key,texture);}return texture;}}]);return _class6;}();var time_exports={};__export(time_exports,{AddDelayedCall:function(){return AddDelayedCall;},AddTimer:function(){return AddTimer;},Clock:function(){return Clock;},NOOP:function(){return NOOP2;}});function NOOP2(){}function AddTimer(clock,config){var _duration=config.duration,duration=_duration=== void 0?0:_duration,_repeat=config.repeat,repeat=_repeat=== void 0?0:_repeat,_delay=config.delay,delay=_delay=== void 0?-1:_delay,_onStart=config.onStart,onStart=_onStart=== void 0?NOOP2:_onStart,_onUpdate=config.onUpdate,onUpdate=_onUpdate=== void 0?NOOP2:_onUpdate,_onRepeat=config.onRepeat,onRepeat=_onRepeat=== void 0?NOOP2:_onRepeat,_onComplete=config.onComplete,onComplete=_onComplete=== void 0?NOOP2:_onComplete;var timer={elapsed:duration,duration:duration,repeat:repeat,delay:delay,update:null,onStart:onStart,onUpdate:onUpdate,onRepeat:onRepeat,onComplete:onComplete};timer.update=function(delta){if(timer.delay>0){timer.delay-=delta;if(timer.delay<0){timer.delay=0;}else{return false;}}if(timer.delay===0){timer.onStart();timer.delay=-1;}if(timer.delay=== -1){timer.elapsed-=delta;timer.onUpdate(delta,timer.elapsed/timer.duration);if(timer.elapsed<=0){if(timer.repeat>0){timer.repeat--;timer.elapsed=timer.duration;timer.onRepeat(timer.repeat);}else{timer.elapsed=0;timer.onComplete();}}}return timer.elapsed===0;};clock.events.add(timer);}function AddDelayedCall(clock,delay,callback){AddTimer(clock,{duration:0,delay:delay,onComplete:callback});}var Clock=function(){"use strict";function _class6(world){swcHelpers.classCallCheck(this,_class6);this.world=world;this.timeScale=1;this.events=new Set();}swcHelpers.createClass(_class6,[{key:"update",value:function update(delta,time){this.now=time;delta*=this.timeScale;this.events.forEach((function(timer){if(timer.update(delta)){this.events.delete(timer);}}).bind(this));}}]);return _class6;}();var world_exports={};__export(world_exports,{BaseWorld:function(){return BaseWorld;},BuildRenderList:function(){return BuildRenderList;},CalculateTotalRenderable:function(){return CalculateTotalRenderable;},CreateWorldRenderData:function(){return CreateWorldRenderData;},Events:function(){return events_exports2;},HasDirtyChildren:function(){return HasDirtyChildren;},MergeRenderData:function(){return MergeRenderData;},ResetWorldRenderData:function(){return ResetWorldRenderData;},StaticWorld:function(){return StaticWorld;},UpdateCachedLayers:function(){return UpdateCachedLayers;},World:function(){return World;},WorldDepthFirstSearch:function(){return WorldDepthFirstSearch;}});var events_exports2={};__export(events_exports2,{WorldRenderEvent:function(){return WorldRenderEvent;},WorldShutdownEvent:function(){return WorldShutdownEvent;}});var WorldRenderEvent="worldrender";var WorldShutdownEvent="worldshutdown";function CalculateTotalRenderable(entry,renderData){renderData.numRendered++;renderData.numRenderable++;if(entry.node.dirtyFrame>=renderData.gameFrame){renderData.dirtyFrame++;}entry.children.forEach(function(child){if(child.children.length>0){CalculateTotalRenderable(child,renderData);}});}function HasDirtyChildren(parent){if(parent.node.isDirty(DIRTY_CONST.CHILD_CACHE)){return true;}var stack=[parent];while(stack.length>0){var entry=stack.pop();if(entry.node.isDirty(DIRTY_CONST.TRANSFORM)){return true;}var numChildren=entry.children.length;if(numChildren>0){for(var i16=0;i16<numChildren;i16++){stack.push(entry.children[i16]);}}}stack.length=0;return false;}function UpdateCachedLayers(cachedLayers,dirtyCamera){cachedLayers.forEach(function(layer){if(dirtyCamera||HasDirtyChildren(layer)){layer.node.setDirty(DIRTY_CONST.CHILD_CACHE);}else{layer.children.length=0;}});}function WorldDepthFirstSearch(cachedLayers,parent,param){var output=param=== void 0?[]:param;for(var i17=0;i17<parent.numChildren;i17++){var node=parent.children[i17];if(node.isRenderable()){var children=[];var entry={node:node,children:children};output.push(entry);if(node.willRenderChildren&&node.numChildren>0){if(node.willCacheChildren){cachedLayers.push(entry);}WorldDepthFirstSearch(cachedLayers,node,children);}}}return output;}function BuildRenderList(world){var cachedLayers=[];var stack=[];var entries=WorldDepthFirstSearch(cachedLayers,world,stack);var renderData=world.renderData;if(cachedLayers.length>0){UpdateCachedLayers(cachedLayers,world.camera.dirtyRender);}entries.forEach(function(entry){if(entry.children.length>0){CalculateTotalRenderable(entry,renderData);}else{renderData.numRendered++;renderData.numRenderable++;if(entry.node.dirtyFrame>=renderData.gameFrame){renderData.dirtyFrame++;}}});world.renderList=entries;if(world.forceRefresh){renderData.dirtyFrame++;world.forceRefresh=false;}}function MergeRenderData(sceneRenderData,worldRenderData){sceneRenderData.numDirtyFrames+=worldRenderData.dirtyFrame;sceneRenderData.numTotalFrames+=worldRenderData.numRendered;if(worldRenderData.camera.dirtyRender){sceneRenderData.numDirtyCameras++;}sceneRenderData.worldData.push(worldRenderData);}function ResetWorldRenderData(renderData,gameFrame){renderData.gameFrame=gameFrame;renderData.dirtyFrame=0;renderData.numRendered=0;renderData.numRenderable=0;}var BaseWorld=function(GameObject1){"use strict";swcHelpers.inherits(_class6,GameObject1);function _class6(scene){swcHelpers.classCallCheck(this,_class6);var _this;_this=swcHelpers.possibleConstructorReturn(this,swcHelpers.getPrototypeOf(_class6).call(this));_this.forceRefresh=false;_this.is3D=false;_this.type="BaseWorld";_this.scene=scene;_this.world=swcHelpers.assertThisInitialized(_this);_this.events=new Map();_this.renderList=[];_this._updateListener=On(scene,"update",function(delta,time){return _this.update(delta,time);});_this._renderListener=On(scene,"render",function(renderData){return _this.render(renderData);});_this._shutdownListener=On(scene,"shutdown",function(){return _this.shutdown();});Once(scene,"destroy",function(){return _this.destroy();});return _this;}swcHelpers.createClass(_class6,[{key:"update",value:function update(delta,time){if(!this.willUpdate){return;}Emit(this,UpdateEvent,delta,time,this);swcHelpers.get(swcHelpers.getPrototypeOf(_class6.prototype),"update",this).call(this,delta,time);}},{key:"postUpdate",value:function postUpdate(delta,time){Emit(this,PostUpdateEvent,delta,time,this);}},{key:"render",value:function render(sceneRenderData){var renderData=this.renderData;ResetWorldRenderData(renderData,sceneRenderData.gameFrame);if(!this.willRender|| !this.visible){return;}BuildRenderList(this);Emit(this,WorldRenderEvent,renderData,this);MergeRenderData(sceneRenderData,renderData);this.camera.dirtyRender=false;}},{key:"renderGL",value:function renderGL(renderPass){var currentCamera=renderPass.current2DCamera;var camera=this.camera;if(!currentCamera|| !Mat2dEquals(camera.worldTransform,currentCamera.worldTransform)){Flush(renderPass);}Begin(renderPass,camera);this.renderList.forEach((function(entry){if(entry.children.length>0){this.renderNode(entry,renderPass);}else{entry.node.renderGL(renderPass);}}).bind(this));}},{key:"renderNode",value:function renderNode(entry,renderPass){entry.node.renderGL(renderPass);entry.children.forEach((function(child){if(child.children.length>0){this.renderNode(child,renderPass);}else{child.node.renderGL(renderPass);}}).bind(this));entry.node.postRenderGL(renderPass);}},{key:"postRenderGL",value:function postRenderGL(renderPass){}},{key:"shutdown",value:function shutdown(){var scene=this.scene;Off(scene,"update",this._updateListener);Off(scene,"render",this._renderListener);Off(scene,"shutdown",this._shutdownListener);RemoveChildren(this);Emit(this,WorldShutdownEvent,this);ResetWorldRenderData(this.renderData,0);if(this.camera){this.camera.reset();}}},{key:"destroy",value:function destroy(reparentChildren){swcHelpers.get(swcHelpers.getPrototypeOf(_class6.prototype),"destroy",this).call(this,reparentChildren);Emit(this,DestroyEvent,this);ResetWorldRenderData(this.renderData,0);if(this.camera){this.camera.destroy();}this.events.clear();this.camera=null;this.renderData=null;this.events=null;}}]);return _class6;}(GameObject);function CreateWorldRenderData(world,camera){return {world:world,camera:camera,gameFrame:0,dirtyFrame:0,numRendered:0,numRenderable:0};}var StaticWorld=function(BaseWorld1){"use strict";swcHelpers.inherits(_class6,BaseWorld1);function _class6(scene){swcHelpers.classCallCheck(this,_class6);var _this;_this=swcHelpers.possibleConstructorReturn(this,swcHelpers.getPrototypeOf(_class6).call(this,scene));_this.type="StaticWorld";_this.camera=new StaticCamera();_this.renderData=CreateWorldRenderData(swcHelpers.assertThisInitialized(_this),_this.camera);return _this;}return _class6;}(BaseWorld);var World=function(BaseWorld1){"use strict";swcHelpers.inherits(_class6,BaseWorld1);function _class6(scene){swcHelpers.classCallCheck(this,_class6);var _this;_this=swcHelpers.possibleConstructorReturn(this,swcHelpers.getPrototypeOf(_class6).call(this,scene));_this.enableCameraCull=true;_this.type="World";_this.camera=new Camera();_this.renderData=CreateWorldRenderData(swcHelpers.assertThisInitialized(_this),_this.camera);return _this;}return _class6;}(BaseWorld);var world3d_exports={};__export(world3d_exports,{BaseWorld3D:function(){return BaseWorld3D;},BuildRenderList:function(){return BuildRenderList2;},CalculateTotalRenderable:function(){return CalculateTotalRenderable2;},CreateWorld3DRenderData:function(){return CreateWorld3DRenderData;},Events:function(){return events_exports3;},HasDirtyChildren:function(){return HasDirtyChildren2;},MergeRenderData:function(){return MergeRenderData2;},ResetWorld3DRenderData:function(){return ResetWorld3DRenderData;},UpdateCachedLayers:function(){return UpdateCachedLayers2;},World3D:function(){return World3D;},WorldDepthFirstSearch:function(){return WorldDepthFirstSearch2;}});var events_exports3={};__export(events_exports3,{World3DRenderEvent:function(){return World3DRenderEvent;},World3DShutdownEvent:function(){return World3DShutdownEvent;}});var World3DRenderEvent="worldrender";var World3DShutdownEvent="worldshutdown";function CalculateTotalRenderable2(entry,renderData){renderData.numRendered++;renderData.numRenderable++;if(entry.node.dirtyFrame>=renderData.gameFrame){renderData.dirtyFrame++;}entry.children.forEach(function(child){if(child.children.length>0){CalculateTotalRenderable2(child,renderData);}});}function HasDirtyChildren2(parent){if(parent.node.isDirty(DIRTY_CONST.CHILD_CACHE)){return true;}var stack=[parent];while(stack.length>0){var entry=stack.pop();if(entry.node.isDirty(DIRTY_CONST.TRANSFORM)){return true;}var numChildren=entry.children.length;if(numChildren>0){for(var i17=0;i17<numChildren;i17++){stack.push(entry.children[i17]);}}}stack.length=0;return false;}function UpdateCachedLayers2(cachedLayers,dirtyCamera){cachedLayers.forEach(function(layer){if(dirtyCamera||HasDirtyChildren2(layer)){layer.node.setDirty(DIRTY_CONST.CHILD_CACHE);}else{layer.children.length=0;}});}function WorldDepthFirstSearch2(cachedLayers,parent,param){var output=param=== void 0?[]:param;for(var i18=0;i18<parent.numChildren;i18++){var node=parent.children[i18];if(node.isRenderable()){var children=[];var entry={node:node,children:children};output.push(entry);if(node.willRenderChildren&&node.numChildren>0){if(node.willCacheChildren){cachedLayers.push(entry);}WorldDepthFirstSearch2(cachedLayers,node,children);}}}return output;}function BuildRenderList2(world){var cachedLayers=[];var stack=[];var entries=WorldDepthFirstSearch2(cachedLayers,world,stack);var renderData=world.renderData;if(cachedLayers.length>0){UpdateCachedLayers2(cachedLayers,world.camera.dirtyRender);}entries.forEach(function(entry){if(entry.children.length>0){CalculateTotalRenderable2(entry,renderData);}else{renderData.numRendered++;renderData.numRenderable++;if(entry.node.dirtyFrame>=renderData.gameFrame){renderData.dirtyFrame++;}}});world.renderList=entries;if(world.forceRefresh){renderData.dirtyFrame++;world.forceRefresh=false;}}function MergeRenderData2(sceneRenderData,worldRenderData){sceneRenderData.numDirtyFrames+=worldRenderData.dirtyFrame;sceneRenderData.numTotalFrames+=worldRenderData.numRendered;if(worldRenderData.camera.dirtyRender){sceneRenderData.numDirtyCameras++;}sceneRenderData.worldData.push(worldRenderData);}function ResetWorld3DRenderData(renderData,gameFrame){renderData.gameFrame=gameFrame;renderData.dirtyFrame=0;renderData.numRendered=0;renderData.numRenderable=0;}var BaseWorld3D=function(GameObject3D1){"use strict";swcHelpers.inherits(_class6,GameObject3D1);function _class6(scene){swcHelpers.classCallCheck(this,_class6);var _this;_this=swcHelpers.possibleConstructorReturn(this,swcHelpers.getPrototypeOf(_class6).call(this));_this.forceRefresh=false;_this.is3D=true;_this.type="BaseWorld";_this.scene=scene;_this.world=swcHelpers.assertThisInitialized(_this);_this.events=new Map();_this.renderList=[];_this._updateListener=On(scene,"update",function(delta,time){return _this.update(delta,time);});_this._renderListener=On(scene,"render",function(renderData){return _this.render(renderData);});_this._shutdownListener=On(scene,"shutdown",function(){return _this.shutdown();});Once(scene,"destroy",function(){return _this.destroy();});return _this;}swcHelpers.createClass(_class6,[{key:"update",value:function update(delta,time){if(!this.willUpdate){return;}Emit(this,UpdateEvent,delta,time,this);swcHelpers.get(swcHelpers.getPrototypeOf(_class6.prototype),"update",this).call(this,delta,time);}},{key:"postUpdate",value:function postUpdate(delta,time){Emit(this,PostUpdateEvent,delta,time,this);}},{key:"render",value:function render(sceneRenderData){var renderData=this.renderData;ResetWorld3DRenderData(renderData,sceneRenderData.gameFrame);if(!this.willRender|| !this.visible){return;}BuildRenderList2(this);Emit(this,World3DRenderEvent,renderData,this);MergeRenderData2(sceneRenderData,renderData);}},{key:"renderNode",value:function renderNode(entry,renderPass){entry.node.renderGL(renderPass);entry.children.forEach((function(child){if(child.children.length>0){this.renderNode(child,renderPass);}else{child.node.renderGL(renderPass);}}).bind(this));entry.node.postRenderGL(renderPass);}},{key:"shutdown",value:function shutdown(){var scene=this.scene;Off(scene,"update",this._updateListener);Off(scene,"render",this._renderListener);Off(scene,"shutdown",this._shutdownListener);RemoveChildren3D(this);Emit(this,World3DShutdownEvent,this);ResetWorld3DRenderData(this.renderData,0);}},{key:"destroy",value:function destroy(reparentChildren){swcHelpers.get(swcHelpers.getPrototypeOf(_class6.prototype),"destroy",this).call(this,reparentChildren);Emit(this,DestroyEvent,this);ResetWorld3DRenderData(this.renderData,0);this.events.clear();this.camera=null;this.renderData=null;this.events=null;}}]);return _class6;}(GameObject3D);function CreateWorld3DRenderData(world,camera){return {world:world,camera:camera,gameFrame:0,dirtyFrame:0,numRendered:0,numRenderable:0};}var AMBIENT_LIGHT_FRAG="#define SHADER_NAME AMBIENT_LIGHT_FRAG\n\nprecision highp float;\n\nuniform vec3 uLightPosition;\nuniform vec3 uLightAmbient;\nuniform vec3 uLightDiffuse;\nuniform vec3 uLightSpecular;\n\nuniform vec3 uMaterialAmbient;\nuniform vec3 uMaterialDiffuse;\nuniform vec3 uMaterialSpecular;\nuniform float uMaterialShine;\n\nuniform vec3 uCameraPosition;\n\nuniform sampler2D uTexture;\n\nvarying vec2 vTextureCoord;\nvarying vec3 vNormal;\nvarying vec3 vPosition;\n\nvoid main (void)\n{\n    vec4 color = texture2D(uTexture, vTextureCoord);\n\n    vec3 ambient = uLightAmbient * uMaterialAmbient;\n\n    vec3 norm = normalize(vNormal);\n    vec3 lightDir = normalize(uLightPosition - vPosition);\n    float diff = max(dot(norm, lightDir), 0.0);\n    vec3 diffuse = uLightDiffuse * (diff * uMaterialDiffuse);\n\n    vec3 viewDir = normalize(uCameraPosition - vPosition);\n    vec3 reflectDir = reflect(-lightDir, norm);\n    float spec = pow(max(dot(viewDir, reflectDir), 0.0), uMaterialShine);\n    vec3 specular = uLightSpecular * (spec * uMaterialSpecular);\n\n    vec3 result = (ambient + diffuse + specular) * color.rgb;\n\n    gl_FragColor = vec4(result, color.a);\n}";var AMBIENT_LIGHT_VERT="\n#define SHADER_NAME AMBIENT_LIGHT_VERT\n\nprecision highp float;\n\nattribute vec3 aVertexPosition;\nattribute vec3 aVertexNormal;\nattribute vec2 aTextureCoord;\n\nuniform mat4 uViewProjectionMatrix;\nuniform mat4 uModelMatrix;\nuniform mat4 uNormalMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec3 vNormal;\nvarying vec3 vPosition;\n\nvoid main(void)\n{\n    vTextureCoord = aTextureCoord;\n\n    vPosition = vec3(uModelMatrix * vec4(aVertexPosition, 1.0));\n\n    vNormal = vec3(uNormalMatrix * vec4(aVertexNormal, 1.0));\n\n    gl_Position = uViewProjectionMatrix * uModelMatrix * vec4(aVertexPosition, 1.0);\n}\n";var AmbientLightShader=function(Shader1){"use strict";swcHelpers.inherits(_class6,Shader1);function _class6(){swcHelpers.classCallCheck(this,_class6);var _this;_this=swcHelpers.possibleConstructorReturn(this,swcHelpers.getPrototypeOf(_class6).call(this));var tempMat4=new Float32Array(16).fill(0);var tempVec3=[0,0,0];var config={fragmentShader:AMBIENT_LIGHT_FRAG,vertexShader:AMBIENT_LIGHT_VERT,attributes:{aVertexPosition:{size:3,type:FLOAT,normalized:false,offset:0},aVertexNormal:{size:3,type:FLOAT,normalized:false,offset:12},aTextureCoord:{size:2,type:FLOAT,normalized:false,offset:24}},uniforms:{uViewProjectionMatrix:tempMat4,uNormalMatrix:tempMat4,uModelMatrix:tempMat4,uCameraPosition:tempVec3,uTexture:0,uLightPosition:tempVec3,uLightAmbient:tempVec3,uLightDiffuse:tempVec3,uLightSpecular:tempVec3,uMaterialAmbient:tempVec3,uMaterialDiffuse:tempVec3,uMaterialSpecular:tempVec3,uMaterialShine:0}};_this.fromConfig(config);return _this;}return _class6;}(Shader);var NewCamera3D=function(){"use strict";function _class6(param,param1,param2){var fov=param=== void 0?45:param,near=param1=== void 0?0.1:param1,far=param2=== void 0?1000:param2;swcHelpers.classCallCheck(this,_class6);this.isOrbit=false;this.minDistance=0;this.maxDistance=Infinity;this.minPolarAngle=0;this.maxPolarAngle=Math.PI;this.minAzimuthAngle=-Infinity;this.maxAzimuthAngle=Infinity;this.dirtyRender=true;this.panRate=5;this.zoomRate=200;this.rotateRate=-3;this._yaw=0;this._pitch=0;this._roll=0;this.type="Camera3D";this._fov=fov;this._near=near;this._far=far;this.matrix=new Matrix4();this.viewMatrix=new Matrix4();this.projectionMatrix=new Matrix4();this.viewProjectionMatrix=new Matrix4();this.position=new Vec3Callback((function(){return this.update();}).bind(this));this.rotation=new Quaternion();var game=GameInstance.get();var renderer=game.renderer;this.viewport=new Rectangle(0,0,renderer.width,renderer.height);this.renderer=renderer;this.forward=Vec3Forward();this.up=Vec3Up();this.right=Vec3Right();this.start=new Vec3();this.setAspectRatio();}swcHelpers.createClass(_class6,[{key:"update",value:function update(){var matrix2=this.matrix;var view=this.viewMatrix;Mat4FromRotationXYTranslation(this.rotation,this.position,!this.isOrbit,matrix2);Vec3TransformMat4Zero(FORWARD,matrix2,this.forward);Vec3TransformMat4Zero(UP,matrix2,this.up);Vec3TransformMat4Zero(RIGHT,matrix2,this.right);Mat4Invert(matrix2,view);Mat4Multiply(this.projectionMatrix,view,this.viewProjectionMatrix);return this;}},{key:"panX",value:function panX(amount){var pos=this.position;if(!this.isOrbit){Vec3ScaleAndAdd(pos,this.right,amount,pos);}return this;}},{key:"panY",value:function panY(amount){var pos=this.position;var up=this.up;if(this.isOrbit){pos.y+=up.y*amount;}else{Vec3ScaleAndAdd(pos,up,amount,pos);}return this;}},{key:"panZ",value:function panZ(amount){var pos=this.position;if(this.isOrbit){pos.z+=amount;}else{Vec3ScaleAndAdd(pos,this.forward,amount,pos);}return this;}},{key:"begin",value:function begin(x,y6){this.start.set(x,y6);}},{key:"pan",value:function pan(x,y6){var dx=x-this.start.x;var dy=y6-this.start.y;var viewport=this.viewport;this.panX(-dx*(this.panRate/viewport.width));this.panY(dy*(this.panRate/viewport.height));this.start.set(x,y6);}},{key:"rotate",value:function rotate(x,y6){var dx=x-this.start.x;var dy=y6-this.start.y;var viewport=this.viewport;this.rotation.x+=dy*(this.rotateRate/viewport.height);this.rotation.y+=dx*(this.rotateRate/viewport.width);this.start.set(x,y6);this.update();}},{key:"zoom",value:function zoom(delta){this.panZ(Clamp(delta,-1,1)*(this.zoomRate/this.viewport.height));}},{key:"setAspectRatio",value:function setAspectRatio(value){if(!value){var renderer=this.renderer;value=renderer.width/renderer.height;}this.aspect=value;return this.updateProjectionMatrix();}},{key:"updateProjectionMatrix",value:function updateProjectionMatrix(){Mat4Perspective(DegToRad(this._fov),this.aspect,this._near,this._far,this.projectionMatrix);return this;}},{key:"fov",get:function get(){return this._fov;},set:function set(value){this._fov=Clamp(value,0,180);this.updateProjectionMatrix();}},{key:"near",get:function get(){return this._near;},set:function set(value){if(value>0){this._near=value;this.updateProjectionMatrix();}}},{key:"far",get:function get(){return this._far;},set:function set(value){if(value>0){this._far=value;this.updateProjectionMatrix();}}},{key:"yaw",get:function get(){return this._yaw;},set:function set(value){this._yaw=value;QuatRotationYawPitchRoll(value,this._pitch,this._roll,this.rotation);}},{key:"pitch",get:function get(){return this._pitch;},set:function set(value){this._pitch=value;QuatRotationYawPitchRoll(this._yaw,value,this._roll,this.rotation);}},{key:"roll",get:function get(){return this._roll;},set:function set(value){this._roll=value;QuatRotationYawPitchRoll(this._yaw,this._pitch,value,this.rotation);}}]);return _class6;}();var World3D=function(BaseWorld3D1){"use strict";swcHelpers.inherits(_class6,BaseWorld3D1);function _class6(scene,param,param1,param2,lightConfig){var x=param=== void 0?0:param,y6=param1=== void 0?0:param1,z=param2=== void 0?0:param2;swcHelpers.classCallCheck(this,_class6);var _this;_this=swcHelpers.possibleConstructorReturn(this,swcHelpers.getPrototypeOf(_class6).call(this,scene));_this.enableCameraCull=true;_this.type="World3D";_this.camera=new NewCamera3D();_this.camera.position.set(x,y6,z);_this.light=new Light(lightConfig);_this.shader=new AmbientLightShader();_this.renderData=CreateWorld3DRenderData(swcHelpers.assertThisInitialized(_this),_this.camera);return _this;}swcHelpers.createClass(_class6,[{key:"renderGL",value:function renderGL(renderPass){Flush(renderPass);var shader=this.shader;var camera=this.camera;var gl2=renderPass.renderer.gl;SetShader(renderPass,shader,0);shader.setUniform("uViewProjectionMatrix",camera.viewProjectionMatrix.data);shader.setUniform("uCameraPosition",camera.position.toArray());this.light.setUniforms(shader);gl2.enable(gl2.DEPTH_TEST);this.renderList.forEach((function(entry){if(entry.children.length>0){this.renderNode(entry,renderPass);}else{entry.node.renderGL(renderPass);}}).bind(this));}},{key:"postRenderGL",value:function postRenderGL(renderPass){var gl2=renderPass.renderer.gl;gl2.disable(gl2.DEPTH_TEST);gl2.disable(gl2.CULL_FACE);PopShader(renderPass);}}]);return _class6;}(BaseWorld3D);function GetBanner(){var ref=ConfigStore.get(CONFIG_DEFAULTS.BANNER),title=ref.title,version=ref.version,url=ref.url,color=ref.color,background=ref.background;if(title!==""){var str=version!==""?title+" "+version:title;console.log("%c".concat(str,"%c ").concat(url),"padding: 4px 16px; color: ".concat(color,"; background: ").concat(background),"");}}function GetGlobalVar(){return ConfigStore.get(CONFIG_DEFAULTS.GLOBAL_VAR);}function GetParent(){return ConfigStore.get(CONFIG_DEFAULTS.PARENT);}function GetRenderer(){return ConfigStore.get(CONFIG_DEFAULTS.RENDERER);}function CreateSceneRenderData(){return {gameFrame:0,numTotalFrames:0,numDirtyFrames:0,numDirtyCameras:0,worldData:[]};}function GetScenes(){return ConfigStore.get(CONFIG_DEFAULTS.SCENES);}function ResetSceneRenderData(renderData,param){var gameFrame=param=== void 0?0:param;renderData.gameFrame=gameFrame;renderData.numTotalFrames=0;renderData.numDirtyFrames=0;renderData.numDirtyCameras=0;renderData.worldData.length=0;}var instance4;var SceneManagerInstance={get:function(){return instance4;},set:function(manager){instance4=manager;}};var SceneManager=function(){"use strict";function _class6(){swcHelpers.classCallCheck(this,_class6);this.scenes=new Map();this.sceneIndex=0;this.flush=false;this.renderResult=CreateSceneRenderData();this.game=GameInstance.get();SceneManagerInstance.set(this);Once(this.game,"boot",(function(){return this.boot();}).bind(this));}swcHelpers.createClass(_class6,[{key:"boot",value:function boot(){GetScenes().forEach(function(scene){return new scene();});}},{key:"update",value:function update(delta,time){for(var _i=0,_iter=this.scenes.values();_i<_iter.length;_i++){var scene=_iter[_i];Emit(scene,"update",delta,time);}}},{key:"render",value:function render(gameFrame){var results=this.renderResult;ResetSceneRenderData(results,gameFrame);for(var _i=0,_iter=this.scenes.values();_i<_iter.length;_i++){var scene=_iter[_i];Emit(scene,"render",results);}if(this.flush){results.numDirtyFrames++;this.flush=false;}return results;}}]);return _class6;}();function SetConfigDefaults(){SetBackgroundColor(0);SetBatchSize(4096);SetBanner("Phaser","4.0.0","https://phaser4.io");SetMaxTextures(0);SetDefaultOrigin(0.5,0.5);SetSize(800,600,1);}var Game=function(EventEmitter1){"use strict";swcHelpers.inherits(_class6,EventEmitter1);function _class6(){for(var _len=arguments.length,settings=new Array(_len),_key=0;_key<_len;_key++){settings[_key]=arguments[_key];}swcHelpers.classCallCheck(this,_class6);var _this;_this=swcHelpers.possibleConstructorReturn(this,swcHelpers.getPrototypeOf(_class6).call(this));_this.VERSION="4.0.0-beta1";_this.isBooted=false;_this.isPaused=false;_this.willUpdate=true;_this.willRender=true;_this.lastTick=0;_this.elapsed=0;_this.frame=0;GameInstance.set(swcHelpers.assertThisInitialized(_this));SetConfigDefaults();DOMContentLoaded(function(){return _this.boot(settings);});return _this;}swcHelpers.createClass(_class6,[{key:"boot",value:function boot(settings){settings.forEach(function(setting){return setting();});var renderer=GetRenderer();this.renderer=new renderer();this.textureManager=new TextureManager();this.sceneManager=new SceneManager();var parent=GetParent();if(parent){AddToDOM(this.renderer.canvas,parent);}var globalVar=GetGlobalVar();if(globalVar&&window){window[globalVar]=this;}this.isBooted=true;GetBanner();Emit(this,"boot");this.lastTick=performance.now();this.step(this.lastTick);}},{key:"pause",value:function pause(){this.isPaused=true;}},{key:"resume",value:function resume(){this.isPaused=false;this.lastTick=performance.now();}},{key:"step",value:function step(time){var delta=time-this.lastTick;this.lastTick=time;this.elapsed+=delta;if(!this.isPaused){if(this.willUpdate){this.sceneManager.update(delta,time);Emit(this,"update",delta,time);}if(this.willRender){this.renderer.render(this.sceneManager.render(this.frame));}}this.frame++;GameInstance.setFrame(this.frame);GameInstance.setElapsed(this.elapsed);requestAnimationFrame((function(now){return this.step(now);}).bind(this));}},{key:"destroy",value:function destroy(){}}]);return _class6;}(EventEmitter);function GetConfigValue(config,property,defaultValue){if(Object.prototype.hasOwnProperty.call(config,property)){return config[property];}else{return defaultValue;}}function Install(scene,param){var config=param=== void 0?{}:param;var sceneManager=SceneManagerInstance.get();var size=sceneManager.scenes.size;var sceneIndex=sceneManager.sceneIndex;var firstScene=size===0;if(typeof config==="string"){scene.key=config;}else if(config||!config&&firstScene){scene.key=GetConfigValue(config,"key","scene"+sceneIndex.toString());}if(sceneManager.scenes.has(scene.key)){console.warn("Scene key already in use: "+scene.key);}else{sceneManager.scenes.set(scene.key,scene);sceneManager.flush=true;sceneManager.sceneIndex++;}}var Scene=function _class6(config){"use strict";swcHelpers.classCallCheck(this,_class6);this.game=GameInstance.get();this.events=new Map();Install(this,config);};_exports.Camera=camera_exports;_exports.Camera3D=camera3d_exports;_exports.Color=color_exports;_exports.Config=config_exports;_exports.DOM=dom_exports;_exports.Device=device_exports;_exports.Display=display_exports;_exports.Display3D=display3d_exports;_exports.Events=events_exports;_exports.Game=Game;_exports.GameObjects=gameobjects_exports;_exports.GameObjects3D=gameobjects3d_exports;_exports.Geom=geom_exports;_exports.Geom3D=geom3d_exports;_exports.Input=input_exports2;_exports.Loader=loader_exports;_exports.Materials3D=materials3d_exports;_exports.Math=math_exports;_exports.Scene=Scene;_exports.Textures=textures_exports;_exports.Time=time_exports;_exports.WebGL1=webgl1_exports;_exports.World=world_exports;_exports.World3D=world3d_exports;});
